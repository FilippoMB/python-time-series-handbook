
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Nonlinear time series analysis &#8212; Time series analysis with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"f9a3dcbc3ffd42b787f6b84d4927e56e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "fffd7d8578a1466c90eeb6cbe0f231d3": {"model_name": "ProgressStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "406bf9e005a6478cb81da5069e27a7fb": {"model_name": "FloatProgressModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "success", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f9a3dcbc3ffd42b787f6b84d4927e56e", "max": 1600.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_fffd7d8578a1466c90eeb6cbe0f231d3", "tabbable": null, "tooltip": null, "value": 1600.0}}, "776adcb97aca4ec4a67273957b99c3ed": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "e2efd64d2d8742179889356e4c8782ba": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "94dfd51746604cf1b8049887650194bc": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_776adcb97aca4ec4a67273957b99c3ed", "placeholder": "\u200b", "style": "IPY_MODEL_e2efd64d2d8742179889356e4c8782ba", "tabbable": null, "tooltip": null, "value": "100%"}}, "598053a217f647dab923bcfc7397f6b4": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "21b5178b9c1843c0a7c29a47aa00ea67": {"model_name": "HTMLStyleModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "c928a44fe5c34f7d90cfe2d8b1f82b65": {"model_name": "HTMLModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_598053a217f647dab923bcfc7397f6b4", "placeholder": "\u200b", "style": "IPY_MODEL_21b5178b9c1843c0a7c29a47aa00ea67", "tabbable": null, "tooltip": null, "value": "\u20071600/1600\u2007[01:20&lt;00:00,\u200717.93it/s]"}}, "13c54876cd334562b9630f58b3a7e48e": {"model_name": "LayoutModel", "model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "71bbfc95b42f4174b646b697fe3bc232": {"model_name": "HBoxModel", "model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_94dfd51746604cf1b8049887650194bc", "IPY_MODEL_406bf9e005a6478cb81da5069e27a7fb", "IPY_MODEL_c928a44fe5c34f7d90cfe2d8b1f82b65"], "layout": "IPY_MODEL_13c54876cd334562b9630f58b3a7e48e", "tabbable": null, "tooltip": null}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@1.0.6/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/11/nonlinear-ts';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Time series classification and clustering" href="../12/classification-clustering.html" />
    <link rel="prev" title="Neural networks and Reservoir Computing" href="../10/nn-reservoir-computing.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../00/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Time series analysis with Python - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Time series analysis with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../00/intro.html">
                    Time series analysis with Python
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01/introduction_to_time_series.html">Introduction to time series analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02/stationarity.html">Stationarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03/smoothing.html">Smoothing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04/ar-ma.html">AR-MA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05/arma_arima_sarima.html">ARMA, ARIMA, SARIMA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06/unit-root-hurst.html">Unit root test and Hurst exponent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07/kalman-filter.html">Kalman filter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../08/signal-transforms-filters.html">Signal transforms and filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09/prophet.html">Prophet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10/nn-reservoir-computing.html">Neural networks and Reservoir Computing</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Nonlinear time series analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12/classification-clustering.html">Time series classification and clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00/knowledge_test.html">Knowledge test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00/resources.html">Resources and acknowledgments</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/FilippoMB/python-time-series-handbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FilippoMB/python-time-series-handbook/issues/new?title=Issue%20on%20page%20%2Fnotebooks/11/nonlinear-ts.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/11/nonlinear-ts.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Nonlinear time series analysis</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamical-systems">Dynamical Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-linear-dynamical-systems">Non-linear Dynamical Systems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-logistic-map">The logistic map</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regime-r-1">Regime <span class="math notranslate nohighlight">\(r &lt; 1\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regime-1-r-3">Regime <span class="math notranslate nohighlight">\(1 &lt; r &lt; 3\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regime-r-3">Regime <span class="math notranslate nohighlight">\(r &gt; 3\)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bifurcation-diagrams">Bifurcation diagrams</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chaotic-systems">Chaotic systems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sensitivity-to-initial-conditions">Sensitivity to initial conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detecting-chaos">Detecting chaos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lyapunov-exponent">Lyapunov exponent</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#return-maps">Return maps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-dimensional-continous-time-systems">Higher-dimensional continous-time systems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-lotka-volterra-equations">2D - Lotka-Volterra equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rossler-system">Rössler system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lorenz-system">Lorenz system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lyapunov-exponents-in-higher-dimensional-continuous-systems">Lyapunov exponents in higher dimensional continuous systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bifurcation-diagrams-in-higher-dimensional-continuous-systems">Bifurcation diagrams in higher dimensional continuous systems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-space">Phase space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fractal-dimensions">Fractal dimensions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chaos-and-fractals">Chaos and Fractals</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-space-reconstruction">Phase space reconstruction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#takens-embedding-theorem">Takens’ Embedding Theorem</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-time-delay-tau">Estimating time delay <span class="math notranslate nohighlight">\(\tau\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-embedding-dimension-m">Estimating the embedding dimension <span class="math notranslate nohighlight">\(m\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting-nonlinear-time-series">Forecasting nonlinear time series</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-on-the-taken-s-embeddings">Regression on the Taken’s embeddings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#echo-state-network">Echo State Network</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excercise-1">Excercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="nonlinear-time-series-analysis">
<h1>Nonlinear time series analysis<a class="headerlink" href="#nonlinear-time-series-analysis" title="Link to this heading">#</a></h1>
<img alt="../../_images/cover10.png" src="../../_images/cover10.png" />
<blockquote>
<div><p>“<em>Something as small as the flutter of a butterfly’s wing can ultimately cause a typhoon halfway around the world.</em>”</p>
</div></blockquote>
<div style="text-align: right; font-size: 15px;">--Chaos theory</div><section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>In this lecture we will cover the following topics.</p>
<ul class="simple">
<li><p>Dynamical systems and nonlinear dynamics.</p></li>
<li><p>Bifurcation diagrams.</p></li>
<li><p>Chaotic systems.</p></li>
<li><p>Higher-dimensional continuous-time systems.</p></li>
<li><p>Phase (state) space of a system.</p></li>
<li><p>Fractal dimensions.</p></li>
<li><p>Phase space reconstruction and Taken’s embedding theorem.</p></li>
<li><p>Forecasting nonlinear time series.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Install dependencies if the notebook is running in Colab</span>
<span class="k">if</span> <span class="s1">&#39;google.colab&#39;</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">:</span>
    <span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>-qq<span class="w"> </span>reservoir_computing<span class="w"> </span>tsa_course
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">solve_ivp</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">NearestNeighbors</span> 
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">reservoir_computing.reservoir</span> <span class="kn">import</span> <span class="n">Reservoir</span>
<span class="kn">from</span> <span class="nn">reservoir_computing.utils</span> <span class="kn">import</span> <span class="n">make_forecasting_dataset</span>
<span class="kn">from</span> <span class="nn">tsa_course.lecture11</span> <span class="kn">import</span> <span class="n">computeLE</span><span class="p">,</span> <span class="n">plot_bifurcation_diagram</span> 
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="dynamical-systems">
<h2>Dynamical Systems<a class="headerlink" href="#dynamical-systems" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>A dynamic system is a set of functions (rules, equations) specifying how variables change over time.</p></li>
<li><p>For example:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}x(t+1) &amp;= a \cdot x(t) + b \cdot y(t) \\ y(t+1) &amp;= c \cdot x(t)\end{aligned}\end{split}\]</div>
<ul class="simple">
<li><p>Here, <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> represent the <em>variables</em> of a 2-dimensional system, while <span class="math notranslate nohighlight">\(a,b,c\)</span> are the <em>parameters</em>.</p></li>
</ul>
<ul class="simple">
<li><p>Variables change over time, parameters do not.</p></li>
<li><p>In a <em>discrete</em> system the variables are restricted to integer values.</p></li>
<li><p>In a <em>continuous</em> system, variables can assume real values.</p></li>
<li><p>The system can be <em>stochastic</em> (one set of rules, many realizations) or <em>deterministic</em> (one set of rules, one realization).</p></li>
</ul>
<ul class="simple">
<li><p>The <em>state</em> of a dynamic system at time <span class="math notranslate nohighlight">\(t\)</span> is specified by the current value of its variables <span class="math notranslate nohighlight">\(x(t), y(t), \dots\)</span></p></li>
<li><p>The process of calculating the new state of a discrete system is called <em>iteration</em>.</p></li>
<li><p>To evaluate how a system behaves, we need the functions, the parameter values, and the <em>initial conditions</em>, e.g., <span class="math notranslate nohighlight">\(x(0), y(0), \dots\)</span></p></li>
</ul>
<ul class="simple">
<li><p>Let’s consider a classic example: the <em>alpha model</em>.</p></li>
<li><p>It specifies how <span class="math notranslate nohighlight">\(q(t)\)</span>, the probability of making an error on trial <span class="math notranslate nohighlight">\(t\)</span>, changes from one trial to the next:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[q(t+1) = \beta \cdot q(t)\]</div>
<ul class="simple">
<li><p>The new error probability is diminished by <span class="math notranslate nohighlight">\(\beta \in (0,1)\)</span>.</p></li>
<li><p>Starting from the initial conditions, we iterate the equations of our system and obtain a time series of system states.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">alpha</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">q</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">q</span> <span class="c1"># Sytem equation</span>

<span class="n">beta</span> <span class="o">=</span> <span class="mf">0.9</span>          <span class="c1"># System parameter</span>
<span class="n">q</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>             <span class="c1"># Initial condition</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">q</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">alpha</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="n">q</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> <span class="c1"># Iteration</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Trial ($t$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Error probability ($q(t)$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a2f8ff06245ecb5abec3313cddad83980b80a5cc885c0ce7c80b8962f657dae0.png" src="../../_images/a2f8ff06245ecb5abec3313cddad83980b80a5cc885c0ce7c80b8962f657dae0.png" />
</div>
</div>
</section>
<hr class="docutils" />
<section id="non-linear-dynamical-systems">
<h2>Non-linear Dynamical Systems<a class="headerlink" href="#non-linear-dynamical-systems" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Linear systems are those with linear state updates equations, i.e., something of the form <span class="math notranslate nohighlight">\(y(t) = a x(t) + b\)</span>.</p></li>
<li><p>The alpha model is linear.</p></li>
<li><p>Do not be confused by the non-linear curve we plot above: that is the <em>behavior</em> of the system, not the functions that specify its changes.</p></li>
</ul>
<section id="the-logistic-map">
<h3>The logistic map<a class="headerlink" href="#the-logistic-map" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Is a very famous equation to describe the growth of a population.</p></li>
<li><p>Is a non-linear model.</p></li>
<li><p>Is often used to introduce the notion of <em>chaos</em>.</p></li>
</ul>
<ul class="simple">
<li><p>Let’s first use a simple linear model to describe the population growth</p></li>
</ul>
<div class="math notranslate nohighlight">
\[x(t+1) = r x(t)\]</div>
<ul class="simple">
<li><p>where <span class="math notranslate nohighlight">\(r\)</span> is the growth rate.</p></li>
<li><p>With this model, if <span class="math notranslate nohighlight">\(r&gt;1\)</span> the population grows exponentially without limit, which is not very realistic.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">simple_growth</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span>

<span class="n">r</span> <span class="o">=</span> <span class="mf">1.5</span>              <span class="c1"># Each year x is increased by 50%</span>
<span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">16</span><span class="p">]</span>             <span class="c1"># Initial number of individuals</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">simple_growth</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]))</span> 

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Years ($t$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Population size ($x(t)$)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0a513c51b8b942247e45e13524a5776ad0e346d561119f22912e7e2fc5dc9877.png" src="../../_images/0a513c51b8b942247e45e13524a5776ad0e346d561119f22912e7e2fc5dc9877.png" />
</div>
</div>
<ul class="simple">
<li><p>The Logistic Map prevents unlimited growth by inhibiting growth whenever it achieves a high level.</p></li>
<li><p>This is achieved by introducing an additional term <span class="math notranslate nohighlight">\([1 - x(t)]\)</span>.</p></li>
<li><p>The growth measure <span class="math notranslate nohighlight">\(x\)</span> is also rescaled so that the maximum value <span class="math notranslate nohighlight">\(x\)</span> can achieve is 1.</p></li>
<li><p>So if the maximum size is 8 billions, <span class="math notranslate nohighlight">\(x\)</span> is the proportion of that maximum.</p></li>
</ul>
<ul class="simple">
<li><p>The new growth model is</p></li>
</ul>
<div class="math notranslate nohighlight">
\[x(t+1) = r x(t)[1 - x(t)]\]</div>
<ul class="simple">
<li><p>with <span class="math notranslate nohighlight">\(r \in [0,4]\)</span>.</p></li>
<li><p>The <span class="math notranslate nohighlight">\([1-x(t)]\)</span> inhibits the growth because as <span class="math notranslate nohighlight">\(x\)</span> approaches 1 (the maximum), <span class="math notranslate nohighlight">\([1-x(t)]\)</span> approaches 0.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">logistic</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Plotting <span class="math notranslate nohighlight">\(x(t)\)</span> against <span class="math notranslate nohighlight">\(x(t+1)\)</span> shows the nonlinearity of the system.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">logistic</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Logistic map&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x(t)$&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x(t+1)$&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dec28d0aff2f780e948d57def2ce16d97ec688c984c0aa1ff36838ba86bdee20.png" src="../../_images/dec28d0aff2f780e948d57def2ce16d97ec688c984c0aa1ff36838ba86bdee20.png" />
</div>
</div>
<ul class="simple">
<li><p>To see how it beahaves, we iterate the function and plot the growth.</p></li>
<li><p>It turns out that the logistic map changes drastically its behavior depending the the value of the parameter <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
<li><p>To see this, we examine the time series of the system’s state as <span class="math notranslate nohighlight">\(r\)</span> changes from 0 to 1.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">logistic</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;o-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$r = </span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">, x(0) = </span><span class="si">{</span><span class="n">x0</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time step ($t$)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population size ($x(t)$)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_system</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># Plot the function and the y=x diagonal line.</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">logistic</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">t</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># Recursively apply y=f(x) and plot two lines:</span>
    <span class="c1"># (x, x) -&gt; (x, y)</span>
    <span class="c1"># (x, y) -&gt; (y, y)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x0</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">logistic</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="c1"># Plot the two lines.</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="c1"># Plot the positions with increasing</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">y</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x(t-1)$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x(t)$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;$r=</span><span class="si">{</span><span class="n">r</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">, \, x(0)=</span><span class="si">{</span><span class="n">x0</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="regime-r-1">
<h4>Regime <span class="math notranslate nohighlight">\(r &lt; 1\)</span><a class="headerlink" href="#regime-r-1" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>So long as <span class="math notranslate nohighlight">\(r\)</span> is less than 1, the state of the system <span class="math notranslate nohighlight">\(x\)</span> will go toward 0.</p></li>
<li><p>This is called <em>one-point attractor</em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e010a9051b93496fafd22003542eb2e1c691476ee084e659486993af3a047b83.png" src="../../_images/e010a9051b93496fafd22003542eb2e1c691476ee084e659486993af3a047b83.png" />
</div>
</div>
<ul class="simple">
<li><p>The situation does not change for different values of the initial condition <span class="math notranslate nohighlight">\(x(0)\)</span>.</p></li>
<li><p>The initial state is quickly forgotten and the system ends in the same attractor.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2609a72e53a3a5a8be19d7d90dd9b1617d880adf85f5fde1d88ca0ea0a8f3866.png" src="../../_images/2609a72e53a3a5a8be19d7d90dd9b1617d880adf85f5fde1d88ca0ea0a8f3866.png" />
</div>
</div>
<ul class="simple">
<li><p>We can also see how the current state <span class="math notranslate nohighlight">\(x(t)\)</span> relates to the previous state <span class="math notranslate nohighlight">\(x(t-1)\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plot_system</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">.6</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/65ce2824ed88d64d07e4e85ef289d069e6fa335824c68e84b80dcdfd9e20f891.png" src="../../_images/65ce2824ed88d64d07e4e85ef289d069e6fa335824c68e84b80dcdfd9e20f891.png" />
</div>
</div>
</section>
<section id="regime-1-r-3">
<h4>Regime <span class="math notranslate nohighlight">\(1 &lt; r &lt; 3\)</span><a class="headerlink" href="#regime-1-r-3" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>We still have a one-point attractor, but now it changes with the value of <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">2.75</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6536f63c235b0cba5239169754e00904ff407f74cb92ae90aec8c097046ad4b5.png" src="../../_images/6536f63c235b0cba5239169754e00904ff407f74cb92ae90aec8c097046ad4b5.png" />
</div>
</div>
<ul class="simple">
<li><p>As before, the initial state is inconsequential and its effect is washed-out eventually.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9f4887e78f0ce44c9495c11035e052652862f7a075a876867e11684ec6c20424.png" src="../../_images/9f4887e78f0ce44c9495c11035e052652862f7a075a876867e11684ec6c20424.png" />
</div>
</div>
<ul class="simple">
<li><p>As we get closer to <span class="math notranslate nohighlight">\(r=3\)</span> the state oscillates more and more before settling down to its attractor.</p></li>
<li><p>The behavior is best observed by looking at the state-vs-state plot.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plot_system</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">2.9</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3791ff2947bd944350d2cef4ada94518e82677175766de0225c4ca46836da599.png" src="../../_images/3791ff2947bd944350d2cef4ada94518e82677175766de0225c4ca46836da599.png" />
</div>
</div>
</section>
<section id="regime-r-3">
<h4>Regime <span class="math notranslate nohighlight">\(r &gt; 3\)</span><a class="headerlink" href="#regime-r-3" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>As soon as we move beyond <span class="math notranslate nohighlight">\(r=3\)</span> the system starts oscillating between two points.</p></li>
<li><p>We have a two-point attractor.</p></li>
<li><p>The phenomenon we observe is called <em>bifurcation</em>, or <em>period-doubling</em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e4acb0cafc86048f2ba35cb951bd8fb12bc3556a43719d3878bb0234c3b7dfd5.png" src="../../_images/e4acb0cafc86048f2ba35cb951bd8fb12bc3556a43719d3878bb0234c3b7dfd5.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plot_system</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">3.2</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/05ee14203cca9db6c29d4da492129bd3713171d84cc0b2246d26365563a87720.png" src="../../_images/05ee14203cca9db6c29d4da492129bd3713171d84cc0b2246d26365563a87720.png" />
</div>
</div>
<ul class="simple">
<li><p>At <span class="math notranslate nohighlight">\(r=3.54\)</span> another bifurcation occurs.</p></li>
<li><p>We have now reached a 4-point attractor.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">3.54</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0e90d35e0b340ba7738e0b4e05c55306d8ee9e8e7c30766bbcc4af3f19f8def1.png" src="../../_images/0e90d35e0b340ba7738e0b4e05c55306d8ee9e8e7c30766bbcc4af3f19f8def1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plot_system</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">3.54</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/391941b9bdc1a025f014745d87f3876324db76bf4fbe14d60eacf55e11e98d64.png" src="../../_images/391941b9bdc1a025f014745d87f3876324db76bf4fbe14d60eacf55e11e98d64.png" />
</div>
</div>
<ul class="simple">
<li><p>The number of bifurcations keep growing as we increase <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
<li><p>Eventually, we witstand the so-called <em>N-point attractor</em>.</p></li>
<li><p>The system settles down to an attractor that looks “unstable” or “strange”.</p></li>
<li><p>This a characterizing property of <em>chaotic systems</em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">3.99</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9688c0dc42324dec260ed37d9115e3402dc9bce829f660393832f3ff0b9ab6f1.png" src="../../_images/9688c0dc42324dec260ed37d9115e3402dc9bce829f660393832f3ff0b9ab6f1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mf">5.5</span><span class="p">))</span>
<span class="n">plot_system</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">3.99</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/33cce7d380c5e36f474dff3211908b7adfa0d2bf3808c72d1c5ce4295bd63bdd.png" src="../../_images/33cce7d380c5e36f474dff3211908b7adfa0d2bf3808c72d1c5ce4295bd63bdd.png" />
</div>
</div>
</section>
</section>
<section id="bifurcation-diagrams">
<h3>Bifurcation diagrams<a class="headerlink" href="#bifurcation-diagrams" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>As we said, a bifucation is a period-doubling, i.e., a change from an <span class="math notranslate nohighlight">\(N\)</span>-point attractor to a <span class="math notranslate nohighlight">\(2N\)</span>-point attractor.</p></li>
<li><p>In the Logistic map, it occurs when the control parameter (<span class="math notranslate nohighlight">\(r\)</span>) is changed.</p></li>
<li><p>A <em>bifurcation diagram</em> is a visual summary of the succession of period-doubling produced as the control parameter changes.</p></li>
</ul>
<ul class="simple">
<li><p>Let’s compute the bifurcation diagram of the logistic map.</p></li>
<li><p>On the x-axis, we have the value of <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
<li><p>On the y-axis, we have the number of distinct points the system settles down to.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">bifuracion_diagram</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">last</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">1e-5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">logistic</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="p">(</span><span class="n">iterations</span> <span class="o">-</span> <span class="n">last</span><span class="p">):</span> <span class="c1"># plot only the &#39;last&#39; last iterations</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;,k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.25</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Bifurcation diagram&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;$r$&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;$x$&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mi">30000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">bifuracion_diagram</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">3.569945</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Edge of Chaos (Feigenbaum point)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/16711513301bae492b3fa4cb979bbe4b94e7917f4e1e04dddd3c1638443b916e.png" src="../../_images/16711513301bae492b3fa4cb979bbe4b94e7917f4e1e04dddd3c1638443b916e.png" />
</div>
</div>
<ul class="simple">
<li><p>We see that for <span class="math notranslate nohighlight">\(r&lt;1\)</span>, zero is the one point attractor.</p></li>
<li><p>For <span class="math notranslate nohighlight">\(1&lt;r&lt;3\)</span> we still have one-point attractors, but the ‘attracted’ value of <span class="math notranslate nohighlight">\(x\)</span> increases as <span class="math notranslate nohighlight">\(r\)</span> increases.</p></li>
<li><p>Bifurcations occur at <span class="math notranslate nohighlight">\(r=3\)</span>, <span class="math notranslate nohighlight">\(r=3.45\)</span>, <span class="math notranslate nohighlight">\(3.54\)</span>, <span class="math notranslate nohighlight">\(3.564\)</span>, <span class="math notranslate nohighlight">\(3.569\)</span>, etc…</p></li>
<li><p>Approximately at <span class="math notranslate nohighlight">\(r=3.57\)</span> our system become chaotic.</p></li>
<li><p>However, the system is not chaotic for all values of <span class="math notranslate nohighlight">\(r\)</span> greater than 3.57.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">30000</span> <span class="c1"># number of values of r</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">3.5</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">bifuracion_diagram</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/2b810e9544c9ac803175938f05a29c04ba820ff30b7dc19149a2c647775df6c9.png" src="../../_images/2b810e9544c9ac803175938f05a29c04ba820ff30b7dc19149a2c647775df6c9.png" />
</div>
</div>
<ul class="simple">
<li><p>At several values of <span class="math notranslate nohighlight">\(r &gt; 3.57\)</span> there are regions where a small number of <span class="math notranslate nohighlight">\(x\)</span>-values are visited.</p></li>
<li><p>These regions produce the white spaces in the diagram.</p></li>
<li><p>For example, at <span class="math notranslate nohighlight">\(r=3.83\)</span> there is a three-point attractor.</p></li>
<li><p>Between 3.57 and 4 there is a rich interleaving of chaos and order.</p></li>
<li><p>A small change in <span class="math notranslate nohighlight">\(r\)</span> can make a stable system chaotic, and vice-versa.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="chaotic-systems">
<h2>Chaotic systems<a class="headerlink" href="#chaotic-systems" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Many real-world phenomena are chaotic, particularly those that involve nonlinear interactions among many agents (complex systems).</p></li>
<li><p>Examples can be found in meteorology, economics, biology, and other disciplines.</p></li>
<li><p>In the following, we will explore some famous chaotic systems and their properties.</p></li>
</ul>
<section id="sensitivity-to-initial-conditions">
<h3>Sensitivity to initial conditions<a class="headerlink" href="#sensitivity-to-initial-conditions" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>A characterizing feature of chaotic systems is their sensitivity to initial conditions.</p></li>
<li><p>Let’s see it with the Logistic map for <span class="math notranslate nohighlight">\(r=3.99\)</span>.</p></li>
<li><p>We will start from two very close initial conditions: <span class="math notranslate nohighlight">\(x(0)=0.1\)</span> and <span class="math notranslate nohighlight">\(x(0)=0.101\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">3.99</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">3.99</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.101</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3d563f94620ba35648afae0c578bf18492969656ed5daee2cfc803f419b7702a.png" src="../../_images/3d563f94620ba35648afae0c578bf18492969656ed5daee2cfc803f419b7702a.png" />
</div>
</div>
<ul class="simple">
<li><p>It takes very few steps for the two trajectories to diverge.</p></li>
<li><p>What if we take the initial conditions <em>really</em> close?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">3.99</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">plot_time_series</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mf">3.99</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">0.100001</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d83598013a0b3ba263f17a74a798e84936275141dd05eb9e2a2c2c73819ba70f.png" src="../../_images/d83598013a0b3ba263f17a74a798e84936275141dd05eb9e2a2c2c73819ba70f.png" />
</div>
</div>
<ul class="simple">
<li><p>The example should make this point clear:</p></li>
</ul>
<blockquote>
<div><p>In a chaotic systrem no matter how close the initial conditions are, if they are different the trajectories will eventually diverge.</p>
</div></blockquote>
<ul class="simple">
<li><p>From another perspective, the system will never forget its initial state.</p></li>
</ul>
</section>
<section id="detecting-chaos">
<h3>Detecting chaos<a class="headerlink" href="#detecting-chaos" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>How do we determine if a system has a contractive or chaotic dynamics?</p></li>
<li><p>We have several tools.</p></li>
<li><p>One is to measure the sensitivity to initial conditions, which we know being high for chaotic system.</p></li>
<li><p>The <em>Lyapunov exponent</em> can be used to measure this.</p></li>
</ul>
<section id="lyapunov-exponent">
<h4>Lyapunov exponent<a class="headerlink" href="#lyapunov-exponent" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>The Lyapunov exponent quantifies the rate at which nearby trajectories in the system diverge or converge over time.</p></li>
<li><p>It tells us how sensitive a system is to its initial conditions, a property often associated with chaotic behavior.</p></li>
<li><p>There are actually several Lyapunov exponents for a given system, corresponding to different directions in the system’s phase space.</p></li>
<li><p>The <em>largest</em> Lyapunov exponent is most commonly used to detect chaos.</p></li>
<li><p>A system is considered chaotic if it has at least one <em>positive</em> Lyapunov exponent.</p></li>
</ul>
<p><strong>Definition</strong></p>
<ul class="simple">
<li><p>Let a dynamical system be defined as</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\dot{x} = f(x, t)\]</div>
<ul class="simple">
<li><p>where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\dot{x}\)</span> represents the time derivative of <span class="math notranslate nohighlight">\(x\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(f(x, t)\)</span> is the function defining the system’s evolution over time.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>Consider two nearby points in the system’s phase space  <span class="math notranslate nohighlight">\(x_0\)</span> and <span class="math notranslate nohighlight">\(x_0 + \delta x_0\)</span>, where <span class="math notranslate nohighlight">\(\delta x_0\)</span> is a small perturbation.</p></li>
<li><p>Their trajectories diverge over time according to</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\delta x(t) \approx \delta x_0 e^{\lambda t}\]</div>
<ul class="simple">
<li><p>where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\delta x(t)\)</span> is the separation between the two trajectories at time <span class="math notranslate nohighlight">\(t\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\lambda\)</span> is the Lyapunov exponent.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>The exponent is calculated as</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\lambda = \lim_{t \to \infty} \lim_{|\delta x_0| \to 0} \frac{1}{t} \ln \left( \frac{|\delta x(t)|}{|\delta x_0|} \right)\]</div>
<ul class="simple">
<li><p>This limit, if it exists, gives the average rate of exponential divergence (if <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span>) or convergence (if <span class="math notranslate nohighlight">\(\lambda &lt; 0\)</span>) of trajectories starting from infinitesimally close initial conditions.</p></li>
<li><p>The exponent can often be computed analytically.</p></li>
<li><p>Otherwise, it is computed numerically by observing how small perturbations evolve over time.</p></li>
</ul>
<ul class="simple">
<li><p>A positive Lyapunov exponent implies that small differences in initial conditions lead to exponential divergence of trajectories.</p></li>
<li><p>This makes long-term predictions very difficult despite the system being deterministic.</p></li>
<li><p>This sensitivity to initial conditions is often referred to as the <em>butterfly effect</em> in the context of chaos theory.</p></li>
</ul>
<ul class="simple">
<li><p>Next, we make a function to plot the Lyapunov exponent in the logistic map as we increase <span class="math notranslate nohighlight">\(r\)</span>.</p></li>
<li><p>We will color in red values of <span class="math notranslate nohighlight">\(r\)</span> associated with <span class="math notranslate nohighlight">\(\lambda&gt;0\)</span>, which indicates that the system has a chaotic behavior.</p></li>
<li><p>To check if the Lyapunov exponent works as a chaos detector, we will compare it with the bifurcation map.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lyapunov</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">iterations</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mf">1e-5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>  
    <span class="n">lyapunov</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">iterations</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">logistic</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="n">lyapunov</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">r</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">r</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span> <span class="c1"># Partial sum of the Lyapunov exponent.</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    
    <span class="c1"># Negative Lyapunov exponent.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">lyapunov</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">lyapunov</span><span class="p">[</span><span class="n">lyapunov</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">iterations</span><span class="p">,</span>
            <span class="s1">&#39;.k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    
    <span class="c1"># Positive Lyapunov exponent.</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="n">lyapunov</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">lyapunov</span><span class="p">[</span><span class="n">lyapunov</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">iterations</span><span class="p">,</span>
            <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">.5</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mf">.5</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Lyapunov exponent&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">2.8</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mi">30000</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">250</span><span class="p">)</span>
<span class="n">bifuracion_diagram</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">3.569945</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Edge of Chaos&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">lyapunov</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/52ec1643250ba1b6450b7259c6bb2485e702f7c99beaa8abda5637973ea98a5e.png" src="../../_images/52ec1643250ba1b6450b7259c6bb2485e702f7c99beaa8abda5637973ea98a5e.png" />
</div>
</div>
</section>
<section id="return-maps">
<h4>Return maps<a class="headerlink" href="#return-maps" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Another important distinction is between chaos and randomness.</p></li>
<li><p>At first glance, a chaotic and a stochastic processes look a lot alike.</p></li>
<li><p>Let’s consider the time series of samples generated by:</p>
<ul>
<li><p>a uniform distribution,</p></li>
<li><p>a normal distribution,</p></li>
<li><p>the Logistic map for <span class="math notranslate nohighlight">\(r=3.99\)</span>.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">uniform_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span> <span class="c1"># Random uniform</span>

<span class="n">normal_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span> <span class="c1"># Random normal</span>

<span class="n">lgt_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="mi">300</span><span class="p">)</span> <span class="c1"># Logistic map</span>
<span class="n">lgt_data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lgt_data</span><span class="p">)):</span>
    <span class="n">lgt_data</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">logistic</span><span class="p">(</span><span class="mf">3.99</span><span class="p">,</span> <span class="n">lgt_data</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">uniform_data</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">normal_data</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lgt_data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/028b7a0a576e52a132690a53b788c42b2fc880e883bd94acc3aa2ee2b6335d34.png" src="../../_images/028b7a0a576e52a132690a53b788c42b2fc880e883bd94acc3aa2ee2b6335d34.png" />
</div>
</div>
<ul class="simple">
<li><p>How do we determine if a system is chaotic or random?</p></li>
<li><p>Also in this case we have several tools at our disposal.</p></li>
<li><p>One of this is the <em>return map</em>.</p></li>
</ul>
<ul class="simple">
<li><p>We saw a return map already before.</p></li>
<li><p>It simply consists in plotting the current value <span class="math notranslate nohighlight">\(x(t)\)</span> against the next one <span class="math notranslate nohighlight">\(x(t+1)\)</span>.</p></li>
<li><p>If the time series is random, we will see no or little structure as the next value is uncorrelated with the current one.</p></li>
<li><p>Instead, if the time series is chaotic we will see a well-defined structure.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">return_map</span><span class="p">(</span><span class="n">series</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">series</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">series</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$x(t)$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$x(t+1)$&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">return_map</span><span class="p">(</span><span class="n">uniform_data</span><span class="p">,</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;Random uniform&quot;</span><span class="p">)</span>
<span class="n">return_map</span><span class="p">(</span><span class="n">normal_data</span><span class="p">,</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;Random normal&quot;</span><span class="p">)</span>
<span class="n">return_map</span><span class="p">(</span><span class="n">lgt_data</span><span class="p">,</span> <span class="n">axes</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="s2">&quot;Logistic map&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/35d010bbde4aea5751395e26c2e47fef71498f0ad7ee364c9167d88c6c4aa42c.png" src="../../_images/35d010bbde4aea5751395e26c2e47fef71498f0ad7ee364c9167d88c6c4aa42c.png" />
</div>
</div>
</section>
</section>
</section>
<hr class="docutils" />
<section id="higher-dimensional-continous-time-systems">
<h2>Higher-dimensional continous-time systems<a class="headerlink" href="#higher-dimensional-continous-time-systems" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>In the case of the Logistic map the system had only one variable: <span class="math notranslate nohighlight">\(x(t)\)</span>.</p></li>
<li><p>In general, we can have systems with two or more variables.</p></li>
<li><p>The number of variables defines the <em>dimensionality</em> of the system.</p></li>
<li><p>The <em>state</em> of a system is the current values of its variables.</p></li>
</ul>
<ul class="simple">
<li><p>Most of the time series we saw originated from <em>discrete-time</em> systems that evolve at specific intervals in time.</p></li>
<li><p>The time variable <span class="math notranslate nohighlight">\(t\)</span> takes values from a discrete set, often integers, indicating distinct time steps or periods.</p></li>
<li><p>The dynamics of discrete-time systems are described using <em>difference equations</em>, e.g.,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[x(t+1) = f(x(t))\]</div>
<ul class="simple">
<li><p>Discrete-time systems are common in digital signal processing, computer algorithms, economic models, and any context where observations or changes occur at well-defined intervals.</p></li>
</ul>
<ul class="simple">
<li><p>In <em>continuous-time</em> systems, the time variable <span class="math notranslate nohighlight">\(t\)</span> can take any value in a range of real numbers.</p></li>
<li><p>This means that the system’s state can change at any instant in time.</p></li>
<li><p>The dynamics of continuous-time systems are described using <em>differential equations</em> that model how the state variables change with respect to continuous time, e.g.,</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\frac{dx}{dt} = f(x)\]</div>
<ul class="simple">
<li><p>Many physical and natural processes are modeled as continuous-time systems, such as the motion of planets, electrical circuits, and fluid dynamics.</p></li>
</ul>
<section id="d-lotka-volterra-equations">
<h3>2D - Lotka-Volterra equations<a class="headerlink" href="#d-lotka-volterra-equations" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The Lotka-Volterra equations are used to model the predator-prey population system.</p></li>
<li><p>It extends the logistic map by modeling the interactions between two species: a predator and its prey.</p></li>
<li><p>The growth of the two species is affected by the presence of the other speciemen.</p></li>
<li><p>The Logistic map is a discrete-time, univariate model represented by a single equation.</p></li>
<li><p>The predator-prey model is a continuous-time, bivariate system.</p></li>
</ul>
<p>The Lotka-Volterra equations for predator-prey dynamics are given by:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{dx}{dt} &amp;= \alpha x - \beta xy \\
\frac{dy}{dt} &amp;= \delta xy - \gamma y
\end{align*}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span> is the prey population,</p></li>
<li><p><span class="math notranslate nohighlight">\(y\)</span> is the predator population,</p></li>
<li><p><span class="math notranslate nohighlight">\(\frac{dx}{dt}\)</span> and <span class="math notranslate nohighlight">\(\frac{dy}{dt}\)</span> are the rate of change of the prey and predator populations over time, respectively,</p></li>
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> is the natural growth rate of prey in the absence of predators,</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> is the death rate of prey due to predation,</p></li>
<li><p><span class="math notranslate nohighlight">\(\delta\)</span> is the efficiency of converting consumed prey into predator offspring,</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma\)</span> is the natural death rate of predators in the absence of food (prey).</p></li>
</ul>
<ul class="simple">
<li><p>This system can exhibit a variety of dynamics, including stable limit cycles, where the populations of predators and prey oscillate in a regular, periodic fashion.</p></li>
<li><p>The attractor in the Lotka-Volterra system, in this case, is typically a closed loop, reflecting the cyclic nature of the predator-prey interactions.</p></li>
</ul>
<img alt="../../_images/lokta_volt.png" src="../../_images/lokta_volt.png" />
<ul class="simple">
<li><p>Let’s define the system of differential equations.</p></li>
<li><p>To “run” the system, we use a numerical solver <code class="docutils literal notranslate"><span class="pre">scipy.integrate.solve_ivp</span></code>.</p></li>
<li><p>Since the solver takes a single state variable, we define <code class="docutils literal notranslate"><span class="pre">z</span> <span class="pre">=</span> <span class="pre">[x,</span> <span class="pre">y]</span></code>.</p></li>
<li><p>Note that the variable <code class="docutils literal notranslate"><span class="pre">t</span></code> is not used in the function we define, but is necessary to the solver.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Lotka-Volterra equations</span>
<span class="k">def</span> <span class="nf">lotka_volterra</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">z</span>
    <span class="n">dxdt</span> <span class="o">=</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="n">beta</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
    <span class="n">dydt</span> <span class="o">=</span> <span class="n">delta</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span> <span class="o">-</span> <span class="n">gamma</span> <span class="o">*</span> <span class="n">y</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dydt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>For the next plots we will use a function <code class="docutils literal notranslate"><span class="pre">lokta_volterra_attractor</span></code> that:</p>
<ul>
<li><p>Runs the solver computing the sequence of states over time.</p></li>
<li><p>Plots the time series of the state variables.</p></li>
<li><p>Plots the attractor.</p></li>
</ul>
</li>
<li><p>Note the syntax of <code class="docutils literal notranslate"><span class="pre">solve_ivp</span></code>: all the parameters of the systems are passed through <code class="docutils literal notranslate"><span class="pre">args</span></code> argument. More info <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.integrate.solve_ivp.html">here</a>.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lokta_volterra_attractor</span><span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> 
                             <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">1.25</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">delta</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span>
                             <span class="n">ax1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="c1"># Solve the differential equations</span>
    <span class="n">sol</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">lotka_volterra</span><span class="p">,</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span> <span class="n">t</span><span class="o">.</span><span class="n">max</span><span class="p">()],</span> <span class="n">z0</span><span class="p">,</span> 
        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">),</span> <span class="n">t_eval</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">ax1</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Plot the time series</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prey $x(t)$&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">t</span><span class="p">,</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predator $y(t)$&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;System variables&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Population&#39;</span><span class="p">)</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">ax2</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Plot attractor</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sol</span><span class="o">.</span><span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;$z(0) = </span><span class="si">{</span><span class="n">z0</span><span class="si">}</span><span class="s1">$&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Attractor&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Prey Population&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Predator Population&#39;</span><span class="p">)</span>
        <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<ul class="simple">
<li><p>For the given set of parameters, the system shows a chaotic behavior.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">z0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.43</span><span class="p">,</span> <span class="mf">1.36</span><span class="p">]</span>
<span class="n">lokta_volterra_attractor</span><span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">ax1</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ax2</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f11994f01979e750fda9c96f4c4a12241197de32753107c52ba938644d7bb8b3.png" src="../../_images/f11994f01979e750fda9c96f4c4a12241197de32753107c52ba938644d7bb8b3.png" />
</div>
</div>
<ul class="simple">
<li><p>Indeed, the system in this configuration is very sensitive to different initial conditions.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>

<span class="n">z0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]</span>
<span class="n">lokta_volterra_attractor</span><span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">z0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]</span>
<span class="n">lokta_volterra_attractor</span><span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">z0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">]</span>
<span class="n">lokta_volterra_attractor</span><span class="p">(</span><span class="n">z0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">ax2</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3531c062f7bf7113010735b808a09a36d29c9bea5796e27c6d1f2be55655335e.png" src="../../_images/3531c062f7bf7113010735b808a09a36d29c9bea5796e27c6d1f2be55655335e.png" />
</div>
</div>
</section>
<section id="rossler-system">
<h3>Rössler system<a class="headerlink" href="#rossler-system" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The Rössler system is notable for its chaotic behavior, which emerges from a simple set of non-linear ordinary differential equations (ODEs).</p></li>
</ul>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{dx}{dt} &amp;= -y - z, \\
\frac{dy}{dt} &amp;= x + ay, \\
\frac{dz}{dt} &amp;= b + z(x - c),
\end{align*}\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span> are the system states over time <span class="math notranslate nohighlight">\(t\)</span>, and <span class="math notranslate nohighlight">\(a\)</span>, <span class="math notranslate nohighlight">\(b\)</span>, and <span class="math notranslate nohighlight">\(c\)</span> are parameters that determine the system’s behavior.</p></li>
<li><p>Typical values that lead to chaotic behavior are <span class="math notranslate nohighlight">\(a = 0.2\)</span>, <span class="math notranslate nohighlight">\(b = 0.2\)</span>, and <span class="math notranslate nohighlight">\(c = 5.7\)</span>, though chaos can be observed for other values as well.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the Rössler attractor system of equations</span>
<span class="k">def</span> <span class="nf">rossler_system</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">y</span>
    <span class="n">dxdt</span> <span class="o">=</span> <span class="o">-</span><span class="n">y</span> <span class="o">-</span> <span class="n">z</span>
    <span class="n">dydt</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">a</span><span class="o">*</span><span class="n">y</span>
    <span class="n">dzdt</span> <span class="o">=</span> <span class="n">b</span> <span class="o">+</span> <span class="n">z</span><span class="o">*</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">c</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">dxdt</span><span class="p">,</span> <span class="n">dydt</span><span class="p">,</span> <span class="n">dzdt</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">5.7</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># Initial conditions</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># Final time</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span>  <span class="c1"># Time span for the integration</span>

<span class="c1"># Solve the differential equations</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">rossler_system</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">5e4</span><span class="p">))</span>
<span class="n">ross_sol</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">sol</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot time series</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ross_sol</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;x(t)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ross_sol</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;y(t)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">ross_sol</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;z(t)&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">150</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/820e3ff71e7c98bdfb56a60301f4073efe3723aa0518c050953cf6172ca21462.png" src="../../_images/820e3ff71e7c98bdfb56a60301f4073efe3723aa0518c050953cf6172ca21462.png" />
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_attractor</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="n">xt</span><span class="p">,</span> <span class="n">yt</span><span class="p">,</span> <span class="n">zt</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">interactive</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">[</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter3d</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">xt</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yt</span><span class="p">,</span> <span class="n">z</span><span class="o">=</span><span class="n">zt</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span> <span class="n">line</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">1</span><span class="p">))])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">,</span> <span class="n">scene</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">xaxis_title</span><span class="o">=</span><span class="s1">&#39;x(t)&#39;</span><span class="p">,</span> <span class="n">yaxis_title</span><span class="o">=</span><span class="s1">&#39;y(t)&#39;</span><span class="p">,</span> <span class="n">zaxis_title</span><span class="o">=</span><span class="s1">&#39;z(t)&#39;</span><span class="p">),</span>
                          <span class="n">autosize</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">margin</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xt</span><span class="p">,</span> <span class="n">yt</span><span class="p">,</span> <span class="n">zt</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the Rössler attractor</span>
<span class="n">plot_attractor</span><span class="p">(</span><span class="n">ross_sol</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Rössler Attractor&quot;</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cf9935c7c497c5ad502596b3a4367a9e33c9239dc718235f0e405aa5ebd63c3d.png" src="../../_images/cf9935c7c497c5ad502596b3a4367a9e33c9239dc718235f0e405aa5ebd63c3d.png" />
</div>
</div>
</section>
<section id="lorenz-system">
<h3>Lorenz system<a class="headerlink" href="#lorenz-system" title="Link to this heading">#</a></h3>
<img alt="../../_images/lorenz.gif" src="../../_images/lorenz.gif" />
<ul class="simple">
<li><p>The Lorenz system was one of the first examples to demonstrate the phenomenon of deterministic chaos.</p></li>
<li><p>Like the other chaotic systems, this one exhibits sensitive dependence on initial conditions.</p></li>
<li><p>Also, it generates apparently random and unpredictable patterns, despite being governed by deterministic laws.</p></li>
</ul>
<ul class="simple">
<li><p>The study of the Lorenz system has had profound implications across numerous fields, from meteorology and climate science to engineering, and economics.</p></li>
<li><p>It challenged previous notions of predictability in physical systems and contributed to the development of chaos theory by:</p>
<ul>
<li><p>deepening the understanding of complex systems,</p></li>
<li><p>highlighting the limitations of current prediction models in systems with chaotic dynamics,</p></li>
<li><p>inspiring new approaches in the analysis and control of such systems.</p></li>
</ul>
</li>
</ul>
<p>The Lorenz system is defined by the following set of non-linear ODEs:</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{align*}
\frac{dx}{dt} &amp;= \sigma(y - x), \\
\frac{dy}{dt} &amp;= x(\rho - z) - y, \\
\frac{dz}{dt} &amp;= xy - \beta z,
\end{align*}\]</div>
<p>Typical values at which the Lorenz system shows a chaotic behavior are <span class="math notranslate nohighlight">\(\sigma = 10\)</span>, <span class="math notranslate nohighlight">\(\rho = 28\)</span>, and <span class="math notranslate nohighlight">\(\beta = \frac{8}{3}\)</span>.</p>
</section>
<section id="lyapunov-exponents-in-higher-dimensional-continuous-systems">
<h3>Lyapunov exponents in higher dimensional continuous systems<a class="headerlink" href="#lyapunov-exponents-in-higher-dimensional-continuous-systems" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Previously, we introduced the largest <a class="reference internal" href="#lyapunov-exponent"><span class="xref myst">Lyapunov exponent</span></a> <span class="math notranslate nohighlight">\(\lambda\)</span> as a tool for detecting chaos.</p></li>
<li><p>For the Logistic map, we showed that when <span class="math notranslate nohighlight">\(\lambda &gt; 0\)</span> the dyanmic of the system is chaotic.</p></li>
</ul>
<ul class="simple">
<li><p>In higher dimensional continuous systems, the analysis of Lyapunov exponents remains a crucial method for understanding the system’s dynamics.</p></li>
<li><p>In particular, they can still be used to determine stability and the onset of chaos.</p></li>
<li><p>However, in this setting things become more complicated.</p></li>
</ul>
<ul class="simple">
<li><p>In one-dimensional discrete systems like the Logistic map, there is typically one Lyapunov exponent.</p></li>
<li><p>Instead, in a continuous system of dimension <span class="math notranslate nohighlight">\(n\)</span>, there are usually <span class="math notranslate nohighlight">\(n\)</span> Lyapunov exponents.</p></li>
<li><p>Calculating these exponents involves complex numerical methods to handle the evolving tangent space dynamics.</p></li>
<li><p>Calculating them is also computationally expensive and sensitive to numerical precision.</p></li>
<li><p>Additionally, the initial conditions and parameter values have a stronger influence on the Lyapunov spectrum.</p></li>
</ul>
<ul class="simple">
<li><p><em>Positive exponents</em> indicate directions in which the system exhibits sensitive dependence on initial conditions, a characteristic of chaotic dynamics.</p></li>
<li><p><em>Zero exponents</em> suggest neutral stability along certain directions, often associated with conserved quantities or symmetries in the system.</p></li>
<li><p><em>Negative exponents</em> reflect directions of convergence, indicating stability in those dimensions.</p></li>
</ul>
<ul class="simple">
<li><p>The largest Lyapunov exponent is still the most important in predicting the overall system behavior, particularly chaos.</p></li>
<li><p>However, the entire spectrum can provide insights into more complex dynamics like:</p>
<ul>
<li><p>mixed modes (simultaneous stable and chaotic behaviors),</p></li>
<li><p>hyperchaotic systems (systems with more than one positive Lyapunov exponent).</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>To compute the Lyapunov spectrum we use the function <code class="docutils literal notranslate"><span class="pre">computeLE(func,</span> <span class="pre">func_jac,</span> <span class="pre">x0,</span> <span class="pre">t,</span> <span class="pre">p)</span></code>, which is part of the companion code to this lecture.</p></li>
<li><p>The arguments of the function are:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code>, which specifies the differential equations of the dynamical system,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">func_jac</span></code>, which is the Jacobian of the system, i.e., the partial derivatives,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x0</span></code>, which represents the initial conditions,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">t</span></code>, the time vector specifying the time steps along which the trajectory of the system is computed,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p</span></code>, the parameters of the system.</p></li>
</ul>
</li>
</ul>
<ul class="simple">
<li><p>For the Lorenz system, <code class="docutils literal notranslate"><span class="pre">func</span></code> is defined as follows</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lorenz</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">sigma</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">rho</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">beta</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>The Jacobian of the system is the matrix of the partial derivatives.</p></li>
<li><p>Consider a general dynamical system with three variables <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span>, represented by the equations:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{cases}
\dot{x} = f(x, y, z) \\
\dot{y} = g(x, y, z) \\
\dot{z} = h(x, y, z)
\end{cases}
\end{split}\]</div>
<ul class="simple">
<li><p>The Jacobian is:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
J = \begin{bmatrix}
\frac{\partial f}{\partial x} &amp; \frac{\partial f}{\partial y} &amp; \frac{\partial f}{\partial z} \\
\frac{\partial g}{\partial x} &amp; \frac{\partial g}{\partial y} &amp; \frac{\partial g}{\partial z} \\
\frac{\partial h}{\partial x} &amp; \frac{\partial h}{\partial y} &amp; \frac{\partial h}{\partial z}
\end{bmatrix}
\end{split}\]</div>
<ul class="simple">
<li><p>So, for the Lorenz system we have:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
J_{\text{Lorenz}} = \begin{bmatrix}
-\sigma &amp; \sigma &amp; 0 \\
\rho - z &amp; -1 &amp; -x \\
y &amp; x &amp; -\beta
\end{bmatrix}
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">lorenz_jac</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span>  <span class="n">sigma</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">beta</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
    <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">sigma</span><span class="p">,</span> <span class="n">sigma</span>
    <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">rho</span> <span class="o">-</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="o">-</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">res</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="o">-</span><span class="n">beta</span>
    <span class="k">return</span> <span class="n">res</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Finally, we specify the initial conditions <code class="docutils literal notranslate"><span class="pre">x0</span></code>, the time vector <code class="docutils literal notranslate"><span class="pre">t</span></code>, and the system’s parameters <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p></li>
<li><p>The latter, in the case of Lorenz systems are <span class="math notranslate nohighlight">\(\sigma\)</span>, <span class="math notranslate nohighlight">\(\rho\)</span>, and <span class="math notranslate nohighlight">\(\beta\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">20.</span><span class="p">])</span> 
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">)</span>
<span class="n">sigma</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">10.</span><span class="p">,</span> <span class="mf">28.</span><span class="p">,</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">rho</span><span class="p">,</span> <span class="n">beta</span><span class="p">)</span>

<span class="n">LEs</span><span class="p">,</span> <span class="n">hist</span> <span class="o">=</span> <span class="n">computeLE</span><span class="p">(</span><span class="n">lorenz</span><span class="p">,</span> <span class="n">lorenz_jac</span><span class="p">,</span> <span class="n">x0</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lyapunov Exponents: </span><span class="si">{</span><span class="n">LEs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Lyapunov Exponents: [ 9.06320944e-01 -2.38039941e-03 -1.45705049e+01]
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>One of the Lyapunov exponents is positive.</p></li>
<li><p>This suggests that the Lorenz system configured with the specific values of <span class="math notranslate nohighlight">\(\sigma\)</span>, <span class="math notranslate nohighlight">\(\rho\)</span>, and <span class="math notranslate nohighlight">\(\beta\)</span> exibits a chaotic behavior along one direction.</p></li>
</ul>
</section>
<section id="bifurcation-diagrams-in-higher-dimensional-continuous-systems">
<h3>Bifurcation diagrams in higher dimensional continuous systems<a class="headerlink" href="#bifurcation-diagrams-in-higher-dimensional-continuous-systems" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>When studying the Logistic map we introduced the <a class="reference internal" href="#bifurcation-diagrams"><span class="xref myst">bifurcation diagram</span></a>, which is the succession of period-doubling produced as the control parameter changes.</p></li>
<li><p>We can compute bifurcation diagrams also for higher dimensional continuous systems.</p></li>
<li><p>Compared to unidimensional discrete systems there are two important differences.</p></li>
</ul>
<ol class="arabic simple">
<li><p>Since we have more system’s parameters, we should change one at the time.</p></li>
</ol>
<ol class="arabic simple" start="2">
<li><p>Since the system is continuous, the system variables assume values in a continuous interval.</p>
<ul class="simple">
<li><p>In the continuum we cannot plot all the values assumed by the time series.</p></li>
<li><p>To detect period-doubling we can plot the local maxima and minima of the time series.</p></li>
<li><p>In a contractive regime, the time series will oscillate between a limited number of local minima/maxima.</p></li>
<li><p>At the onset of chaos, the number of local minima/maxima will start to grow</p></li>
</ul>
</li>
</ol>
<ul class="simple">
<li><p>As for the Lyapunov exponent, we will use a function from the companion code of this course, <code class="docutils literal notranslate"><span class="pre">plot_bifurcation_diagram</span></code>.</p></li>
<li><p>The function takes the following arguments:</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code>, <code class="docutils literal notranslate"><span class="pre">func_jac</span></code>, <code class="docutils literal notranslate"><span class="pre">x0</span></code>, <code class="docutils literal notranslate"><span class="pre">time_vector</span></code> are the same as before.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parameters</span></code> is the set of parameters we want to try. Only one parameter should vary, while the others remain constant.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p_idx</span></code> is the index of the parameter that changes in <code class="docutils literal notranslate"><span class="pre">parameters</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">max_time</span></code> is the number of time steps from <code class="docutils literal notranslate"><span class="pre">time_vector</span></code> used to estimate the Lyapunov exponents. If left to <code class="docutils literal notranslate"><span class="pre">None</span></code> all time steps will be used. Since this function takes a lot of time, it’s a good idea to set a limit.</p></li>
</ul>
<ul class="simple">
<li><p>In the following, we compute the bifurcation diagram for Lorenz system as we vary the paramter <span class="math notranslate nohighlight">\(\rho \in [1,100]\)</span>.</p></li>
<li><p>The other parameters are kept fixed: <span class="math notranslate nohighlight">\(\sigma=10\)</span> and <span class="math notranslate nohighlight">\(\beta = 8/3\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Specify the parameters to try</span>
<span class="n">sigma</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="o">/</span><span class="mi">3</span>  
<span class="n">r_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span> 
<span class="n">params</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_values</span><span class="p">)),</span> <span class="n">r_values</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">beta</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">r_values</span><span class="p">))])</span><span class="o">.</span><span class="n">T</span>

<span class="n">x0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">20.</span><span class="p">]</span>  <span class="c1"># Initial conditions</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mf">0.002</span><span class="p">)</span> <span class="c1"># Time vector</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_bifurcation_diagram</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">lorenz</span><span class="p">,</span> <span class="n">func_jac</span><span class="o">=</span><span class="n">lorenz_jac</span><span class="p">,</span> 
                         <span class="n">x0</span><span class="o">=</span><span class="n">x0</span><span class="p">,</span> <span class="n">time_vector</span><span class="o">=</span><span class="n">t</span><span class="p">,</span> 
                         <span class="n">parameters</span><span class="o">=</span><span class="n">params</span><span class="p">,</span> <span class="n">p_idx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_time</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"version_major": 2, "version_minor": 0, "model_id": "71bbfc95b42f4174b646b697fe3bc232"}</script><img alt="../../_images/bdf77a539ef991da516b95e416f08c852cf8b3c74e4b1ff990482325197432ef.png" src="../../_images/bdf77a539ef991da516b95e416f08c852cf8b3c74e4b1ff990482325197432ef.png" />
</div>
</div>
<ul class="simple">
<li><p>The function generated 4 plots.</p></li>
<li><p>The first 3 are the bifurcation diagrams for the system’s variables <span class="math notranslate nohighlight">\(x\)</span>, <span class="math notranslate nohighlight">\(y\)</span>, and <span class="math notranslate nohighlight">\(z\)</span>.</p></li>
<li><p>The last plot shows the largest value among the 3 Lyapunov exponents.</p></li>
<li><p>We see a relationship between the Lyapunov exponents and the onset of chaos in the system.</p></li>
<li><p>When the largest Lyapunov exponent is positive, the system shows a chaotic behavior along at least one direction.</p></li>
</ul>
<p><strong>💡 hint</strong></p>
<ul class="simple">
<li><p>If running <code class="docutils literal notranslate"><span class="pre">plot_bifurcation_diagram</span></code> takes too long, try reducing the number of configuration explored.</p></li>
<li><p>For example, try <code class="docutils literal notranslate"><span class="pre">r_values</span> <span class="pre">=</span> <span class="pre">np.arange(20,</span> <span class="pre">100,</span> <span class="pre">0.5)</span></code>.</p></li>
</ul>
</section>
</section>
<section id="phase-space">
<h2>Phase space<a class="headerlink" href="#phase-space" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The current state of a system is treated as a point in the <em>phase space</em> or <em>state space</em>.</p></li>
<li><p>The phase space represents all the possible states of a system.</p></li>
<li><p>It defines how system variables <span class="math notranslate nohighlight">\(x, y, z, \dots\)</span> interact and evolve.</p></li>
</ul>
<img alt="../../_images/phase_space.png" src="../../_images/phase_space.png" />
<ul class="simple">
<li><p>The phase space gives us complete knowledge about the current state of system.</p></li>
<li><p>We are particularly interested its <em>trajectory</em> (or orbit) over time.</p></li>
<li><p>Knowing it, allows us to make predictions about future states of the system.</p></li>
<li><p>Clearly, this of key importance in time series forecasting.</p></li>
</ul>
<img alt="../../_images/predict.png" src="../../_images/predict.png" />
<ul class="simple">
<li><p>To identify the trajectory of the system in the phase space, we have to identify properties of its attractor.</p></li>
<li><p>One of these, is its <em>dimensionality</em>.</p></li>
<li><p>To determine the dimensionality of an attractor, especially strange attractors of chaotics systems, we have to revise our concept of dimensionality.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="fractal-dimensions">
<h2>Fractal dimensions<a class="headerlink" href="#fractal-dimensions" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>We commonly understand dimensions from a geometric perspective: length, width, depth.</p></li>
<li><p>Common geometrical objects such as a line, a square, or a cube require an increasing number of dimensions to contain them.</p></li>
<li><p>The concept of dimensions is also tied to common measures on these objects such as their perimeter, area, and volume, which require an increasing number of dimensions to express them.</p></li>
</ul>
<img alt="../../_images/dimensions.png" src="../../_images/dimensions.png" />
<ul class="simple">
<li><p>In this perspective, dimensions are integers and the idea of a fractional dimension, e.g., <span class="math notranslate nohighlight">\(d=1.26\)</span>, makes little sense.</p></li>
</ul>
<ul class="simple">
<li><p>Let’s now take a different approach.</p></li>
<li><p>Let’s think at dimensions as how much they scale up some quantity.</p></li>
<li><p>For example, let’s double the edge of a suqare.</p></li>
<li><p>The perimeter will grow by a factor of 2, while the area by a factor of 4.</p></li>
<li><p>If we double the edge of a cube its volume gets 8 times bigger.</p></li>
</ul>
<ul class="simple">
<li><p>Similarly, we can divide an edge into <span class="math notranslate nohighlight">\(r\)</span> pieces and counting how many parts we obtain.</p></li>
<li><p>Let <span class="math notranslate nohighlight">\(r\)</span> be the <em>scaling factor</em> and <span class="math notranslate nohighlight">\(N\)</span> the number of pieces we obtain.</p></li>
<li><p>For the line is straightforward:</p></li>
</ul>
<img alt="../../_images/line.png" src="../../_images/line.png" />
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(r\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(N\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>1</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2</p></td>
<td class="text-center"><p>2</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>4</p></td>
<td class="text-center"><p>4</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>We can easily derive the following rule: <span class="math notranslate nohighlight">\(N=r^D\)</span> with <span class="math notranslate nohighlight">\(D=1\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>Let’s move to the square and repeat the same computations.</p></li>
</ul>
<img alt="../../_images/square.png" src="../../_images/square.png" />
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(r\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(N\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>1</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2</p></td>
<td class="text-center"><p>4</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>4</p></td>
<td class="text-center"><p>16</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>The same rule as before applies, <span class="math notranslate nohighlight">\(N=r^D\)</span>, but now <span class="math notranslate nohighlight">\(D=2\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>Finally, for the cube we have:</p></li>
</ul>
<img alt="../../_images/cube.png" src="../../_images/cube.png" />
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p><span class="math notranslate nohighlight">\(r\)</span></p></th>
<th class="head text-center"><p><span class="math notranslate nohighlight">\(N\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>1</p></td>
<td class="text-center"><p>1</p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>2</p></td>
<td class="text-center"><p>8</p></td>
</tr>
<tr class="row-even"><td class="text-center"><p>4</p></td>
<td class="text-center"><p>64</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>The number of pieces is still <span class="math notranslate nohighlight">\(N=r^D\)</span> when <span class="math notranslate nohighlight">\(D=3\)</span>.</p></li>
<li><p>So far, the value of <span class="math notranslate nohighlight">\(D\)</span> aligns with how we are used to perceive the dimensionality of these objects.</p></li>
</ul>
<ul class="simple">
<li><p>Next, we move to a fractal object, called Koch curve (or Koch snowflake).</p></li>
<li><p>We try to approximate the length of the curve with segments of decreasing length.</p></li>
<li><p>Let’s start with a segment of length <span class="math notranslate nohighlight">\(r=1\)</span>.</p></li>
</ul>
<img alt="../../_images/koch1.png" src="../../_images/koch1.png" />
<ul class="simple">
<li><p>If we split the segment in <span class="math notranslate nohighlight">\(r=3\)</span>, we can fit <span class="math notranslate nohighlight">\(N=4\)</span> pieces.</p></li>
</ul>
<img alt="../../_images/koch2.png" src="../../_images/koch2.png" />
<ul class="simple">
<li><p>If we split it in <span class="math notranslate nohighlight">\(r=9\)</span>, we can fit <span class="math notranslate nohighlight">\(N=16\)</span> pieces, and so on.</p></li>
</ul>
<img alt="../../_images/koch3.png" src="../../_images/koch3.png" />
<ul class="simple">
<li><p>The relationship that we defied before, <span class="math notranslate nohighlight">\(N=r^D\)</span>, is the key to find the dimensionality of this fractal object.</p></li>
<li><p>In particular, we have</p></li>
</ul>
<div class="math notranslate nohighlight">
\[4 = 3^D \rightarrow \log(4) = \log(3)\cdot D \rightarrow = D = \frac{\log(4)}{\log(3)} \approx 1.26 \]</div>
<ul class="simple">
<li><p>Intuitively, think that we need a more “dimensionality” to contain this object than what we need to contain a line, but less than what we need to contain an area.</p></li>
</ul>
<ul class="simple">
<li><p>Another example is the Sierpinski triangle.</p></li>
</ul>
<img alt="../../_images/triangle.png" src="../../_images/triangle.png" />
<ul class="simple">
<li><p>Following the same procedure, we have that <span class="math notranslate nohighlight">\(D = \frac{\log(3)}{\log(2)} \approx  1.58\)</span>.</p></li>
<li><p>Clearly, we need more “dimensionality” to contain this object than the Koch curve, but, due to all the “holes”, still less than an area.</p></li>
</ul>
<section id="chaos-and-fractals">
<h3>Chaos and Fractals<a class="headerlink" href="#chaos-and-fractals" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>There is a deep and ubiquitous connection between chaos and fractals.</p></li>
<li><p>For example, some bifurcation diagrams are self-similar.</p></li>
<li><p>If we zoom-in on the value <span class="math notranslate nohighlight">\(r \approx 3.83\)</span> of the bifurcation diagram of the Logistic map, the situation nearby looks like a shrunk and slightly distorted version of the whole diagram.</p></li>
<li><p>The same is true for all other non-chaotic points.</p></li>
</ul>
<img alt="../../_images/logistic-zoom.gif" src="../../_images/logistic-zoom.gif" />
<div style="text-align: center; font-size: 15px;">Image: <a href="https://github.com/jonnyhyman/Chaos">jonnyhyman</a></div><ul class="simple">
<li><p>Another beautiful relationship is the one between the Mandelbrot Set and the bifurcation map of the Logistic map.</p></li>
</ul>
<img alt="../../_images/Logistic_Map_Bifurcations_Underneath_Mandelbrot_Set.gif" src="../../_images/Logistic_Map_Bifurcations_Underneath_Mandelbrot_Set.gif" />
<div style="text-align: center; font-size: 15px;">Image: <a href="https://github.com/jonnyhyman/Chaos">jonnyhyman</a></div><ul class="simple">
<li><p>The trajectory of a strange attractor does not fill the phase space, but only a fraction of it.</p></li>
<li><p>In other words, a the dimensionality of the attractor of a chaotic system is fractal.</p></li>
<li><p>Determining such dimensionality is key to <em>reconstruct</em> the phase space.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="phase-space-reconstruction">
<h2>Phase space reconstruction<a class="headerlink" href="#phase-space-reconstruction" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>As for the previous examples, dynamical systems are often governed by the evolution of several interacting variables <span class="math notranslate nohighlight">\(x_1, x_2, \dots, x_D\)</span>.</p></li>
<li><p>In most realistic scenarios, however, we cannot directly observe all system’s variables.</p></li>
<li><p>We can only measure <em>partial observations</em>, i.e., a subset of the system’s variables or a function of them <span class="math notranslate nohighlight">\(y = f(x_1, x_2, \dots, x_D)\)</span>.</p></li>
</ul>
<img alt="../../_images/partial1.png" src="../../_images/partial1.png" />
<p><strong>Examples</strong></p>
<ul class="simple">
<li><p>In the Lorenz system, we might observe only the variable <span class="math notranslate nohighlight">\(y(t)\)</span>.</p></li>
<li><p>In weather forecasting, meteorologists often have access only to partial observations of a subset of variables such as temperature, pressure, humidity, wind patterns, and geographic features. However, there are many other variables that are inaccessible such as detailed atmospheric conditions, microclimates, oceans’ temperatures, currents, the presence of pollutants, variations in solar radiation, etc..</p></li>
</ul>
<ul class="simple">
<li><p>Can we reconstruct the trajectory of the system in the state space from partial observations?</p></li>
<li><p>If we are able to do so, we can predict the future states of the systems, including the observed time series.</p></li>
</ul>
<img alt="../../_images/reconstruct.png" src="../../_images/reconstruct.png" />
<section id="takens-embedding-theorem">
<h3>Takens’ Embedding Theorem<a class="headerlink" href="#takens-embedding-theorem" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Assume a dynamical system with an unknown or partially known state space.</p></li>
<li><p>Takens’ Embedding Theorem says that it is possible to reconstruct the dynamics of the whole system using a series of observations from a <em>single</em> variable.</p></li>
<li><p>This means that even if we cannot observe the entire state of a system directly, we can still understand its dynamics through proper analysis of a single observable variable.</p></li>
</ul>
<p><strong>Time-delay embedding vector</strong></p>
<ul class="simple">
<li><p>Let <span class="math notranslate nohighlight">\(x(t)\)</span> be the observed time series.</p></li>
<li><p>The embedding vector <span class="math notranslate nohighlight">\(\mathbf{e}(t) = [e_1, e_2, \dots, e_N]\)</span> is defined as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align} e_1(t) &amp;= x(t) \\ e_2(t) &amp;= x(t + \tau) \\ e_3(t) &amp;= x(t + 2\tau) \\ \dots \\ e_m(t) &amp;= x(t + (m-1)\tau) \end{align}\end{split}\]</div>
<ul class="simple">
<li><p>Here, <span class="math notranslate nohighlight">\(\tau\)</span> is a chosen <em>time delay</em> and <span class="math notranslate nohighlight">\(m\)</span> is the <em>embedding dimension</em>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">takens_embedding</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">dimension</span><span class="p">):</span>
    <span class="n">embedding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">-</span><span class="n">delay</span><span class="o">*</span><span class="n">dimension</span><span class="p">]])</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">dimension</span><span class="p">):</span>
        <span class="n">embedding</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">embedding</span><span class="p">,</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">delay</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">-</span> <span class="n">delay</span><span class="o">*</span><span class="p">(</span><span class="n">dimension</span> <span class="o">-</span> <span class="n">i</span><span class="p">)]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">embedding</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">400</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>                      <span class="c1"># time series</span>
<span class="n">tau</span> <span class="o">=</span> <span class="mi">3</span>                            <span class="c1"># time delay</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">7</span>                              <span class="c1"># embedding dimension</span>
<span class="n">emb</span> <span class="o">=</span> <span class="n">takens_embedding</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>  <span class="c1"># compute embeddings</span>

<span class="n">cmap</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;inferno&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">N</span><span class="p">):</span>
    <span class="n">_label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;$x(t + </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">*</span><span class="se">\\</span><span class="s2">tau )$&quot;</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="sa">f</span><span class="s1">&#39;$x(t)$&#39;</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">emb</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="n">_label</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">cmap</span><span class="p">(</span><span class="n">i</span> <span class="o">/</span> <span class="p">(</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time-delay embedding vectors&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/86c70db4bf23d5eb2e30e07c5185886b4bf8bbec3ec3db1069a0570dbabb4cad.png" src="../../_images/86c70db4bf23d5eb2e30e07c5185886b4bf8bbec3ec3db1069a0570dbabb4cad.png" />
</div>
</div>
<p><strong>Theorem formulation</strong></p>
<img alt="../../_images/takens.png" src="../../_images/takens.png" />
<ul class="simple">
<li><p>Takens’ theorem does not specify how to choose <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(\tau\)</span>.</p></li>
<li><p>It only asserts that for a system with an attractor of (fractional) dimension <span class="math notranslate nohighlight">\(D\)</span>, an embedding dimension <span class="math notranslate nohighlight">\(m &gt; 2D\)</span> is sufficient to ensure a diffeomorphic (topologically equivalent) embedding under generic conditions.</p></li>
<li><p>Intuitively, the embedding dimension must be large enough to unfold the attractor fully in the reconstructed phase space, capturing its dynamics without self-intersections.</p></li>
<li><p>How do we estimate <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(\tau\)</span> from a single time series?</p></li>
</ul>
<section id="estimating-time-delay-tau">
<h4>Estimating time delay <span class="math notranslate nohighlight">\(\tau\)</span><a class="headerlink" href="#estimating-time-delay-tau" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>We can rely on <em>mutual information</em> (MI) to compute <span class="math notranslate nohighlight">\(\tau\)</span>.</p></li>
<li><p>MI quantifies the amount of information between two random variables.</p></li>
<li><p>We are interested in computing MI between the time series and its lagged version.</p></li>
<li><p>Think of MI as a more powerful autocorrelation that captures also non-linear relationships.</p></li>
<li><p>When MI reaches its minumum for a certain lag <span class="math notranslate nohighlight">\(\tau\)</span>, it means that the the observations are sufficiently independent while still retaining meaningful information about the dynamics of the system.</p></li>
</ul>
<ol class="arabic simple">
<li><p>Compute the minimum <span class="math notranslate nohighlight">\(x_\text{min}\)</span> and maximum <span class="math notranslate nohighlight">\(x_\text{max}\)</span> of the time series.</p></li>
<li><p>Split the interval <span class="math notranslate nohighlight">\([x_\text{min}, x_\text{max}]\)</span> into <span class="math notranslate nohighlight">\(n_\text{bins}\)</span> bins.</p></li>
<li><p>Denote <span class="math notranslate nohighlight">\(p_t(h)\)</span> the probability that an element of <span class="math notranslate nohighlight">\(x(t)\)</span> is in the <span class="math notranslate nohighlight">\(h\)</span>-th bin.</p></li>
<li><p>Denote <span class="math notranslate nohighlight">\(p_{t+\tau}(k)\)</span> the probability that an element of <span class="math notranslate nohighlight">\(x(t+\tau)\)</span> is in the <span class="math notranslate nohighlight">\(k\)</span>-th bin.</p></li>
<li><p>Denote <span class="math notranslate nohighlight">\(p_{t, t+\tau}(h, k)\)</span> the probability that <span class="math notranslate nohighlight">\(x(t)\)</span> is in the <span class="math notranslate nohighlight">\(h\)</span>-th bin, while <span class="math notranslate nohighlight">\(x(t+\tau)\)</span> is in the <span class="math notranslate nohighlight">\(k\)</span>-th bin.</p></li>
</ol>
<ol class="arabic simple" start="6">
<li><p>Define the MI as</p></li>
</ol>
<div class="math notranslate nohighlight">
\[I(\tau) = - \sum \limits_{h=1}^{n_\text{bins}} \sum \limits_{k=1}^{n_\text{bins}} p_{t, t+\tau}(h, k) \log \frac{p_{t, t+\tau}(h, k)}{p_t(h) \cdot p_{t+\tau}(k)}\]</div>
<ol class="arabic simple" start="7">
<li><p>Compute <span class="math notranslate nohighlight">\(\tau^* = \text{argmin}_\tau I(\tau)\)</span>.</p></li>
</ol>
<ul class="simple">
<li><p>Let’s write a Python code to compute the MI for a time series and lagged versions of itself.</p></li>
<li><p>As an example, we consider the time series <span class="math notranslate nohighlight">\(x(t)\)</span> from the Rössler system.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parameters</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">5.7</span>
<span class="n">y0</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]</span>  <span class="c1"># Initial conditions</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1500</span> <span class="c1"># Final time</span>
<span class="n">t_span</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">]</span>  <span class="c1"># Time span for the integration</span>

<span class="c1"># Solve the differential equations</span>
<span class="n">solution</span> <span class="o">=</span> <span class="n">solve_ivp</span><span class="p">(</span><span class="n">rossler_system</span><span class="p">,</span> <span class="n">t_span</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="n">dense_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="mf">5e3</span><span class="p">))</span>
<span class="n">ross_sol</span> <span class="o">=</span> <span class="n">solution</span><span class="o">.</span><span class="n">sol</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ross_ts</span> <span class="o">=</span> <span class="n">ross_sol</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ross_ts</span><span class="p">[:</span><span class="mi">500</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/71bbd56240d0924fef8d7a160f93443a73ccb8b089847d0e4f9d72fdcf21a3cb.png" src="../../_images/71bbd56240d0924fef8d7a160f93443a73ccb8b089847d0e4f9d72fdcf21a3cb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">mutual_information</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">n_bins</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate the mutual information for a given delay using histograms.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Prepare delayed data</span>
    <span class="n">delayed_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">delay</span><span class="p">:]</span>
    <span class="n">original_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="o">-</span><span class="n">delay</span><span class="p">]</span>
    
    <span class="c1"># Compute histograms</span>
    <span class="n">p_x</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">original_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">n_bins</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">p_y</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">delayed_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bin_edges</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">p_xy</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram2d</span><span class="p">(</span><span class="n">original_data</span><span class="p">,</span> <span class="n">delayed_data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bin_edges</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="c1"># Calculate mutual information</span>
    <span class="n">mutual_info</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bins</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">p_xy</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">p_y</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">mutual_info</span> <span class="o">+=</span> <span class="n">p_xy</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_xy</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">p_x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">p_y</span><span class="p">[</span><span class="n">j</span><span class="p">]))</span>
    
    <span class="k">return</span> <span class="n">mutual_info</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Now we calculate the MI for different values of <span class="math notranslate nohighlight">\(\tau\)</span>, display it, and find its first minimum.</p></li>
<li><p>This gives us the optimal embedding delay.</p></li>
<li><p>We use 50 bins and, since we have 5000 data points, we will have 100 points in each bin.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MI</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">):</span>
    <span class="n">MI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MI</span><span class="p">,[</span><span class="n">mutual_information</span><span class="p">(</span><span class="n">ross_ts</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="mi">50</span><span class="p">)])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">25</span><span class="p">),</span> <span class="n">MI</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;delay&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;mutual information&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b6fff9bbb183412393e9d0ed91cc4ab61765082b6820b28d17490298a9f48aa3.png" src="../../_images/b6fff9bbb183412393e9d0ed91cc4ab61765082b6820b28d17490298a9f48aa3.png" />
</div>
</div>
<ul class="simple">
<li><p>We see that the optimal value of <span class="math notranslate nohighlight">\(\tau\)</span> is <span class="math notranslate nohighlight">\(4\)</span> or <span class="math notranslate nohighlight">\(5\)</span>.</p></li>
</ul>
<p><strong>Note</strong></p>
<ul class="simple">
<li><p>Things change quite a lot if data are sampled with different frequencies.</p></li>
<li><p>In this example we used <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">np.linspace(0,</span> <span class="pre">1500,</span> <span class="pre">int(5e3))</span></code>.</p></li>
<li><p>Try to see how things change for <code class="docutils literal notranslate"><span class="pre">t</span> <span class="pre">=</span> <span class="pre">np.linspace(0,</span> <span class="pre">500,</span> <span class="pre">int(5e4))</span></code> the time vector we used before to draw the attractor in the <a class="reference internal" href="#rossler-system"><span class="xref myst">Rössler system</span></a>.</p></li>
<li><p>The result is also influenced by the value of <code class="docutils literal notranslate"><span class="pre">n_bins</span></code>.</p>
<ul>
<li><p>Choosing these kind of hyperparameters is often a sensitive choice in estimators for information theoretical quantities such as the MI.</p></li>
</ul>
</li>
</ul>
</section>
<section id="estimating-the-embedding-dimension-m">
<h4>Estimating the embedding dimension <span class="math notranslate nohighlight">\(m\)</span><a class="headerlink" href="#estimating-the-embedding-dimension-m" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>We can estimate <span class="math notranslate nohighlight">\(m\)</span> by using a measure called <em>false nearest neighbours</em> (FNN).</p></li>
<li><p>The <em>false neighbors</em> are points that appear close in lower dimensions due to projection, but are not actually close in the higher-dimensional space.</p></li>
<li><p>The main idea behind FNN is to increase the embedding dimension until the fraction of false neighbors falls below a certain threshold.</p></li>
</ul>
<ol class="arabic simple">
<li><p>Start with a low embedding dimension <span class="math notranslate nohighlight">\(m=1\)</span> and compute the time-delayed reconstructions of the phase space.</p></li>
<li><p>For each point in the reconstructed phase space, identify its nearest neighbor.</p></li>
<li><p>Calculate the distance between each point and its nearest neighbor in the current embedding dimension <span class="math notranslate nohighlight">\(m\)</span> and then in the next higher dimension <span class="math notranslate nohighlight">\(m+1\)</span>.</p></li>
</ol>
<ol class="arabic simple" start="4">
<li><p>Determine if the neighbor is ‘false’ by checking if the distance between the point and its nearest neighbor increases significantly when moving from dimension <span class="math notranslate nohighlight">\(m\)</span> to <span class="math notranslate nohighlight">\(m+1\)</span>. A neighbor is considered false if:</p></li>
</ol>
<div class="math notranslate nohighlight">
\[\frac{|R_{m+1} - R_m|}{R_m} &gt; R_{tol}\]</div>
<ul class="simple">
<li><p>where</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(R_m\)</span> is the distance between the point and its nearest neighbor in dimension <span class="math notranslate nohighlight">\(m\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{m+1}\)</span> is the distance in dimension <span class="math notranslate nohighlight">\(m+1\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(R_{tol}\)</span> is a threshold for deciding if the increase in distance is significant.</p></li>
</ul>
</li>
</ul>
<ol class="arabic simple" start="5">
<li><p>Compute the fraction of false nearest neighbors for the current dimension.</p></li>
<li><p>Repeat the process by increasing <span class="math notranslate nohighlight">\(m\)</span> until the fraction of false nearest neighbors a sufficiently low value indicating that the attractor is completely unfolded.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calculate_fnn</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">max_emb_dim</span><span class="p">,</span> <span class="n">R_tol</span><span class="o">=</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">fnn_proportions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_emb_dim</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        
        <span class="c1"># Compute embeddings in m and m+1</span>
        <span class="n">emb_m</span> <span class="o">=</span> <span class="n">takens_embedding</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
        <span class="n">emb_m_plus_one</span> <span class="o">=</span> <span class="n">takens_embedding</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">m</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        
        <span class="c1"># Compute the nearest neighbors in m</span>
        <span class="n">nbrs</span> <span class="o">=</span> <span class="n">NearestNeighbors</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">emb_m</span><span class="p">[:</span><span class="o">-</span><span class="n">delay</span><span class="p">])</span>
        <span class="n">distances</span><span class="p">,</span> <span class="n">indices</span> <span class="o">=</span> <span class="n">nbrs</span><span class="o">.</span><span class="n">kneighbors</span><span class="p">(</span><span class="n">emb_m</span><span class="p">[:</span><span class="o">-</span><span class="n">delay</span><span class="p">])</span>

        <span class="n">n_false_nn</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">distances</span><span class="p">)):</span> 
            
            <span class="c1"># Nearest neighbor of i in m and distance from it</span>
            <span class="n">neighbor_index</span><span class="p">,</span> <span class="n">R_m</span> <span class="o">=</span> <span class="n">indices</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">distances</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
            
            <span class="c1"># Dinstance in m+1 from the nearest neighbor in m</span>
            <span class="n">R_m_plus_one</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">emb_m_plus_one</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">emb_m_plus_one</span><span class="p">[</span><span class="n">neighbor_index</span><span class="p">])</span> 

            <span class="c1"># fNN formula</span>
            <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">R_m_plus_one</span> <span class="o">-</span> <span class="n">R_m</span><span class="p">)</span> <span class="o">/</span> <span class="n">R_m</span> <span class="o">&gt;</span> <span class="n">R_tol</span><span class="p">:</span>
                <span class="n">n_false_nn</span> <span class="o">+=</span> <span class="mi">1</span>
        
        <span class="n">fnn_proportion</span> <span class="o">=</span> <span class="n">n_false_nn</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">indices</span><span class="p">)</span>
        <span class="n">fnn_proportions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fnn_proportion</span><span class="p">)</span>
        
    <span class="k">return</span> <span class="n">fnn_proportions</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">nFNN</span> <span class="o">=</span> <span class="n">calculate_fnn</span><span class="p">(</span><span class="n">ross_ts</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">max_emb_dim</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">nFNN</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span><span class="n">nFNN</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Embedding dimension&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Fraction of fNN&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d64a7e0b116195090d7b6640282656505699737db511cfb4e60d84e294181a77.png" src="../../_images/d64a7e0b116195090d7b6640282656505699737db511cfb4e60d84e294181a77.png" />
</div>
</div>
<ul class="simple">
<li><p>As we can see, the fraction of fNN drops to zero for <span class="math notranslate nohighlight">\(m=3\)</span>.</p></li>
<li><p>This makes sense, since we we know that the Rössler system has 3 state variables and its attractor is contained in more than 2 dimensions.</p></li>
<li><p>We are finally ready to reconstruct the attractor.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">emb</span> <span class="o">=</span> <span class="n">takens_embedding</span><span class="p">(</span><span class="n">ross_ts</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plot_attractor</span><span class="p">(</span><span class="n">emb</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Reconstructed Rössler Attractor&quot;</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/825df9ea31fc6eaa24e867e27df7e455a597cf83bd5a133318c68e01d5f3356f.png" src="../../_images/825df9ea31fc6eaa24e867e27df7e455a597cf83bd5a133318c68e01d5f3356f.png" />
</div>
</div>
<ul class="simple">
<li><p>The reconstruction closely resemble the original attractor.</p></li>
<li><p>Remember that the reconstructed attractor needs not to be equal to the actual attractor but only diffeomorphic (topologically equivalent) to it.</p></li>
</ul>
</section>
</section>
</section>
<hr class="docutils" />
<section id="forecasting-nonlinear-time-series">
<h2>Forecasting nonlinear time series<a class="headerlink" href="#forecasting-nonlinear-time-series" title="Link to this heading">#</a></h2>
<section id="regression-on-the-taken-s-embeddings">
<h3>Regression on the Taken’s embeddings<a class="headerlink" href="#regression-on-the-taken-s-embeddings" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Taken’s embeddings are related to the windowed approach for forecasting that we saw in the previous lecture.</p></li>
<li><p>In the following, we show the relationship through a practical forecasting example.</p></li>
<li><p>Given a time series <span class="math notranslate nohighlight">\(\{x(t)\}_{t = 1, 2, \dots, T}\)</span>, a time delay <span class="math notranslate nohighlight">\(\tau\)</span>, and an embedding dimension <span class="math notranslate nohighlight">\(m\)</span>, the matrix <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> of Takens’ embeddings can be represented as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{E} = \begin{pmatrix}
x(t)           &amp; x(t+\tau)      &amp; x(t+2\tau)     &amp; \dots  &amp; x(t+(m-1)\tau) \\
x(t+1)         &amp; x(t+\tau+1)    &amp; x(t+2\tau+1)   &amp; \dots  &amp; x(t+(m-1)\tau+1) \\
x(t+2)         &amp; x(t+\tau+2)    &amp; x(t+2\tau+2)   &amp; \dots  &amp; x(t+(m-1)\tau+2) \\
\vdots         &amp; \vdots         &amp; \vdots         &amp; \ddots &amp; \vdots \\
x(T-(m-1)\tau) &amp; x(T-(m-2)\tau) &amp; x(T-(m-3)\tau) &amp; \dots  &amp; x(T) \\
\end{pmatrix}
\end{split}\]</div>
<ul class="simple">
<li><p>Each row should contain enough information to describe the dynamics of the system at a certain time step.</p></li>
<li><p>We can use this information to make future predictions.</p></li>
<li><p>For example, we can use the first row <span class="math notranslate nohighlight">\([x(t), x(t+\tau),  x(t+2\tau) \dots  x(t+(m-1)\tau)]\)</span> to predict the next value <span class="math notranslate nohighlight">\(x(t+m\tau)\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>First, we compute the embeddings using as dimension <span class="math notranslate nohighlight">\(m+1\)</span>.</p></li>
<li><p>Then, we will use as input all the columns of <span class="math notranslate nohighlight">\(\mathbf{E}\)</span> except the last one, <code class="docutils literal notranslate"><span class="pre">emb[:,:-1]</span></code>, which will be the target.</p></li>
<li><p>This corresponds to taking a window of size <span class="math notranslate nohighlight">\(m\)</span> of samples taken every <span class="math notranslate nohighlight">\(\tau\)</span> time steps and making a prediction <span class="math notranslate nohighlight">\(\tau\)</span> steps ahead.</p></li>
<li><p>In the example below we will use the <code class="docutils literal notranslate"><span class="pre">RandomForestRegressor</span></code> as the regression model.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">forecast_on_phase_space</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">delay</span><span class="p">,</span> <span class="n">dimension</span><span class="p">,</span> <span class="n">test_prop</span><span class="p">):</span>
    
    <span class="c1"># Compute embeddings</span>
    <span class="n">emb</span> <span class="o">=</span> <span class="n">takens_embedding</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="n">delay</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="n">dimension</span><span class="p">)</span>
    
    <span class="c1"># Create input and target</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">emb</span><span class="p">[:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">emb</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="c1"># Divide into train and test</span>
    <span class="n">test_size</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="n">test_prop</span><span class="p">)</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">X</span><span class="p">[:</span><span class="o">-</span><span class="n">test_size</span><span class="p">,</span> <span class="p">:]</span>
    <span class="n">y_train</span> <span class="o">=</span> <span class="n">y</span><span class="p">[:</span><span class="o">-</span><span class="n">test_size</span><span class="p">]</span>
    <span class="n">X_test</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="o">-</span><span class="n">test_size</span><span class="p">:,</span> <span class="p">:]</span>
    <span class="n">y_test</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="n">test_size</span><span class="p">:]</span>
    
    <span class="c1"># Fit the regressor on the training data</span>
    <span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    
    <span class="c1"># Predict the test data</span>
    <span class="n">preds</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;MSE: </span><span class="si">{</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span><span class="w"> </span><span class="n">preds</span><span class="p">)</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">preds</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">forecast_on_phase_space</span><span class="p">(</span><span class="n">ross_ts</span><span class="p">,</span> <span class="n">delay</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">test_prop</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 0.215
</pre></div>
</div>
<img alt="../../_images/57b4ba91c0010ceb1aee5b6560b119d4e4cfdf771d70197d892216aea51264a0.png" src="../../_images/57b4ba91c0010ceb1aee5b6560b119d4e4cfdf771d70197d892216aea51264a0.png" />
</div>
</div>
<ul class="simple">
<li><p>As we can see, we obtain a pretty good prediction.</p></li>
<li><p>This means that the window <span class="math notranslate nohighlight">\([x(t), x(t+\tau),  x(t+2\tau) \dots  x(t+(m-1)\tau)]\)</span> contains enough information to predict the next value <span class="math notranslate nohighlight">\(x(t+m\tau)\)</span>.</p></li>
</ul>
</section>
<section id="echo-state-network">
<h3>Echo State Network<a class="headerlink" href="#echo-state-network" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Rather than using the time embeddings, we can use the states of the Reservoir of an Echo State Network as input for our regression model.</p></li>
<li><p>We will perform the same prediction <span class="math notranslate nohighlight">\(\tau\)</span>-steps ahead.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Xtr</span><span class="p">,</span> <span class="n">Ytr</span><span class="p">,</span> <span class="n">Xte</span><span class="p">,</span> <span class="n">Yte</span><span class="p">,</span> <span class="n">scaler</span> <span class="o">=</span> <span class="n">make_forecasting_dataset</span><span class="p">(</span><span class="n">ross_ts</span><span class="p">[:,</span><span class="kc">None</span><span class="p">],</span> 
                                                  <span class="n">horizon</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                                                  <span class="n">test_percent</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Xtr shape: </span><span class="si">{</span><span class="n">Xtr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">Ytr shape: </span><span class="si">{</span><span class="n">Ytr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">Xte shape: </span><span class="si">{</span><span class="n">Xte</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">Yte shape: </span><span class="si">{</span><span class="n">Yte</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Xtr shape: (4495, 2)
Ytr shape: (4495, 1)
Xte shape: (495, 2)
Yte shape: (495, 1)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Next, we initialize the Reservoir and compute the states.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">=</span> <span class="n">Reservoir</span><span class="p">(</span><span class="n">n_internal_units</span><span class="o">=</span><span class="mi">900</span><span class="p">,</span>
               <span class="n">spectral_radius</span><span class="o">=</span><span class="mf">0.99</span><span class="p">,</span>
               <span class="n">input_scaling</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
               <span class="n">connectivity</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>

<span class="n">n_drop</span><span class="o">=</span><span class="mi">10</span>
<span class="n">states_tr</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_states</span><span class="p">(</span><span class="n">Xtr</span><span class="p">[</span><span class="kc">None</span><span class="p">,:,:],</span> <span class="n">n_drop</span><span class="o">=</span><span class="n">n_drop</span><span class="p">,</span> <span class="n">bidir</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">states_te</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">get_states</span><span class="p">(</span><span class="n">Xte</span><span class="p">[</span><span class="kc">None</span><span class="p">,:,:],</span> <span class="n">n_drop</span><span class="o">=</span><span class="n">n_drop</span><span class="p">,</span> <span class="n">bidir</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;states_tr shape: </span><span class="si">{</span><span class="n">states_tr</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">states_te shape: </span><span class="si">{</span><span class="n">states_te</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>states_tr shape: (1, 4485, 900)
states_te shape: (1, 485, 900)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Next, we will reduce the dimensionality of the Reservoir states with PCA.</p></li>
<li><p>This will make fitting the regression model faster.</p></li>
<li><p>Usually, we would choose a reasonably large number, e.g., <span class="math notranslate nohighlight">\(50\)</span>.</p></li>
<li><p>However, here we will reduce the number of dimension to <span class="math notranslate nohighlight">\(m=3\)</span>.</p></li>
<li><p>This will allow us to produce an interesting visualization later.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pca</span> <span class="o">=</span> <span class="n">PCA</span><span class="p">(</span><span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">states_tr_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">states_tr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">states_te_pca</span> <span class="o">=</span> <span class="n">pca</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">states_te</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;states_tr shape: </span><span class="si">{</span><span class="n">states_tr_pca</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">states_te shape: </span><span class="si">{</span><span class="n">states_te_pca</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>states_tr shape: (4485, 3)
states_te shape: (485, 3)
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Next, we fit the regression model to the Reservoir states and compute the predictions.</p></li>
<li><p>Note how good the predictions are even if we use such small states.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the regression model</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">states_tr_pca</span><span class="p">,</span> <span class="n">Ytr</span><span class="p">[</span><span class="n">n_drop</span><span class="p">:,:]</span><span class="o">.</span><span class="n">ravel</span><span class="p">())</span>

<span class="c1"># Compute the predictions</span>
<span class="n">Yhat_pca</span> <span class="o">=</span> <span class="n">rf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">states_te_pca</span><span class="p">)[</span><span class="o">...</span><span class="p">,</span><span class="kc">None</span><span class="p">]</span>

<span class="c1"># Compute the mean squared error</span>
<span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">Yhat_pca</span><span class="p">),</span> <span class="n">Yte</span><span class="p">[</span><span class="n">n_drop</span><span class="p">:,:])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSE: </span><span class="si">{</span><span class="n">mse</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MSE: 0.18
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Yte</span><span class="p">[</span><span class="n">n_drop</span><span class="p">:,:],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;True&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">inverse_transform</span><span class="p">(</span><span class="n">Yhat_pca</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Prediction&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/86838b4784210731e22068c77dc05208670cd25ec3ac353e84f72cdee7408f28.png" src="../../_images/86838b4784210731e22068c77dc05208670cd25ec3ac353e84f72cdee7408f28.png" />
</div>
</div>
<ul class="simple">
<li><p>The ESN is particular good in predicting non-linear time series and chaotic systems in general.</p></li>
<li><p>The reason is that the Reservoir manages very well to reproduce the dynamics in the underlying system.</p></li>
<li><p>To convince ourselves, we can can plot the dynamics of the Reservoir states and observe how closely follows the trajectory of the actual phase space.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_attractor</span><span class="p">(</span><span class="n">states_tr_pca</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Trajecory of Reservoir States&quot;</span><span class="p">,</span> <span class="n">interactive</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ebe350dcf9ddfe4c28f26ba271f20bab842564cc41cf039dc8e3382c8c883a0d.png" src="../../_images/ebe350dcf9ddfe4c28f26ba271f20bab842564cc41cf039dc8e3382c8c883a0d.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="excercise-1">
<h3>Excercise 1<a class="headerlink" href="#excercise-1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Compute the bifurcation map of the Rössler system.</p></li>
<li><p>Keep fixed the parameters <span class="math notranslate nohighlight">\(a = b = 0.2\)</span></p></li>
<li><p>Vary the parameter <span class="math notranslate nohighlight">\(c\)</span> as shown below.</p></li>
<li><p>For each value of <span class="math notranslate nohighlight">\(c\)</span>, compute and plot the local maxima of the time series <span class="math notranslate nohighlight">\(z(t)\)</span> using the function <code class="docutils literal notranslate"><span class="pre">scipy.signal.find_peaks</span></code>. You should obtain a plot that resembles the figure below.</p></li>
<li><p>Identify the first bifurcation point before the system becomes chaotic.</p></li>
<li><p>Explain why computing the local maxima (peaks) was not necessary for the logistic map.</p></li>
</ul>
<img alt="../../_images/rossler_attractor.png" src="../../_images/rossler_attractor.png" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span> <span class="c1"># value of c to explore</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Compute the (fractal) dimension of the object in the figure below.</p></li>
</ul>
<img alt="../../_images/menger-sr.jpeg" src="../../_images/menger-sr.jpeg" />
</section>
<section id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Plot the Lorenz attractor for <span class="math notranslate nohighlight">\(\sigma = 10\)</span>, <span class="math notranslate nohighlight">\(\rho = 28\)</span>, and <span class="math notranslate nohighlight">\(\beta = \frac{8}{3}\)</span>.</p></li>
</ul>
</section>
<section id="exercise-4">
<h3>Exercise 4<a class="headerlink" href="#exercise-4" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Use the Taken’s embedding to reconstruct the Lorenz attractor from the time series of its first state variable <span class="math notranslate nohighlight">\(x(t)\)</span>.</p></li>
<li><p>Compute the optimal time delay <span class="math notranslate nohighlight">\(\tau\)</span> and the optimal embedding dimension <span class="math notranslate nohighlight">\(m\)</span> using the Mutual Information and the false Nearest-Neighbors algorithms.</p></li>
</ul>
</section>
<section id="exercise-5">
<h3>Exercise 5<a class="headerlink" href="#exercise-5" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Compute the predictions of the state variable <span class="math notranslate nohighlight">\(x(t)\)</span> of the Lorenz system using the Taken’s delay embeddings and a regression algorithm of your choice (Ridge Regression, Random Forest, etc…).</p></li>
</ul>
</section>
<section id="exercise-6">
<h3>Exercise 6<a class="headerlink" href="#exercise-6" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Compute the predictions of the state variable <span class="math notranslate nohighlight">\(x(t)\)</span> of the Lorenz system with an ESN using a forecast horizon of your choice.</p></li>
<li><p>Make a 3D plot of the Reservoir states reduced to 3 dimensions with PCA and compare it to the actual Lorenz attractor.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/11"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../10/nn-reservoir-computing.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Neural networks and Reservoir Computing</p>
      </div>
    </a>
    <a class="right-next"
       href="../12/classification-clustering.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Time series classification and clustering</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#dynamical-systems">Dynamical Systems</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#non-linear-dynamical-systems">Non-linear Dynamical Systems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-logistic-map">The logistic map</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regime-r-1">Regime <span class="math notranslate nohighlight">\(r &lt; 1\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regime-1-r-3">Regime <span class="math notranslate nohighlight">\(1 &lt; r &lt; 3\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regime-r-3">Regime <span class="math notranslate nohighlight">\(r &gt; 3\)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bifurcation-diagrams">Bifurcation diagrams</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#chaotic-systems">Chaotic systems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sensitivity-to-initial-conditions">Sensitivity to initial conditions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detecting-chaos">Detecting chaos</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lyapunov-exponent">Lyapunov exponent</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#return-maps">Return maps</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#higher-dimensional-continous-time-systems">Higher-dimensional continous-time systems</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#d-lotka-volterra-equations">2D - Lotka-Volterra equations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#rossler-system">Rössler system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lorenz-system">Lorenz system</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#lyapunov-exponents-in-higher-dimensional-continuous-systems">Lyapunov exponents in higher dimensional continuous systems</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bifurcation-diagrams-in-higher-dimensional-continuous-systems">Bifurcation diagrams in higher dimensional continuous systems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-space">Phase space</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fractal-dimensions">Fractal dimensions</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chaos-and-fractals">Chaos and Fractals</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#phase-space-reconstruction">Phase space reconstruction</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#takens-embedding-theorem">Takens’ Embedding Theorem</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-time-delay-tau">Estimating time delay <span class="math notranslate nohighlight">\(\tau\)</span></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#estimating-the-embedding-dimension-m">Estimating the embedding dimension <span class="math notranslate nohighlight">\(m\)</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#forecasting-nonlinear-time-series">Forecasting nonlinear time series</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-on-the-taken-s-embeddings">Regression on the Taken’s embeddings</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#echo-state-network">Echo State Network</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#excercise-1">Excercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Filippo Maria Bianchi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>