
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Signal transforms and filters &#8212; Time series analysis with Python</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/08/signal-transforms-filters';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Prophet" href="../09/prophet.html" />
    <link rel="prev" title="Kalman filter" href="../07/kalman-filter.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../00/intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../_static/logo.png" class="logo__image only-light" alt="Time series analysis with Python - Home"/>
    <script>document.write(`<img src="../../_static/logo.png" class="logo__image only-dark" alt="Time series analysis with Python - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../00/intro.html">
                    Time series analysis with Python
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01/introduction_to_time_series.html">Introduction to time series analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02/stationarity.html">Stationarity</a></li>
<li class="toctree-l1"><a class="reference internal" href="../03/smoothing.html">Smoothing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04/ar-ma.html">AR-MA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../05/arma_arima_sarima.html">ARMA, ARIMA, SARIMA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06/unit-root-hurst.html">Unit root test and Hurst exponent</a></li>
<li class="toctree-l1"><a class="reference internal" href="../07/kalman-filter.html">Kalman filter</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Signal transforms and filters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../09/prophet.html">Prophet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../10/nn-reservoir-computing.html">Neural networks and Reservoir Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../11/nonlinear-ts.html">Nonlinear time series analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../12/classification-clustering.html">Time series classification and clustering</a></li>
<li class="toctree-l1"><a class="reference internal" href="../00/resources.html">Resources</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/FilippoMB/python-time-series-handbook" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/FilippoMB/python-time-series-handbook/issues/new?title=Issue%20on%20page%20%2Fnotebooks/08/signal-transforms-filters.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/notebooks/08/signal-transforms-filters.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Signal transforms and filters</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-transform">Fourier Transform</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-fourier-transform">Inverse Fourier Transform</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discrete-fourier-transform-and-fast-fourier-transform">Discrete Fourier Transform and Fast Fourier Transform</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-idea">Basic Idea</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cooley-tukey-algorithm">Cooley-Tukey Algorithm</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-fourier-transforms">Common Fourier Transforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sine">Sine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dirac-delta">Dirac delta</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-step">Unit step</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sinc">Sinc</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#signal-with-trend-and-noise">Signal with Trend and Noise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-leakage">Spectral leakage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-of-the-fourier-transform">Properties of the Fourier transform</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linearity">Linearity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-shift">Time Shift</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-shift">Frequency Shift</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling">Scaling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convolution">Convolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#differentiation">Differentiation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integration">Integration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parseval-s-theorem">Parseval’s Theorem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filters">Filters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-response">Frequency Response</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transfer-function">Transfer Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bode-plot">Bode Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-filters-lpfs">Low Pass Filters (LPFs)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hann-window">Hann Window</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tukey-filter">Tukey Filter</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#butterworth-filter">Butterworth Filter</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#high-pass-filters-hpfs">High Pass Filters (HPFs)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#band-pass-filter">Band Pass Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#band-stop-filter">Band-Stop Filter</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-forecasts-with-fourier-transforms">Making Forecasts with Fourier Transforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forecast-example-1">Forecast example 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forecast-example-2">Forecast example 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detrending-example">Detrending example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="signal-transforms-and-filters">
<h1>Signal transforms and filters<a class="headerlink" href="#signal-transforms-and-filters" title="Link to this heading">#</a></h1>
<img alt="../../_images/cover7.png" src="../../_images/cover7.png" />
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>In this lecture, you will get a basic understanding of the Fourier Transform (FT), Discrete Fourier Transform (DFT), and learn how any function can be approximated with a series of sines and cosines.</p></li>
<li><p>In particular, you will learn the FT of common signals, the main properties of FT, and the practical skills needed to apply the FT.</p></li>
<li><p>In addition, you will learn some common filters and why they are useful to process time series data.</p></li>
<li><p>Finally, we will see how FT can be useful in forecasting tasks.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">YouTubeVideo</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">signal</span>
<span class="kn">from</span> <span class="nn">scipy.integrate</span> <span class="kn">import</span> <span class="n">cumulative_trapezoid</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">tsa_course.lecture8</span> <span class="kn">import</span> <span class="n">annotated_sin_plot</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_pacf</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.arima.model</span> <span class="kn">import</span> <span class="n">ARIMA</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.arima_process</span> <span class="kn">import</span> <span class="n">arma_generate_sample</span>
<span class="kn">from</span> <span class="nn">tsa_course.lecture2</span> <span class="kn">import</span> <span class="n">run_sequence_plot</span>
</pre></div>
</div>
</div>
</div>
</section>
<hr class="docutils" />
<section id="fourier-transform">
<h2>Fourier Transform<a class="headerlink" href="#fourier-transform" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The idea behind the Fourier Transform is that any time signal can be decomposed into a sum of sinusoids that have different amplitude, frequencies, and phases.</p></li>
<li><p>Let’s start from the definition of a <strong>sine wave</strong>.</p></li>
</ul>
<ul class="simple">
<li><p>A sine wave is mathematical curve that describes smooth periodic oscillations.</p></li>
<li><p>It is continuous and is described by:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[y(t) = A \sin (2 \pi f t + \psi) = A \sin (\omega t + \psi)\]</div>
<ul class="simple">
<li><p>where <span class="math notranslate nohighlight">\(A\)</span> is the amplitude, <span class="math notranslate nohighlight">\(f\)</span> is the frequency, and <span class="math notranslate nohighlight">\(\psi\)</span> is the phase in radians.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">annotated_sin_plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/940f2c4cc9422b2560a68c3db6813aed2f32c8d1f865515f32e855f56e1072e9.png" src="../../_images/940f2c4cc9422b2560a68c3db6813aed2f32c8d1f865515f32e855f56e1072e9.png" />
</div>
</div>
<ul class="simple">
<li><p>The FT decomposes a time signal into the sum of sines with varying amplitudes, frequencies, and phases.</p></li>
<li><p>The sines represent the constituent frequencies of the original signal.</p></li>
<li><p>As such, FT gives the frequency domain representation of the original signal.</p></li>
</ul>
<img alt="../../_images/ft.png" src="../../_images/ft.png" />
<p>The Fourier Transform mathematical formulation is given by:</p>
<div class="amsmath math notranslate nohighlight" id="equation-ffb9a0e0-48ec-4266-8f00-41ac7e828425">
<span class="eqno">()<a class="headerlink" href="#equation-ffb9a0e0-48ec-4266-8f00-41ac7e828425" title="Permalink to this equation">#</a></span>\[\begin{equation}\mathcal{F}(\omega) = \int_{-\infty}^{\infty} f(t) e^{-i \omega t} dt \end{equation}\]</div>
<ul class="simple">
<li><p>where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(t\)</span> is time,</p></li>
<li><p><span class="math notranslate nohighlight">\(f(t)\)</span> is a continuous time signal,</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{F}(\omega)\)</span> is the Fourier Transform of <span class="math notranslate nohighlight">\(f(t)\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(f(t)\)</span> is the original time-domain function (signal),</p></li>
<li><p><span class="math notranslate nohighlight">\(\omega = 2\pi f\)</span> is the angular frequency,</p></li>
<li><p><span class="math notranslate nohighlight">\(e\)</span> is the base of the natural logarithm,</p></li>
<li><p><span class="math notranslate nohighlight">\(i\)</span> is the imaginary unit, satisfying <span class="math notranslate nohighlight">\(i^2 = -1\)</span>.</p></li>
</ul>
</li>
</ul>
<p><strong>Explanation</strong></p>
<ul class="simple">
<li><p>The term <span class="math notranslate nohighlight">\(e^{-i \omega t}\)</span> is a complex exponential.</p></li>
<li><p>It can be decomposed as <span class="math notranslate nohighlight">\(e^{-i \omega t} = \cos(\omega t) -i \sin(\omega t)\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(e^{-i \omega t}\)</span> can be thought of as a rotating vector (phasor) in the complex plane, where <span class="math notranslate nohighlight">\(\omega\)</span> dictates the speed of rotation and <span class="math notranslate nohighlight">\(t\)</span> represents time.</p></li>
</ul>
<ul class="simple">
<li><p>The integral over time indicates that the transformation considers all points in time from <span class="math notranslate nohighlight">\(-\infty\)</span> to <span class="math notranslate nohighlight">\(+\infty\)</span>, giving a complete representation of the signal in the frequency domain.</p></li>
<li><p>In practice, we cannot deal with infinity.</p></li>
<li><p>Various windowing techniques or assumptions may be applied.</p></li>
</ul>
<ul class="simple">
<li><p>The result of the Fourier Transform is a complex function of frequency.</p></li>
<li><p>It shows how much of each frequency is present in the original signal.</p></li>
<li><p>The <em>magnitude</em> of <span class="math notranslate nohighlight">\(\mathcal{F}(\omega)\)</span> indicates the amplitude of a particular frequency component.</p></li>
<li><p>Its <em>phase</em> (angle of the complex number) indicates the phase shift of that frequency component relative to the origin.</p></li>
</ul>
<ul class="simple">
<li><p>The intuitive interpretation of Eq.1 is that the effect of multiplying <span class="math notranslate nohighlight">\(f(t)\)</span> by  <span class="math notranslate nohighlight">\(e^{-i\omega t}\)</span> is to subtract <span class="math notranslate nohighlight">\(\omega\)</span> from every frequency component of <span class="math notranslate nohighlight">\(f(t)\)</span>.</p></li>
<li><p>Only the component that was at frequency <span class="math notranslate nohighlight">\(\omega\)</span> can produce a non-zero value of the infinite integral, because all the other shifted components are oscillatory and integrate to zero.</p></li>
</ul>
<img alt="https://upload.wikimedia.org/wikipedia/commons/b/bd/Fourier_series_square_wave_circles_animation.svg" src="https://upload.wikimedia.org/wikipedia/commons/b/bd/Fourier_series_square_wave_circles_animation.svg" /><div style="text-align: center; font-size: 80%">Image: <a href="https://commons.wikimedia.org/wiki/File:Fourier_series_square_wave_circles_animation.svg#filelinks">Wikimedia</a></div><section id="inverse-fourier-transform">
<h3>Inverse Fourier Transform<a class="headerlink" href="#inverse-fourier-transform" title="Link to this heading">#</a></h3>
<div class="math notranslate nohighlight">
\[ f(t) = \int_{-\infty}^{\infty} \mathcal{F}(\omega) e^{i \omega t} d \omega \]</div>
<ul class="simple">
<li><p>The inverse Fourier Transform expresses a signal <span class="math notranslate nohighlight">\(f(t)\)</span> as a weighted summation of complex exponential functions.</p></li>
<li><p>The formula is very similar to FT.</p></li>
<li><p>It shows us that <em>any</em> function can be expressed as a combination of sinusoids.</p></li>
<li><p>The sinusoids represent, thus, a <em>basis</em>.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="discrete-fourier-transform-and-fast-fourier-transform">
<h2>Discrete Fourier Transform and Fast Fourier Transform<a class="headerlink" href="#discrete-fourier-transform-and-fast-fourier-transform" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>The Discrete Fourier Transform (DFT) converts a <em>finite</em> list of equally spaced samples of a function into the list of coefficients of a finite combination of complex sinusoids, ordered by their frequencies.</p></li>
<li><p>The Fast Fourier Transform (FFT) is an algorithm designed to compute the DFT and its inverse efficiently.</p></li>
<li><p>The FFT significantly reduces the computational complexity of performing a DFT from <span class="math notranslate nohighlight">\(\mathcal{O}(N^2)\)</span> to <span class="math notranslate nohighlight">\(\mathcal{O}(N \log N)\)</span>, where <span class="math notranslate nohighlight">\(N\)</span> is the number of samples.</p></li>
<li><p>This efficiency gain is particularly impactful for large datasets, making the FFT an indispensable tool in digital signal processing, image analysis, fast convolution, and various fields of engineering and applied science.</p></li>
</ul>
<p>This <a class="reference external" href="https://youtu.be/QmgJmh2I3Fw">video</a> gives an excellent introduction to DFT.</p>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">YouTubeVideo</span><span class="p">(</span><span class="s1">&#39;QmgJmh2I3Fw&#39;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">560</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">315</span><span class="p">)</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<div class="output text_html">
        <iframe
            width="560"
            height="315"
            src="https://www.youtube.com/embed/QmgJmh2I3Fw"
            frameborder="0"
            allowfullscreen
            
        ></iframe>
        </div></div>
</div>
<section id="basic-idea">
<h3>Basic Idea<a class="headerlink" href="#basic-idea" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The DFT for a sequence <span class="math notranslate nohighlight">\(x[n]\)</span> of length <span class="math notranslate nohighlight">\(N\)</span> is defined as follows:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[X[k] = \sum_{n=0}^{N-1} x[n] \cdot e^{-\frac{i 2 \pi}{N} k n}\]</div>
<ul class="simple">
<li><p>for <span class="math notranslate nohighlight">\(k = 0, 1, \ldots, N-1\)</span>, where <span class="math notranslate nohighlight">\(X[k]\)</span> are the frequency domain samples.</p></li>
<li><p>The FFT exploits the symmetry and periodicity properties of the complex exponential function.</p></li>
<li><p>It applies a divide-and-conquer strategy to decompose the DFT of a sequence into smaller DFTs, thereby reducing the overall computational effort.</p></li>
</ul>
</section>
<section id="cooley-tukey-algorithm">
<h3>Cooley-Tukey Algorithm<a class="headerlink" href="#cooley-tukey-algorithm" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The most well-known FFT algorithm is the Cooley-Tukey algorithm.</p></li>
<li><p>It recursively divides the DFT of a sequence into two, by separating the sequence into even and odd elements:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[X[k] = X_{\text{even}}[k] + e^{-\frac{i 2 \pi}{N} k} X_{\text{odd}}[k] \]</div>
<ul class="simple">
<li><p>and</p></li>
</ul>
<div class="math notranslate nohighlight">
\[X[k + \frac{N}{2}] = X_{\text{even}}[k] - e^{-\frac{i 2 \pi}{N} k} X_{\text{odd}}[k]\]</div>
<ul class="simple">
<li><p>This process is repeated on the subsequences until the problem is reduced to the DFT of sequences of length 1, which are trivial.</p></li>
<li><p>The algorithm recombines these results to produce the final DFT.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="common-fourier-transforms">
<h2>Common Fourier Transforms<a class="headerlink" href="#common-fourier-transforms" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>First, we make a list of the most common FT of known functions and report the analytic expression.</p></li>
<li><p>This list is adapted from <a class="reference external" href="https://github.com/cpjobling/eg-247-textbook">here</a>.</p></li>
</ul>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong>Name</strong></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(f(t)\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(F(\omega)\)</span></p></th>
<th class="head"><p><strong>Remarks</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1.</p></td>
<td><p>Dirac delta</p></td>
<td><p><span class="math notranslate nohighlight">\(\delta(t)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(1\)</span></p></td>
<td><p>Constant energy at <em>all</em> frequencies.</p></td>
</tr>
<tr class="row-odd"><td><p>2.</p></td>
<td><p>Time sample</p></td>
<td><p><span class="math notranslate nohighlight">\(\delta(t-t_0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(e^{-i\omega t_0}\)</span></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>3.</p></td>
<td><p>Phase shift</p></td>
<td><p><span class="math notranslate nohighlight">\(e^{i\omega_0 t}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(2\pi\delta(\omega - \omega_0)\)</span></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>4.</p></td>
<td><p><em>Signum</em></p></td>
<td><p><span class="math notranslate nohighlight">\(\operatorname{sgn} t\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle{\frac{2}{i\omega}}\)</span></p></td>
<td><p>Also known as sign function</p></td>
</tr>
<tr class="row-even"><td><p>5.</p></td>
<td><p>Unit step</p></td>
<td><p><span class="math notranslate nohighlight">\(u(t)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle{\frac{1}{i\omega}+\pi\delta(\omega)}\)</span></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>6.</p></td>
<td><p>Cosine</p></td>
<td><p><span class="math notranslate nohighlight">\(\cos \omega_0 t\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\pi\left[\delta(\omega-\omega_0)+\delta(\omega+\omega_0)\right]\)</span></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>7.</p></td>
<td><p>Sine</p></td>
<td><p><span class="math notranslate nohighlight">\(\sin \omega_0 t\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(-i\pi\left[\delta(\omega-\omega_0)-\delta(\omega+\omega_0)\right]\)</span></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p>8.</p></td>
<td><p>Single pole</p></td>
<td><p><span class="math notranslate nohighlight">\(e^{-at}u_0(t)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle{\frac{1}{i\omega + a}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a \gt 0\)</span></p></td>
</tr>
<tr class="row-even"><td><p>9.</p></td>
<td><p>Double pole</p></td>
<td><p><span class="math notranslate nohighlight">\(te^{-at}u_0(t)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle{\frac{1}{(i\omega + a)^2}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a \gt 0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>10.</p></td>
<td><p>Complex pole (cosine component)</p></td>
<td><p><span class="math notranslate nohighlight">\(e^{-at}\cos \omega_0 t\;u_0(t)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle{\frac{i\omega + a}{(i\omega + a)^2+\omega_0^2}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a\gt 0\)</span></p></td>
</tr>
<tr class="row-even"><td><p>11.</p></td>
<td><p>Complex pole (sine component)</p></td>
<td><p><span class="math notranslate nohighlight">\(e^{-a t}\sin \omega_0 t\;u_0(t)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(\displaystyle{\frac{\omega_0}{(i\omega + a)^2+\omega_0^2}}\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(a\gt 0\)</span></p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Next, we provide some examples of the approximation given by FFT.</p></li>
<li><p>We’ll mainly use three functions:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">fft(y)</span></code>: Computes the FFT <span class="math notranslate nohighlight">\(F(\omega)\)</span> of a time signal <span class="math notranslate nohighlight">\(y=f(t)\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fftfreq(n,</span> <span class="pre">d)</span></code>: Returns the Discrete Fourier Transform sample frequencies <span class="math notranslate nohighlight">\(\omega\)</span>; <code class="docutils literal notranslate"><span class="pre">n</span></code> is the windows length and <code class="docutils literal notranslate"><span class="pre">d</span></code> is the sample spacing (inverse of the sampling rate <span class="math notranslate nohighlight">\(f=1/T\)</span>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">fftshift(x)</span></code>: Shifts the zero-frequency component to the center of the spectrum: <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">0.,</span>&#160; <span class="pre">1.,</span>&#160; <span class="pre">2.,</span> <span class="pre">...,</span> <span class="pre">-3.,</span> <span class="pre">-2.,</span> <span class="pre">-1.]</span> <span class="pre">--&gt;</span> <span class="pre">[-5.,</span> <span class="pre">-4.,</span> <span class="pre">-3.,</span> <span class="pre">-2.,</span> <span class="pre">-1.,</span>&#160; <span class="pre">0.,</span>&#160; <span class="pre">1.,</span>&#160; <span class="pre">2.,</span>&#160; <span class="pre">3.,</span>&#160; <span class="pre">4.]</span></code></p></li>
</ul>
</li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convenience function that creates both a time domain and frequency domain plot.</span>
<span class="k">def</span> <span class="nf">plot_time_freq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c1"># Converts Data into Frequncy Domain</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    
    <span class="c1"># Time domain plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">14</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time Domain&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Signal&#39;</span><span class="p">)</span>
    
    <span class="c1"># Frequency domain plot</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">markerline</span><span class="p">,</span> <span class="n">stemline</span><span class="p">,</span> <span class="n">baseline</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">Y</span><span class="p">),</span>
                                              <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">stemline</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">1.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">markerline</span><span class="p">,</span> <span class="n">markersize</span> <span class="o">=</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency Domain&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absolute FFT&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<section id="sine">
<h3>Sine<a class="headerlink" href="#sine" title="Link to this heading">#</a></h3>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p>Time</p></th>
<th class="head text-center"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Sine</p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\(\sin \omega_0 t\)</span>$</p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\(-i\pi\left[\delta(\omega-\omega_0)-\delta(\omega+\omega_0)\right]\)</span>$</p></td>
</tr>
</tbody>
</table>
<p>Let’s start by creating a time series that consists of a sine wave with a frequency of <span class="math notranslate nohighlight">\(1 Hz\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="n">y_sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>
<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_sine</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d8b44bcd49f4db950d81a01b5bc1199d92d410d981f961a424a533099a010a0c.png" src="../../_images/d8b44bcd49f4db950d81a01b5bc1199d92d410d981f961a424a533099a010a0c.png" />
</div>
</div>
<ul class="simple">
<li><p>We can observe that in the frequency domain there are 2 spikes at <span class="math notranslate nohighlight">\(+1Hz\)</span> and <span class="math notranslate nohighlight">\(-1Hz\)</span>.</p></li>
<li><p>This indicates the frequency of the sine wave.</p></li>
<li><p>Note that there is a symmetry between the left and right side across the <span class="math notranslate nohighlight">\(0 Hz\)</span> frequency.</p></li>
</ul>
<ul class="simple">
<li><p>Next, we change the frequency to <span class="math notranslate nohighlight">\(10Hz\)</span> and we observe that the peaks in the frequency domain are now located at the <span class="math notranslate nohighlight">\(\pm 10 Hz\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">y_sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>
<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_sine</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9ce54a39ab688a93507b7fbbaf3be513619c430ce7cabba8f92a0ee76cd65787.png" src="../../_images/9ce54a39ab688a93507b7fbbaf3be513619c430ce7cabba8f92a0ee76cd65787.png" />
</div>
</div>
</section>
<section id="dirac-delta">
<h3>Dirac delta<a class="headerlink" href="#dirac-delta" title="Link to this heading">#</a></h3>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p>Time</p></th>
<th class="head text-center"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Constant</p></td>
<td class="text-center"><p>1</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(2 \pi \delta(\omega)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="text-center"><p>Dirac delta</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(\delta(t)\)</span></p></td>
<td class="text-center"><p>1</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p>Constant values in time correspond to a Dirac delta a frequency at 0 Hz.</p></li>
<li><p>For example, a constant equal to 1 in the time domain, creates to a spike at 0Hz in the frequency domain.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data set in Time Domain</span>
<span class="n">y_constant</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_constant</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c55ac884f7288ad3a940f527590d4502dbade97b7bb9d5a71ccb40ecc16cb856.png" src="../../_images/c55ac884f7288ad3a940f527590d4502dbade97b7bb9d5a71ccb40ecc16cb856.png" />
</div>
</div>
<ul class="simple">
<li><p>Similarly, a Dirac delta in time corresponds to a constant in the frequency domain.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_delta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">y_delta</span><span class="p">[</span><span class="mi">100</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_delta</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/e390e4a8c919a38c14c9426d211e99728f8221805ff357465b08fa59a21dc489.png" src="../../_images/e390e4a8c919a38c14c9426d211e99728f8221805ff357465b08fa59a21dc489.png" />
</div>
</div>
</section>
<section id="unit-step">
<h3>Unit step<a class="headerlink" href="#unit-step" title="Link to this heading">#</a></h3>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p>Time</p></th>
<th class="head text-center"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Unit step</p></td>
<td class="text-center"><p><span class="math notranslate nohighlight">\(u(t)\)</span></p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\(\frac{1}{i\omega} + \pi\delta(\omega)\)</span>$</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_step</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">y_step</span><span class="p">[</span><span class="mi">100</span><span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_step</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/eacfda18e29707ea306fde70c894ecf02fcb1232207c3f95c7e3de2d91930729.png" src="../../_images/eacfda18e29707ea306fde70c894ecf02fcb1232207c3f95c7e3de2d91930729.png" />
</div>
</div>
</section>
<section id="sinc">
<h3>Sinc<a class="headerlink" href="#sinc" title="Link to this heading">#</a></h3>
<table class="table">
<thead>
<tr class="row-odd"><th class="head text-center"><p></p></th>
<th class="head text-center"><p>Time</p></th>
<th class="head text-center"><p>Frequency</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-center"><p>Sinc</p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\(\frac{\sin(A t)}{\pi t}\)</span>$</p></td>
<td class="text-center"><p>$<span class="math notranslate nohighlight">\(\begin{cases} 1, &amp; |\omega| &lt; A \\ 0 &amp; \text{otherwise} \end{cases}\)</span>$</p></td>
</tr>
</tbody>
</table>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
<span class="n">freq</span><span class="o">=</span><span class="mi">5</span>
<span class="n">y_sinc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>
<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_sinc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/a7f4d0c92fa31bfc3e33c66894051dbc6ef815af6ea5c31ad5b425a1413780d9.png" src="../../_images/a7f4d0c92fa31bfc3e33c66894051dbc6ef815af6ea5c31ad5b425a1413780d9.png" />
</div>
</div>
</section>
<section id="signal-with-trend-and-noise">
<h3>Signal with Trend and Noise<a class="headerlink" href="#signal-with-trend-and-noise" title="Link to this heading">#</a></h3>
<p>Next we will analyze a signal that contains:</p>
<ul class="simple">
<li><p>A sine wave representing seasonality,</p></li>
<li><p>a parabolic function representing a trend,</p></li>
<li><p>and uniformly distributed random noise.</p></li>
</ul>
<p>Below we create and plot each of the components separately.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mf">1.5</span>

<span class="n">y_sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>
<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_sine</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/70e48443037cc4ca055c6c2dbc0c58bb92eb7e2625a4a37eb8658e3449f2fe12.png" src="../../_images/70e48443037cc4ca055c6c2dbc0c58bb92eb7e2625a4a37eb8658e3449f2fe12.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_trend</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_trend</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/0370834e3ab330453be5a943190d285f54900db6200ceb6a47bc7002ba9a76b7.png" src="../../_images/0370834e3ab330453be5a943190d285f54900db6200ceb6a47bc7002ba9a76b7.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_noise</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_noise</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/73a3a4a7451bbbee7de4a4ba2929ca6edf4329c32305e5ec5643f57c039b4c9a.png" src="../../_images/73a3a4a7451bbbee7de4a4ba2929ca6edf4329c32305e5ec5643f57c039b4c9a.png" />
</div>
</div>
<p>We can observe that in the Frequency Domain:</p>
<ol class="arabic simple">
<li><p>The sine wave has components at -1.5 and +1.5.</p></li>
<li><p>The trend has low frequency components (close to 0).</p></li>
<li><p>The noise has components across all frequencies.</p></li>
</ol>
</section>
</section>
<hr class="docutils" />
<section id="spectral-leakage">
<h2>Spectral leakage<a class="headerlink" href="#spectral-leakage" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>Let’s define a sampling frequency and time vector that defines the length of our signal.</p></li>
<li><p>The <em>Fundamental frequency resolution</em> is given by <span class="math notranslate nohighlight">\(\frac{\text{Sampling frequency}}{\text{Number of points in FFT}}\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fs</span> <span class="o">=</span> <span class="mi">1234</span>     <span class="c1"># Sampling frequency in Hz</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>  <span class="c1"># Time vector</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fundamental frequency resolution: </span><span class="si">{</span><span class="n">Fs</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Fundamental frequency resolution: 0.25
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>When you apply the FFT to a signal, you’re usually looking at it through a “window” of a specific length.</p></li>
<li><p>If the signal’s waveform doesn’t complete a whole number of cycles within this window, the edges of the window essentially “cut off” part of the waveform.</p></li>
<li><p>The FFT assumes the signal outside this window is zero, which is rarely true for real signals.</p></li>
<li><p>This “cutting” makes the waveform look different from its true form, leading to inaccuracies in the frequency domain representation.</p></li>
</ul>
<ul class="simple">
<li><p>In particular, if the signal’s frequency components do not align exactly with the FFT’s frequency bins, we observe a phenomenon called <em>spectral leakage</em>.</p></li>
<li><p>What happens is that the energy of the signal gets spread across multiple bins around the true frequency.</p></li>
<li><p>Let’s show it with an example.</p>
<ul>
<li><p>We sum two sinusoids: the first has a frequency multiple of the fundamental frequency resolution, the second hasn’t.</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq1</span> <span class="o">=</span> <span class="mf">5.75</span>   <span class="c1"># Frequencies of the 1st sinusoid in Hz</span>
<span class="n">freq2</span> <span class="o">=</span> <span class="mf">13.12</span>  <span class="c1"># Frequencies of the 2nd sinusoid in Hz</span>

<span class="n">y_sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_sine</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dea02253da5273a7fea03980d2f0df12f81f4eaa527e10611e5245d035407091.png" src="../../_images/dea02253da5273a7fea03980d2f0df12f81f4eaa527e10611e5245d035407091.png" />
</div>
</div>
<ul class="simple">
<li><p>For the second component, we see the spectal leakage.</p></li>
<li><p>This is a very common phenomenon when analyzing real-world signals.</p></li>
<li><p>We should keep this in mind when we try to isolate specific frequencies with filters (more on this later).</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="properties-of-the-fourier-transform">
<h2>Properties of the Fourier transform<a class="headerlink" href="#properties-of-the-fourier-transform" title="Link to this heading">#</a></h2>
<section id="linearity">
<h3>Linearity<a class="headerlink" href="#linearity" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The FT is linear, meaning that the transform of a sum of signals is the sum of their transforms.</p></li>
<li><p>Mathematically, for any two signals <span class="math notranslate nohighlight">\(f(t)\)</span> and <span class="math notranslate nohighlight">\(g(t)\)</span>, and any constants <span class="math notranslate nohighlight">\(a\)</span> and <span class="math notranslate nohighlight">\(b\)</span>, this property is expressed as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\mathcal{F}\{a f(t) + b g(t)\} = a \mathcal{F}\{f(t)\} + b \mathcal{F}\{g(t)\}\]</div>
<ul class="simple">
<li><p>This property allows for the analysis of complex signals by breaking them down into simpler components.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling frequency in Hz</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Length of signal in seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>  <span class="c1"># Time vector</span>
<span class="n">f1</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Frequency of sine wave in Hz</span>
<span class="n">f2</span> <span class="o">=</span> <span class="mi">80</span>  <span class="c1"># Frequency of cosine wave in Hz</span>
<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span>  <span class="c1"># Constants</span>
<span class="n">f_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="c1"># First function</span>
<span class="n">g_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="c1"># Second function</span>
<span class="n">combination</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">f_t</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">g_t</span> <span class="c1"># Linear combination of the functions</span>
<span class="n">F_f_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">f_t</span><span class="p">)</span> <span class="c1"># FT of the first function</span>
<span class="n">F_g_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">g_t</span><span class="p">)</span> <span class="c1"># FT of the second function</span>
<span class="n">linear_combination_F</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">F_f_t</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">F_g_t</span> <span class="c1"># Linear combination of the FTs</span>
<span class="n">F_combination</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">combination</span><span class="p">)</span> <span class="c1"># FT of the linear combination</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_linearity</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">g_t</span><span class="p">,</span> <span class="n">combination</span><span class="p">,</span> <span class="n">F_combination</span><span class="p">,</span> <span class="n">linear_combination_F</span><span class="p">):</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(t)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">g_t</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$g(t)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original Functions $f(t)$ and $g(t)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">combination</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Linear Combination&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Linear Combination in Time Domain&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">F_combination</span><span class="p">)),</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;FT of Linear Combination&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">freq</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">linear_combination_F</span><span class="p">)),</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Linear Combination of FTs&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_linearity</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">g_t</span><span class="p">,</span> <span class="n">combination</span><span class="p">,</span> <span class="n">F_combination</span><span class="p">,</span> <span class="n">linear_combination_F</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ce50e2662f85486fac73509067d9fda5d66ea9a84dba88eac33a4faf5044330f.png" src="../../_images/ce50e2662f85486fac73509067d9fda5d66ea9a84dba88eac33a4faf5044330f.png" />
</div>
</div>
</section>
<section id="time-shift">
<h3>Time Shift<a class="headerlink" href="#time-shift" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Shifting a signal in time results in a phase shift in its Fourier Transform.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(f(t - t_0)\)</span> is a time-shifted version of <span class="math notranslate nohighlight">\(f(t)\)</span>, its Fourier Transform is:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\mathcal{F}\{f(t - t_0)\} = e^{-i \omega t_0} \mathcal{F}\{f(t)\}\]</div>
<ul class="simple">
<li><p>This property shows that time delays correspond to phase shifts in the frequency domain, without affecting the amplitude of the frequency components.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling frequency in Hz</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Length of signal in seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>  <span class="c1"># Time vector</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Frequency of sine wave in Hz</span>
<span class="n">t0</span> <span class="o">=</span> <span class="mf">0.01</span>  <span class="c1"># Time shift in seconds</span>

<span class="c1"># Define the function and its time-shifted version</span>
<span class="n">f_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="n">f_t_shifted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="p">(</span><span class="n">t</span> <span class="o">-</span> <span class="n">t0</span><span class="p">))</span>

<span class="c1"># Compute Fourier Transforms</span>
<span class="n">F_f_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">f_t</span><span class="p">)</span>
<span class="n">F_f_t_shifted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">f_t_shifted</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_time_shift</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">f_t_shifted</span><span class="p">,</span> <span class="n">F_f_t</span><span class="p">,</span> <span class="n">F_f_t_shifted</span><span class="p">):</span>

    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="c1"># Functions in time domain</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(t)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t_shifted</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(t - t_0)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Magnitude of Fourier Transform</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">F_f_t</span><span class="p">),</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">F_f_t_shifted</span><span class="p">),</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Shifted&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Magnitude of $F(\omega)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Phase of Fourier Transform before and after shift</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">F_f_t</span><span class="o">+</span><span class="mf">1e-10</span><span class="p">),</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">F_f_t_shifted</span><span class="o">+</span><span class="mf">1e-10</span><span class="p">),</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Shifted&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Phase of $F(\omega)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (radians)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_time_shift</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">f_t_shifted</span><span class="p">,</span> <span class="n">F_f_t</span><span class="p">,</span> <span class="n">F_f_t_shifted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5d29d43331bdba4f48f328375b1df105064f2fc46d1902193e8d9b32bdb65916.png" src="../../_images/5d29d43331bdba4f48f328375b1df105064f2fc46d1902193e8d9b32bdb65916.png" />
</div>
</div>
</section>
<section id="frequency-shift">
<h3>Frequency Shift<a class="headerlink" href="#frequency-shift" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Modulating a signal by a sinusoid results in a shift in the frequency domain.</p></li>
<li><p>If <span class="math notranslate nohighlight">\(g(t) = e^{i 2 \pi f_0 t} f(t)\)</span>, then the Fourier Transform of <span class="math notranslate nohighlight">\(g(t)\)</span> is:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \mathcal{F}\{g(t)\} = \mathcal{F}(\omega - 2\pi f_0)\]</div>
<ul class="simple">
<li><p>This property is used in modulation schemes in communications.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling frequency in Hz</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Length of signal in seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>  <span class="c1"># Time vector</span>
<span class="n">f_signal</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Frequency of the original signal in  Hz</span>
<span class="n">f_shift</span> <span class="o">=</span> <span class="mi">30</span>  <span class="c1"># Frequency shift in Hz</span>

<span class="n">f_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_signal</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="c1"># Original signal</span>
<span class="n">f_shifted_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f_shift</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">*</span> <span class="n">f_t</span> <span class="c1"># Frequency-shifted signal</span>

<span class="c1"># Compute Fourier Transforms</span>
<span class="n">F_f_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">f_t</span><span class="p">)</span>
<span class="n">F_shifted_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">f_shifted_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_freq_shift</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">f_shifted_t</span><span class="p">,</span> <span class="n">F_f_t</span><span class="p">,</span> <span class="n">F_shifted_t</span><span class="p">):</span>

    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

    <span class="c1"># Functions in time domain</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(t)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_shifted_t</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$e^{i 2 \pi f_0 t} f(t)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time Domain&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Magnitude of the original signal&#39;s Fourier Transform</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">F_f_t</span><span class="p">),</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{F}</span><span class="s1">(\omega)$&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">F_shifted_t</span><span class="p">),</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{F}</span><span class="s1">(\omega - 2\pi f_0)$&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency Domain&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_freq_shift</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">f_shifted_t</span><span class="p">,</span> <span class="n">F_f_t</span><span class="p">,</span> <span class="n">F_shifted_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b503d328bb45c7e0c92215b6c4e49f585cd0eb7b932ef072e8433e55c2c577c8.png" src="../../_images/b503d328bb45c7e0c92215b6c4e49f585cd0eb7b932ef072e8433e55c2c577c8.png" />
</div>
</div>
</section>
<section id="scaling">
<h3>Scaling<a class="headerlink" href="#scaling" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Let <span class="math notranslate nohighlight">\(f(at)\)</span> be a scaled version of <span class="math notranslate nohighlight">\(f(t)\)</span>, where <span class="math notranslate nohighlight">\(a\)</span> is a real non-zero scaling factor.</p></li>
<li><p>Its Fourier Transform is scaled in the frequency domain by <span class="math notranslate nohighlight">\(1/|a|\)</span> and is given by:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\mathcal{F}\{f(at)\} = \frac{1}{|a|}F\left(\frac{\omega}{a}\right)\]</div>
<ul class="simple">
<li><p>This property indicates that compressing a signal in time domain expands its spectrum in the frequency domain, and vice versa.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling frequency in Hz</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Length of signal in seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>  <span class="c1"># Time vector</span>
<span class="n">f0</span> <span class="o">=</span> <span class="mi">50</span>  <span class="c1"># Frequency of the original signal in Hz</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1"># scaling factor</span>

<span class="n">f_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f0</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="c1"># Original signal</span>
<span class="n">f_scaled</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="p">(</span><span class="n">f0</span><span class="o">/</span><span class="n">a</span><span class="p">)</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="c1"># Scaled signal</span>

<span class="c1"># Compute Fourier Transforms</span>
<span class="n">F_f_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">f_t</span><span class="p">)</span>
<span class="n">F_scaled_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">f_scaled</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_scaling</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">f_scaled</span><span class="p">,</span> <span class="n">F_f_t</span><span class="p">,</span> <span class="n">F_scaled_t</span><span class="p">):</span>

    <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="n">t</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">t</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

    <span class="c1"># Functions in time domain</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(t)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_scaled</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$f(at)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Time Domain&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Time (s)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Amplitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Magnitude of the original signal&#39;s Fourier Transform</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">F_f_t</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathcal</span><span class="si">{F}</span><span class="s1">(\omega)$&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">stem</span><span class="p">(</span><span class="n">frequencies</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">F_scaled_t</span><span class="p">),</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$1/|a|F(\omega/a)$&#39;</span><span class="p">,</span> <span class="n">markerfmt</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Frequency Domain&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (Hz)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_scaling</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">f_scaled</span><span class="p">,</span> <span class="n">F_f_t</span><span class="p">,</span> <span class="n">F_scaled_t</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/24ebe287c234108d0c821afae71232e5df298da5ef8ed39f6bbf3d767da738a9.png" src="../../_images/24ebe287c234108d0c821afae71232e5df298da5ef8ed39f6bbf3d767da738a9.png" />
</div>
</div>
</section>
<section id="convolution">
<h3>Convolution<a class="headerlink" href="#convolution" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The Fourier Transform converts convolution in time domain into multiplication in frequency domain.</p></li>
<li><p>The convolution is defined as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[f(t) * g(t) = \int \limits_{-\infty}^{\infty} f(\tau)g(t -\tau) d\tau\]</div>
<img alt="https://upload.wikimedia.org/wikipedia/commons/archive/6/6e/20100707184430%21Convolution_of_box_signal_with_itself.gif" src="https://upload.wikimedia.org/wikipedia/commons/archive/6/6e/20100707184430%21Convolution_of_box_signal_with_itself.gif" />
<img alt="https://upload.wikimedia.org/wikipedia/commons/archive/6/67/20100707184106%21Convolution_of_spiky_function_with_box.gif" src="https://upload.wikimedia.org/wikipedia/commons/archive/6/67/20100707184106%21Convolution_of_spiky_function_with_box.gif" />
<div style="text-align: center; font-size: 80%;">Image: <a href="https://en.wikipedia.org/wiki/Convolution">Wikipedia</a></div><ul class="simple">
<li><p>If two functions <span class="math notranslate nohighlight">\(f(t)\)</span> and <span class="math notranslate nohighlight">\(g(t)\)</span> are convolved, their Fourier Transforms are multiplied:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\mathcal{F}\{f(t) * g(t)\} = \mathcal{F}\{f(t)\} \cdot \mathcal{F}\{g(t)\}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling frequency in Hz</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Length of signal in seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="n">T</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>  <span class="c1"># Time vector</span>
<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="c1"># first signal</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">t</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="c1"># second signal</span>

<span class="c1"># convolution in the time domain</span>
<span class="n">convolution_time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">convolve</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;full&#39;</span><span class="p">)</span> 

<span class="c1"># Pad the signals with N-1 zeros to avoid circular convolution</span>
<span class="n">y1_pad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;constant&#39;</span><span class="p">)</span>
<span class="n">y2_pad</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pad</span><span class="p">(</span><span class="n">y2</span><span class="p">,</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;constant&#39;</span><span class="p">)</span>

<span class="c1"># Compute the Fourier Transforms</span>
<span class="n">Y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y1_pad</span><span class="p">)</span>
<span class="n">Y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y2_pad</span><span class="p">)</span>

<span class="c1"># Multiplication in frequency domain and inverse transform</span>
<span class="n">convolution_freq_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Y1</span> <span class="o">*</span> <span class="n">Y2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_convolution</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">convolution_time</span><span class="p">,</span> <span class="n">convolution_freq_domain</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

    <span class="c1"># Original signals</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Signal 1&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Signal 2&#39;</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># Convolution in the time domain</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">convolution_time</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Convolution in Time Domain&#39;</span><span class="p">)</span>

    <span class="c1"># Result of multiplication in the frequency domain (i.e., convolution result)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">convolution_freq_domain</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Result from Frequency Domain Multiplication&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_convolution</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">convolution_time</span><span class="p">,</span> <span class="n">convolution_freq_domain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d971670bdc73ac941d7f490ee1eb25590ff3dfe19c648b923656d1e8dc4b6b88.png" src="../../_images/d971670bdc73ac941d7f490ee1eb25590ff3dfe19c648b923656d1e8dc4b6b88.png" />
</div>
</div>
</section>
<section id="differentiation">
<h3>Differentiation<a class="headerlink" href="#differentiation" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The FT of the derivative of a function is proportional to the frequency times the FT of the function itself:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \mathcal{F}\{f'(t)\} = i\omega \mathcal{F}\{f(t)\}\]</div>
<ul class="simple">
<li><p>Conversely, the inverse FT of <span class="math notranslate nohighlight">\(\frac{d^n F(\omega)}{d\omega^n}\)</span> is given by the multiplication of <span class="math notranslate nohighlight">\(f(t)\)</span> by <span class="math notranslate nohighlight">\((it)^n\)</span>, where <span class="math notranslate nohighlight">\(n\)</span> is the order of differentiation:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\mathcal{F}^{-1}\left\{\frac{d^n F(\omega)}{d\omega^n}\right\} = (it)^n f(t)\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling frequency in Hz</span>
<span class="n">T</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># Length of signal in seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>  <span class="c1"># Time vector</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="c1"># Signal</span>

<span class="n">dy_dt_numerical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">gradient</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="c1"># Numerical derivative</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="c1"># Fourier Transform of the signal</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span> <span class="c1"># Angular frequency vector</span>
<span class="n">dY_dt_frequency_domain</span> <span class="o">=</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">*</span> <span class="n">Y</span> <span class="c1"># Differentiate in the frequency domain</span>
<span class="n">dy_dt_from_frequency_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">dY_dt_frequency_domain</span><span class="p">)</span> <span class="c1"># Inverse FT to get the derivative in the time domain</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_derivative</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dy_dt_numerical</span><span class="p">,</span> <span class="n">dy_dt_from_frequency_domain</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dy_dt_numerical</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Numerical Derivative in Time Domain&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dy_dt_from_frequency_domain</span><span class="o">.</span><span class="n">real</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Derivative from Frequency Domain via Inverse FFT&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_derivative</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">dy_dt_numerical</span><span class="p">,</span> <span class="n">dy_dt_from_frequency_domain</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/d351e7b255ac67d456855ef0cfb2f417b1c9949d8e439cf4ea93e9afe509b680.png" src="../../_images/d351e7b255ac67d456855ef0cfb2f417b1c9949d8e439cf4ea93e9afe509b680.png" />
</div>
</div>
</section>
<section id="integration">
<h3>Integration<a class="headerlink" href="#integration" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The integration of a signal in the time domain corresponds to a specific transformation in the frequency domain.</p></li>
<li><p>Specifically, the Fourier Transform of the integral of <span class="math notranslate nohighlight">\(f(t)\)</span> is given by:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\mathcal{F}\left\{\int_{-\infty}^t f(\tau)d\tau\right\} = \frac{F(\omega)}{i\omega} + \pi F(0)\delta(\omega)\]</div>
<ul class="simple">
<li><p>where <span class="math notranslate nohighlight">\(\delta(\omega)\)</span> is the Dirac delta function.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sampling_rate</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="n">sampling_rate</span>
<span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span>
<span class="n">f_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="c1"># Original signal</span>

<span class="c1"># Integrate f(t) in the time domain</span>
<span class="n">integrated_f_t</span> <span class="o">=</span> <span class="n">cumulative_trapezoid</span><span class="p">(</span><span class="n">f_t</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">initial</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Compute the Fourier Transform of the integrated signal</span>
<span class="n">Integrated_F_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">integrated_f_t</span><span class="p">)</span>

<span class="c1"># Theoretical relationship </span>
<span class="c1"># Compute the Fourier Transform of the original signal</span>
<span class="n">F_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">f_t</span><span class="p">)</span>
<span class="n">omega</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="c1"># Note: To avoid division by zero at omega=0, we use np.where to handle the omega=0 case separately.</span>
<span class="c1"># The delta function&#39;s contribution at omega=0 is theoretical and not directly applicable in discrete FFT.</span>
<span class="n">Theoretical_F_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">omega</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">F_w</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">omega</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Should be equal to Integrated_F_w</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_integration</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">integrated_f_t</span><span class="p">,</span> <span class="n">F_w</span><span class="p">,</span> <span class="n">Integrated_F_w</span><span class="p">,</span> <span class="n">Theoretical_F_w</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Original Signal $f(t)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Original Signal $f(t)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">integrated_f_t</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Integrated Signal $\int f(t) dt$&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">F_w</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fourier Transform of $f(t)$&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Integrated_F_w</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;FT of Integrated $f(t)$&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">omega</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">Theoretical_F_w</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Theoretical $F(\omega)/(i\omega)$&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Fourier Transform of the Integrated Signal&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_integration</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">f_t</span><span class="p">,</span> <span class="n">integrated_f_t</span><span class="p">,</span> <span class="n">F_w</span><span class="p">,</span> <span class="n">Integrated_F_w</span><span class="p">,</span> <span class="n">Theoretical_F_w</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/b00c128ebce58725322b0e3ebe9f3e68252bd0f57d94184f49b48aee58365769.png" src="../../_images/b00c128ebce58725322b0e3ebe9f3e68252bd0f57d94184f49b48aee58365769.png" />
</div>
</div>
</section>
<section id="parseval-s-theorem">
<h3>Parseval’s Theorem<a class="headerlink" href="#parseval-s-theorem" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>This theorem relates the total energy of a signal in the time domain to the total energy in the frequency domain, indicating that energy is preserved in the Fourier Transform.</p></li>
<li><p>Mathematically:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[ \int_{-\infty}^{\infty} |f(t)|^2 dt = \int_{-\infty}^{\infty} |F(\omega)|^2 d\omega \]</div>
<ul class="simple">
<li><p>For discrete signals and their Discrete Fourier Transforms (DFTs), this can be approximated as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\sum_{n=0}^{N-1} |x[n]|^2 = \frac{1}{N} \sum_{k=0}^{N-1} |X[k]|^2\]</div>
<ul class="simple">
<li><p>where <span class="math notranslate nohighlight">\(x[n]\)</span> is the discrete time-domain signal, <span class="math notranslate nohighlight">\(X[k]\)</span> is its DFT, and <span class="math notranslate nohighlight">\(N\)</span> is the number of points in the signal and its DFT.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling frequency in Hz</span>
<span class="n">T</span> <span class="o">=</span> <span class="mf">0.5</span>  <span class="c1"># Length of signal in seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>  <span class="c1"># Time vector</span>

<span class="n">f_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># Signal</span>
<span class="n">F_w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">f_t</span><span class="p">)</span> <span class="c1"># Fourier Transform</span>

<span class="c1"># Compute the energy in the time domain</span>
<span class="n">energy_time_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">f_t</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Compute the energy in the frequency domain</span>
<span class="n">energy_freq_domain</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">F_w</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">t</span><span class="o">.</span><span class="n">size</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Energy in the time domain: </span><span class="si">{</span><span class="n">energy_time_domain</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Energy in the frequency domain: </span><span class="si">{</span><span class="n">energy_freq_domain</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Energy in the time domain: 312.5
Energy in the frequency domain: 312.5
</pre></div>
</div>
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="filters">
<h2>Filters<a class="headerlink" href="#filters" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>In the context of signal processing and time series analysis, a filter is a tool used to modify or enhance a signal by selectively amplifying certain frequencies and attenuating others.</p></li>
<li><p>A filter processes a signal to remove unwanted components or features, such as noise, or to extract useful information from the signal.</p></li>
<li><p>Filters are characterized by their <strong>frequency response</strong> and <strong>transfer function</strong>.</p></li>
</ul>
<section id="frequency-response">
<h3>Frequency Response<a class="headerlink" href="#frequency-response" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The frequency response of a filter characterizes the filter’s output in the frequency domain.</p></li>
<li><p>It describes how the amplitude and phase of the output signal vary across different frequencies of the input signal.</p></li>
<li><p>In other words, it shows how much each frequency component of the input signal is attenuated or amplified by the filter and how the phase of these components is shifted.</p></li>
<li><p>The frequency response is typically represented as a plot of the filter’s gain (or attenuation) and phase shift as functions of frequency.</p></li>
<li><p>This response is crucial for understanding how the filter will affect a signal’s spectral content.</p></li>
</ul>
<p>There are different categories of filters based on the frequency response.</p>
<ul class="simple">
<li><p>Low-pass filters – allow frequencies below a certain cutoff to pass through while attenuating higher frequencies.</p></li>
<li><p>High-pass filters – do the opposite of LPF.</p></li>
<li><p>Band-pass filters – allow frequencies within a certain range to pass through.</p></li>
<li><p>Band-stop filters – attenuate frequencies within a certain range.</p></li>
</ul>
</section>
<section id="transfer-function">
<h3>Transfer Function<a class="headerlink" href="#transfer-function" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The transfer function describes how the filter modifies the amplitude and phase of components of the input signal at different frequencies.</p></li>
<li><p>For analog filters (continuous time) is defined as the ratio of the output signal and the input signal of the filter in the Laplace domain:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[H(s) = \frac{Y(s)}{X(s)}\]</div>
<ul class="simple">
<li><p>For digital filters (discrete time) the ratio is defined in the Z-domain:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[H(z) = \frac{Y(z)}{X(z)}\]</div>
<p><strong>Laplace Transform</strong></p>
<ul class="simple">
<li><p>The Laplace transform of a function <span class="math notranslate nohighlight">\(f(t)\)</span>, defined for <span class="math notranslate nohighlight">\(t \geq 0\)</span>, is given by</p></li>
</ul>
<div class="math notranslate nohighlight">
\[F(s) = \int_{0}^{\infty} e^{-st}f(t) \,dt\]</div>
<ul class="simple">
<li><p>where <span class="math notranslate nohighlight">\(s = \sigma + i\omega\)</span> is a complex number.</p></li>
<li><p>The Fourier transform <span class="math notranslate nohighlight">\(F(\omega) = \int_{-\infty}^{\infty} e^{-i\omega t}f(t) \,dt\)</span> is a special case of the Laplace transform evaluated on the imaginary axis (<span class="math notranslate nohighlight">\(s = j\omega\)</span>), where <span class="math notranslate nohighlight">\(\sigma = 0\)</span>.</p></li>
<li><p>The convergence of the Fourier transform is a stricter requirement, meaning that not all functions that have a Laplace transform will have a Fourier transform.</p></li>
<li><p>While the Fourier transform is useful to analyze only the frequency content, Laplace transform is useful to analyze the overall system behavior, including stability and transient response.</p></li>
</ul>
<p><strong>Z-transform</strong></p>
<ul class="simple">
<li><p>The relationship between the z-transform and the Discrete Fourier Transform (DFT) is similar to the relationship between the Laplace and Fourier transforms in the continuous domain,</p></li>
<li><p>The z-transform of a discrete-time signal <span class="math notranslate nohighlight">\(x[n]\)</span> is defined as</p></li>
</ul>
<div class="math notranslate nohighlight">
\[X(z) = \sum_{n=-\infty}^{\infty} x[n]z^{-n}\]</div>
<ul class="simple">
<li><p>where <span class="math notranslate nohighlight">\(z\)</span> is a complex variable (<span class="math notranslate nohighlight">\(z = re^{i\theta}\)</span>).</p></li>
<li><p>The Discrete Fourier Transform (DFT) <span class="math notranslate nohighlight">\(X[k] = \sum_{n=0}^{N-1} x[n]e^{-i\frac{2\pi}{N}kn}\)</span> is a special case of z-transform evaluated on the unit circle in the complex plane, i.e., when <span class="math notranslate nohighlight">\(z = e^{i\omega}\)</span>.</p></li>
<li><p>The z-transform encompasses a broader range of analysis, allowing for the examination of signals and systems inside and outside the unit circle, which is useful for stability analysis and filter design in the z-domain.</p></li>
</ul>
<p><strong>Frequency response vs Transfer function</strong></p>
<p>To summarize:</p>
<ul class="simple">
<li><p>The transfer function gives a more general mathematical model of the filter that applies to all inputs, not just sinusoidal inputs.</p></li>
<li><p>The frequency response specifically describes how the filter responds to sinusoidal inputs across a range of frequencies.</p></li>
<li><p>Transfer functions are described in the Laplace or Z-domain, providing a broader analysis toolset for system properties.</p></li>
<li><p>In contrast, the frequency response is a subset of the transfer function evaluated on the imaginary axis in the Laplace domain or on the unit circle in the Z-domain.</p></li>
</ul>
</section>
<section id="bode-plot">
<h3>Bode Plot<a class="headerlink" href="#bode-plot" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>It is a plot that displays the transfer function of a system (a filter in our case).</p></li>
<li><p>It displays the amplitude (usually in decibels, i.e., logarithmic units) of a system as a function of the frequency.</p></li>
<li><p>It also displays the phase of a system as a function of the frequency.</p></li>
</ul>
<ul class="simple">
<li><p>Let’s create a Bode plot for a simple low-pass filter as an example.</p></li>
<li><p>The transfer function for a first-order low-pass filter can be expressed as:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[H(s) = \frac{\omega_c}{s + \omega_c}\]</div>
<ul class="simple">
<li><p>where <span class="math notranslate nohighlight">\(\omega_c\)</span> is the cutoff frequency of the filter.</p></li>
<li><p>The cutoff frequency is the frequency at which the output signal’s power is reduced to half its input power.</p></li>
<li><p>In this example, let’s assume a cutoff frequency <span class="math notranslate nohighlight">\(\omega_c = 1000\)</span> rad/s.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Transfer function coefficients for H(s) = omega_c / (s + omega_c)</span>
<span class="n">omega_c</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Cutoff frequency in rad/s</span>
<span class="n">num</span> <span class="o">=</span> <span class="p">[</span><span class="n">omega_c</span><span class="p">]</span>  <span class="c1"># Numerator coefficients</span>
<span class="n">den</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">]</span>  <span class="c1"># Denominator coefficients</span>

<span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">den</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span> <span class="c1"># Compute frequency response</span>
<span class="n">mag</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>  <span class="c1"># Convert magnitude to dB</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Phase in degrees</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">make_bode_plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">mag</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">omega_c</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">omega_signal</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">mag</span><span class="p">)</span>  <span class="c1"># Bode magnitude plot</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Magnitude (dB)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (rad/s)&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">omega_c</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">omega_c</span><span class="p">)</span> <span class="ow">is</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">omega_c</span><span class="p">:</span>
                <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1"># Cutoff frequency</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">omega_c</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span> <span class="c1"># Cutoff frequency</span>
            
    <span class="k">if</span> <span class="n">omega_signal</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax1</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">omega_signal</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>

    <span class="n">ax2</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">phase</span><span class="p">)</span>  <span class="c1"># Bode phase plot</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Phase (degrees)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Frequency (rad/s)&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">which</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">make_bode_plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">mag</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f8f951d61f8ec3f89c94ee86bc3df308ef8e562103abfbccef6fcec723593ae0.png" src="../../_images/f8f951d61f8ec3f89c94ee86bc3df308ef8e562103abfbccef6fcec723593ae0.png" />
</div>
</div>
<p><strong>Magnitude Plot (Left)</strong></p>
<ul class="simple">
<li><p>Shows how the filter attenuates signals at different frequencies.</p></li>
<li><p>Frequencies lower than the cutoff frequency (<span class="math notranslate nohighlight">\(\omega_c = 1000\)</span> rad/s) are passed with little attenuation.</p></li>
<li><p>Frequencies higher than the cutoff frequency are increasingly attenuated.</p></li>
</ul>
<p><strong>Phase Plot (Right)</strong></p>
<ul class="simple">
<li><p>Illustrates the phase shift introduced by the filter across different frequencies.</p></li>
<li><p>For a first-order low-pass filter, the phase shift goes from 0 degrees at low frequencies to -90 degrees at high frequencies.</p></li>
<li><p>The transition occurs smoothly across the frequency range, with a noticeable change around the cutoff frequency.</p></li>
</ul>
</section>
<section id="low-pass-filters-lpfs">
<h3>Low Pass Filters (LPFs)<a class="headerlink" href="#low-pass-filters-lpfs" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>As we mentioned earlier, a LPF passes signals with a frequency lower than a certain cutoff frequency.</p></li>
<li><p>LPFs provide a smoother form of a signal, removing short term fluctuations.</p></li>
<li><p>One common application is to get rid of aht high-frequency components of the noise.</p></li>
<li><p>Moving averages are a type of low pass filters.</p></li>
<li><p>Representative LPFs include the Hann Window, the Tukey Filter, and the Butterworth Filter.</p></li>
</ul>
<section id="hann-window">
<h4>Hann Window<a class="headerlink" href="#hann-window" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>The Hann window, is named after Julius von Hann, and is sometimes referred to as “Hanning” or as “raised cosine”.</p></li>
<li><p>The shape of the filter in time domain is one lobe of an elevated cosine function.</p></li>
<li><p>On the interval <span class="math notranslate nohighlight">\(n\in [0,N-1]\)</span> the Hann window function is:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[w(n)=0.5\;\left[1-\cos \left({\frac {2\pi n}{N-1}}\right)\right]=\sin ^{2}\left({\frac {\pi n}{N-1}}\right)\]</div>
<ul class="simple">
<li><p>Let’s generate a Hann window of size <span class="math notranslate nohighlight">\(51\)</span>.</p></li>
<li><p>Then, we plot the window and compute its frequency response with the function we have defined before.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">window</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">hann</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span>

<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">window</span><span class="p">)),</span> <span class="n">window</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/98f7c8e229cb31ddce019cb6cec8bc4e60808d757106729b7f081602edd3e41b.png" src="../../_images/98f7c8e229cb31ddce019cb6cec8bc4e60808d757106729b7f081602edd3e41b.png" />
</div>
</div>
<ul class="simple">
<li><p>Unfortuantely we do not see much in the frequency domain since the response is compressed in a very short interval.</p></li>
<li><p>To visualize these kind of signals we must apply some transformations that allows us to “zoom in” and see the details.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_hann</span><span class="p">():</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">hann</span><span class="p">(</span><span class="mi">51</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Hann window&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitude&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sample&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="mi">2048</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
    <span class="n">response</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">A</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
    <span class="n">response</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Frequency response of the Hann window&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized magnitude [dB]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Normalized frequency [cycles per sample]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<ul class="simple">
<li><p>This is a typical visualization of the window that we generated before.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hann</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/27a4cbc1a35398d0e074ff4439d3366dd78fb12ca23cff6273c28a1ac47bef5b.png" src="../../_images/27a4cbc1a35398d0e074ff4439d3366dd78fb12ca23cff6273c28a1ac47bef5b.png" />
</div>
</div>
</section>
<section id="tukey-filter">
<h4>Tukey Filter<a class="headerlink" href="#tukey-filter" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>The Tukey window, also known as the “tapered cosine window”, can be regarded as a cosine lobe of width <span class="math notranslate nohighlight">\(\alpha N/2\)</span> that is convolved with a rectangular window of width <span class="math notranslate nohighlight">\((1 − α/2)N\)</span>.</p></li>
<li><p>The expression of the filter in time domain is given by:</p></li>
</ul>
<div class="math notranslate nohighlight">
\[\begin{split} w(n)={\begin{cases}{\frac{1}{2}}\left[1+\cos \left(\pi \left({\frac {2n}{\alpha (N-1)}}-1\right)\right)\right]&amp;0\leqslant n&lt;{\frac {\alpha (N-1)}{2}}\\1&amp;{\frac {\alpha (N-1)}{2}}\leqslant n\leqslant (N-1)(1-{\frac {\alpha }{2}})\\{\frac {1}{2}}\left[1+\cos \left(\pi \left({\frac {2n}{\alpha (N-1)}}-{\frac {2}{\alpha }}+1\right)\right)\right]&amp;(N-1)(1-{\frac {\alpha }{2}})&lt;n\leqslant (N-1)\end{cases}}\end{split}\]</div>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_tukey</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>
    <span class="n">window</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">tukey</span><span class="p">(</span><span class="mi">51</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Tukey window&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Amplitude&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Sample&quot;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="mi">2048</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">window</span><span class="p">)</span><span class="o">/</span><span class="mf">2.0</span><span class="p">)</span>
    <span class="n">freq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">))</span>
    <span class="n">response</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftshift</span><span class="p">(</span><span class="n">A</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">A</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:orange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Frequency response of the Tukey window&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Normalized magnitude [dB]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Normalized frequency [cycles per sample]&quot;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_tukey</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/40f77775f3e305675c9db2dca608c39e569e542ebd1631659da10144ffbc93ae.png" src="../../_images/40f77775f3e305675c9db2dca608c39e569e542ebd1631659da10144ffbc93ae.png" />
</div>
</div>
<ul class="simple">
<li><p>When <span class="math notranslate nohighlight">\(\alpha \rightarrow 0\)</span> the Tukey Filter becomes a rectangular window.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_tukey</span><span class="p">(</span><span class="mf">1e-10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/42f1f765f9c67f9e8d93cc7f49c4d4ba4d684cf45c544663adef53872840cacc.png" src="../../_images/42f1f765f9c67f9e8d93cc7f49c4d4ba4d684cf45c544663adef53872840cacc.png" />
</div>
</div>
<ul class="simple">
<li><p>At <span class="math notranslate nohighlight">\(\alpha = 1\)</span> the Tukey Filter becomes a Hann window.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_tukey</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/4978f2d08a3f670286c9af389a51cbeadfe684384a3023e23508b71a534bb0fe.png" src="../../_images/4978f2d08a3f670286c9af389a51cbeadfe684384a3023e23508b71a534bb0fe.png" />
</div>
</div>
<ul class="simple">
<li><p>In both Hann and Tukey windows, in the frequency domain the shape of the filter becomes close to zero at high frequencies.</p></li>
</ul>
<ul class="simple">
<li><p>Next, we apply the filter to a noisy signal.</p></li>
<li><p>We do that by mutiplying the signal and the filter in the frequency domain.</p></li>
<li><p>The output should show a reduction in the high frequency components.</p></li>
<li><p>With the inverse FFT we map the output back in the time domain.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s create a function to show the results.</span>
<span class="k">def</span> <span class="nf">filter_plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_noisy</span><span class="p">,</span> <span class="n">y_clean</span><span class="p">,</span> <span class="n">y_filtered</span><span class="p">,</span> <span class="n">legend_names</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">[</span><span class="mi">9</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_noisy</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">y_clean</span><span class="p">,</span> <span class="s1">&#39;tab:blue&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">y_filtered</span><span class="p">),</span> <span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">legend_names</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="n">freq</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">y_sine</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>
<span class="n">y_trend</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.2</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">y_noise</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
<span class="n">noisy_signal</span> <span class="o">=</span> <span class="n">y_sine</span> <span class="o">+</span> <span class="n">y_trend</span> <span class="o">+</span> <span class="n">y_noise</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter&#39;s parameters</span>
<span class="n">alpha</span><span class="o">=</span><span class="mf">0.1</span>
<span class="n">div_factor</span> <span class="o">=</span> <span class="mi">16</span> <span class="c1"># use powers of 2</span>
<span class="n">win_len</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">)</span> <span class="o">/</span> <span class="n">div_factor</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Window length: </span><span class="si">{</span><span class="n">win_len</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Compute window</span>
<span class="n">window</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">windows</span><span class="o">.</span><span class="n">tukey</span><span class="p">(</span><span class="n">win_len</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

<span class="c1"># Compute frequency response</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">window</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">response</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">response</span><span class="p">)</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>

<span class="c1"># Apply filter</span>
<span class="n">Y</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">noisy_signal</span><span class="p">))</span>
<span class="n">y_tukey</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">ifft</span><span class="p">(</span><span class="n">Y</span><span class="o">*</span><span class="n">response</span><span class="p">)</span>

<span class="n">filter_plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">noisy_signal</span><span class="p">,</span> <span class="n">y_sine</span><span class="o">+</span><span class="n">y_trend</span><span class="p">,</span> <span class="n">y_tukey</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;Signal+Trend+Noise&#39;</span><span class="p">,</span><span class="s1">&#39;Signal+Trend&#39;</span><span class="p">,</span><span class="s1">&#39;Fitered Tukey Signal&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Window length: 32
</pre></div>
</div>
<img alt="../../_images/fbbf170a6fda690843518eb30654ba0d1ae9df4159b4dcd2ad95e58f2ab2e626.png" src="../../_images/fbbf170a6fda690843518eb30654ba0d1ae9df4159b4dcd2ad95e58f2ab2e626.png" />
</div>
</div>
<ul class="simple">
<li><p>We can observe that the “Filtered Signal” matches very closely the “Signal + Trend”, and most of the noise has been removed.</p></li>
</ul>
</section>
<section id="butterworth-filter">
<h4>Butterworth Filter<a class="headerlink" href="#butterworth-filter" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>The Butterworth filter is designed to have a frequency response as flat as possible in the passband.</p></li>
<li><p>It avoids ripples both in the passband and in the stopband, providing a smooth transition between these regions.</p></li>
</ul>
<img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/6/60/Butterworth_response.svg/640px-Butterworth_response.svg.png" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/60/Butterworth_response.svg/640px-Butterworth_response.svg.png" />
<div style="text-align: center; font-size: 80%;">Image: <a href="https://commons.wikimedia.org/wiki/File:Butterworth_response.svg">Wikimedia</a></div><ul class="simple">
<li><p>Contrarily to the two window-based filters that we have just seen, the Butterworth filter is defined directly in the frequency domain.</p></li>
<li><p>As such, it does not have a proper “shape” that we can visualize in the time domain.</p></li>
<li><p>Therefore, we will use the Bode plot, which is the tool for visualizing a frequency response.</p></li>
</ul>
<p>The magnitude response of an <span class="math notranslate nohighlight">\(N\)</span>-th order Butterworth low-pass filter can be described by the following equation:</p>
<div class="math notranslate nohighlight">
\[|H(\omega)| = \frac{1}{\sqrt{1 + \left(\frac{\omega}{\omega_c}\right)^{2N}}}\]</div>
<ul class="simple">
<li><p>where:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(|H(\omega)|\)</span> is the magnitude of the frequency response of the filter.</p></li>
<li><p><span class="math notranslate nohighlight">\(\omega\)</span> is the frequency of the input signal.</p></li>
<li><p><span class="math notranslate nohighlight">\(\omega_c\)</span> is the cutoff frequency (i.e., where the magnitude response is <span class="math notranslate nohighlight">\(\frac{1}{\sqrt{2}}\)</span> (or -3 dB) of the passband value).</p></li>
<li><p><span class="math notranslate nohighlight">\(N\)</span> is the order of the filter, which determines the steepness of the filter’s roll-off beyond the cutoff frequency. The higher the order, the steeper the roll-off.</p></li>
</ul>
</li>
</ul>
<p>In summary:</p>
<ul class="simple">
<li><p>Frequencies much lower than <span class="math notranslate nohighlight">\(\omega_c\)</span> pass through with little attenuation.</p></li>
<li><p>Frequencies much higher than <span class="math notranslate nohighlight">\(\omega_c\)</span> are significantly attenuated.</p></li>
<li><p>The transition between the passband and the stopband is smooth.</p></li>
<li><p>The steepness of this transition increasing with the filter order <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
</ul>
<ul class="simple">
<li><p>Let’s consider a signal given by the sum of two sinusoids.</p></li>
<li><p>The first sinusoid <span class="math notranslate nohighlight">\(y_1\)</span> has a frequency <span class="math notranslate nohighlight">\(f_1 = 10\)</span> Hz.</p></li>
<li><p>The second sinusoid <span class="math notranslate nohighlight">\(y_2\)</span> has frequency <span class="math notranslate nohighlight">\(f_2 = 15\)</span> Hz.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Fs</span> <span class="o">=</span> <span class="mi">1234</span>     <span class="c1"># Sampling frequency in Hz</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">Fs</span><span class="p">)</span>  <span class="c1"># Time vector</span>

<span class="n">freq1</span><span class="p">,</span> <span class="n">freq2</span> <span class="o">=</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">15</span>

<span class="n">y1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="n">y2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">freq2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="n">y_12</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">y2</span>
<span class="n">plot_time_freq</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6d0583666dfb860876a956e07451dc17cfcd5f14efe0dc7057c6a38fd2de595b.png" src="../../_images/6d0583666dfb860876a956e07451dc17cfcd5f14efe0dc7057c6a38fd2de595b.png" />
</div>
</div>
<ul class="simple">
<li><p>We want to design a low-pass filter to remove <span class="math notranslate nohighlight">\(y_2\)</span>, the <span class="math notranslate nohighlight">\(15\)</span> Hz component, from the signal.</p></li>
<li><p>We can use a LPF with cut frequency <span class="math notranslate nohighlight">\(f_c = 12\)</span> Hz.</p></li>
<li><p>Before, we applied the filter by multiplying the FFT of the filter and the signal and then computed the inverse.</p></li>
<li><p>This time, we use the <code class="docutils literal notranslate"><span class="pre">filtfilt</span></code> function, which directly applies a digital filter to a signal.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq_c</span> <span class="o">=</span> <span class="mi">12</span>

 <span class="c1"># Numerator (B) and denominator (A) polynomials of the filter</span>
<span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">freq_c</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">fs</span><span class="o">=</span><span class="mi">1234</span><span class="p">)</span> 
 
<span class="c1"># Apply the filter</span>
<span class="n">y_low_butter</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">y_12</span><span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">filter_plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y_12</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">y_low_butter</span><span class="p">,</span> 
            <span class="p">[</span><span class="s1">&#39;$y_1 + y_2$&#39;</span><span class="p">,</span><span class="s1">&#39;$y_1$&#39;</span><span class="p">,</span><span class="s1">&#39;Fitered Signal&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cb9e29621acdf49c2a1e737ce43bcde6ed1c973096737f7853d40ecbc9296f89.png" src="../../_images/cb9e29621acdf49c2a1e737ce43bcde6ed1c973096737f7853d40ecbc9296f89.png" />
</div>
</div>
<ul class="simple">
<li><p>We see that the the <span class="math notranslate nohighlight">\(10\)</span> Hz component, <span class="math notranslate nohighlight">\(y_1\)</span>, is recovered in the filtered signal.</p></li>
</ul>
<ul class="simple">
<li><p>Next, we want to remove the noise from the noisy signal we deine before (sinusoid + trend + noise).</p></li>
<li><p>Before, we specified the cutoff frequency <span class="math notranslate nohighlight">\(f_c\)</span> in Hertz.</p></li>
<li><p>We can equivalently express the cutoff as an angular frequency <span class="math notranslate nohighlight">\(\omega_c\)</span>.</p></li>
<li><p>Based on the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.signal.butter.html">documentation</a>:</p></li>
</ul>
<blockquote>
<div><p>“For digital filters, if <code class="docutils literal notranslate"><span class="pre">fs</span></code> is not specified, <code class="docutils literal notranslate"><span class="pre">Wn</span></code> units are normalized from 0 to 1, where 1 is the Nyquist frequency (<code class="docutils literal notranslate"><span class="pre">Wn</span></code> is thus in half cycles / sample and defined as 2* <em>critical frequencies</em> / <em>fs</em>).”</p>
</div></blockquote>
<ul class="simple">
<li><p>Let’s first compute to what angular frequency <span class="math notranslate nohighlight">\(\omega\)</span> the sinusoid’s frequency corresponds to.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">freq</span> <span class="o">=</span> <span class="mf">1.5</span> <span class="c1"># Frequency in Hz</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span> <span class="c1"># Time vector</span>

<span class="c1"># Compute the sampling resolution</span>
<span class="n">fs</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">time</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

<span class="c1"># Compute the Nyquist frequency</span>
<span class="n">nyq</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">fs</span>

<span class="c1"># Compute the angular frequency</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">freq</span> <span class="o">/</span> <span class="n">nyq</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot; ω = </span><span class="si">{</span><span class="n">omega</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> ω = 0.029
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>To allow the sinusoid frequency <span class="math notranslate nohighlight">\(\omega=0.029\)</span> and cut the higher ones, we can set <span class="math notranslate nohighlight">\(\omega_c = 0.05\)</span>.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">omega_c</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">omega_c</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lowpass&#39;</span><span class="p">)</span>
 
<span class="c1"># Apply the filter</span>
<span class="n">y_low_butter</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">noisy_signal</span><span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">filter_plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">noisy_signal</span><span class="p">,</span> <span class="n">y_sine</span><span class="o">+</span><span class="n">y_trend</span><span class="p">,</span> <span class="n">y_low_butter</span><span class="p">,</span> 
            <span class="p">[</span><span class="s1">&#39;Signal+Trend+Noise&#39;</span><span class="p">,</span><span class="s1">&#39;Signal+Trend&#39;</span><span class="p">,</span><span class="s1">&#39;Fitered Signal&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c6b8bccbb9389478b6d4da321193d074af67c269e940ca5559b7673bd6001e51.png" src="../../_images/c6b8bccbb9389478b6d4da321193d074af67c269e940ca5559b7673bd6001e51.png" />
</div>
</div>
<ul class="simple">
<li><p>Once again the filtered signal resembles the original signal without the noise.</p></li>
</ul>
<ul class="simple">
<li><p>Finally, we compute the Bode plot to see the shape of the LPF.</p></li>
<li><p>In green, we plot <span class="math notranslate nohighlight">\(\omega\)</span> the frequency of the signal.</p></li>
<li><p>In red, we plot <span class="math notranslate nohighlight">\(\omega_c\)</span> the cutoff frequency of the filter.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">Wn</span><span class="o">=</span><span class="n">omega_c</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;lowpass&#39;</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="c1"># For the plot, we need the analog response</span>
<span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span> <span class="c1"># Compute frequency response</span>
<span class="n">magnitude</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>  <span class="c1"># Convert magnitude to dB</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Phase in degrees</span>

<span class="n">make_bode_plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c06b9951fce42d214a118362faa475c2ef3029b64c6f78b159ccbe8952981ccb.png" src="../../_images/c06b9951fce42d214a118362faa475c2ef3029b64c6f78b159ccbe8952981ccb.png" />
</div>
</div>
</section>
</section>
<section id="high-pass-filters-hpfs">
<h3>High Pass Filters (HPFs)<a class="headerlink" href="#high-pass-filters-hpfs" title="Link to this heading">#</a></h3>
<p>Allows signals with frequencies higher than a certain cutoff frequency to pass through, while attenuating (reducing) signals with frequencies below the cutoff.</p>
<img alt="https://upload.wikimedia.org/wikipedia/commons/4/4d/75_Hz_HPF_on_Smaart.jpg" src="https://upload.wikimedia.org/wikipedia/commons/4/4d/75_Hz_HPF_on_Smaart.jpg" />
<div style="text-align: center; font-size: 80%;">Image: <a href="https://upload.wikimedia.org/wikipedia/commons/4/4d/75_Hz_HPF_on_Smaart.jpg">Wikimedia</a></div><ul class="simple">
<li><p>LPFs are used to smooth out signals, remove noise, and preserve the basic shape of the signal without the details provided by high-frequency components.</p></li>
<li><p>Conversely, HPFs are often used to enhance or isolate quick changes in signals (e.g., edges in images or high-frequency sounds in audio).</p></li>
<li><p>One application of HPFs is to filter out low frequency components and get rid of the trend.</p></li>
</ul>
<p>Let’s use a Butterworth filter in a high pass filter configuration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># High Pass Butterworth filter</span>
<span class="n">N</span>  <span class="o">=</span> <span class="mi">2</span>    <span class="c1"># Filter order</span>
<span class="n">omega_c</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># Cutoff frequency</span>
<span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">,</span> <span class="n">btype</span><span class="o">=</span><span class="s1">&#39;highpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

<span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span> <span class="c1"># Compute frequency response</span>
<span class="n">magnitude</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>  <span class="c1"># Convert magnitude to dB</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Phase in degrees</span>

<span class="n">make_bode_plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7fe185d1a2801562ab4cf4648f0cfff72d11d1beeb402d64fec61464c30405d1.png" src="../../_images/7fe185d1a2801562ab4cf4648f0cfff72d11d1beeb402d64fec61464c30405d1.png" />
</div>
</div>
<ul class="simple">
<li><p>The magnitude plot is flipped left-to-right.</p></li>
<li><p>The phase plot is shifted upwards, but the shape is unchanged.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">,</span> <span class="n">btype</span> <span class="o">=</span> <span class="s1">&#39;highpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span> 
 
<span class="c1"># Apply the filter</span>
<span class="n">y_high_butter</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">noisy_signal</span><span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">filter_plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">noisy_signal</span><span class="p">,</span> <span class="n">y_sine</span><span class="p">,</span> <span class="n">y_high_butter</span><span class="p">,</span> 
            <span class="p">[</span><span class="s1">&#39;Sine+Trend+Noise&#39;</span><span class="p">,</span><span class="s1">&#39;Sine&#39;</span><span class="p">,</span><span class="s1">&#39;Fitered Signal&#39;</span><span class="p">],</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/c0f42d3493964ca84e073e2daccaa63eb4326028cdf237d4155e09b0030fd7fc.png" src="../../_images/c0f42d3493964ca84e073e2daccaa63eb4326028cdf237d4155e09b0030fd7fc.png" />
</div>
</div>
<ul class="simple">
<li><p>We can observe that the trend has been removed.</p></li>
</ul>
</section>
<section id="band-pass-filter">
<h3>Band Pass Filter<a class="headerlink" href="#band-pass-filter" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>A Band Pass Filter (BPF) passes frequencies within a certain range and rejects frequencies outside that range.</p></li>
</ul>
<img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Band-pass_filter.svg/640px-Band-pass_filter.svg.png" src="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Band-pass_filter.svg/640px-Band-pass_filter.svg.png" />
<div style="text-align: center; font-size: 80%;">Image: <a href="https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/Band-pass_filter.svg/640px-Band-pass_filter.svg.png">Wikimedia</a></div><ul class="simple">
<li><p>A BPF can be seen as a combination of a high pass and low pass filters that remove both the high and low frequency components of a signal.</p></li>
</ul>
<img alt="../../_images/filter.png" src="../../_images/filter.png" />
<ul class="simple">
<li><p>In particular, we can implement a BPF using a LPF and HPF Butterworth filters.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Band Pass Butterworth filter</span>
<span class="n">N</span>  <span class="o">=</span> <span class="mi">2</span>    <span class="c1"># Filter order</span>
<span class="n">omega_c</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">]</span> <span class="c1"># Cutoff frequencies</span>
<span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">,</span> <span class="n">btype</span> <span class="o">=</span> <span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

<span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span> <span class="c1"># Compute frequency response</span>
<span class="n">magnitude</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>  <span class="c1"># Convert magnitude to dB</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Phase in degrees</span>

<span class="n">make_bode_plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/dd0ea9be77a9b8a8c04bf3eec7063f3a27c80e7b6997fd3a2fc5a8de808bdd18.png" src="../../_images/dd0ea9be77a9b8a8c04bf3eec7063f3a27c80e7b6997fd3a2fc5a8de808bdd18.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">,</span> <span class="n">btype</span> <span class="o">=</span> <span class="s1">&#39;bandpass&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span> 
 
<span class="c1"># Apply the filter</span>
<span class="n">y_band_butter</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">noisy_signal</span><span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">filter_plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">noisy_signal</span><span class="p">,</span> <span class="n">y_sine</span><span class="p">,</span> <span class="n">y_band_butter</span><span class="p">,</span> 
            <span class="p">[</span><span class="s1">&#39;Sine+Trend+Noise&#39;</span><span class="p">,</span><span class="s1">&#39;Sine&#39;</span><span class="p">,</span><span class="s1">&#39;Fitered Signal&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cadf390253f66c6d6651edaba4cecc1336c44cfce2a31be35cc6bdf255e2e436.png" src="../../_images/cadf390253f66c6d6651edaba4cecc1336c44cfce2a31be35cc6bdf255e2e436.png" />
</div>
</div>
<p>We observe that the original signal has been de-trended, and the noise has been removed.</p>
</section>
<section id="band-stop-filter">
<h3>Band-Stop Filter<a class="headerlink" href="#band-stop-filter" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>A Band-Stop Filter (BSF) passes most filters unaltered, but attenuates those in a specific range to very low levels.</p></li>
</ul>
<img alt="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8b/Ideal_Band_Stop_Filter_Transfer_Function.svg/640px-Ideal_Band_Stop_Filter_Transfer_Function.svg.png" src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8b/Ideal_Band_Stop_Filter_Transfer_Function.svg/640px-Ideal_Band_Stop_Filter_Transfer_Function.svg.png" />
<div style="text-align: center; font-size: 80%;">Image: <a href="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8b/Ideal_Band_Stop_Filter_Transfer_Function.svg/640px-Ideal_Band_Stop_Filter_Transfer_Function.svg.png">Wikimedia</a></div><ul class="simple">
<li><p>For the next example, we generate a new signal that is the sum of 3 sinusoids.</p></li>
<li><p>Then, we design a filter to remove the 3rd sinusoid.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fs</span> <span class="o">=</span> <span class="mi">1000</span>  <span class="c1"># Sampling frequency in Hz</span>
<span class="n">f1</span><span class="p">,</span> <span class="n">f2</span><span class="p">,</span> <span class="n">f3</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">20</span>  <span class="c1"># Frequencies of the three sinusoids in Hz</span>
<span class="n">duration</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># seconds</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">fs</span><span class="p">)</span>  <span class="c1"># Time vector</span>

<span class="n">sinusoid1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f1</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="n">sinusoid2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f2</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>
<span class="n">sinusoid3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f3</span> <span class="o">*</span> <span class="n">t</span><span class="p">)</span>

<span class="n">Y</span> <span class="o">=</span> <span class="n">sinusoid1</span> <span class="o">+</span> <span class="n">sinusoid2</span> <span class="o">+</span> <span class="n">sinusoid3</span> <span class="c1"># Combined signal</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sinusoid1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sinusoid2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">sinusoid3</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Sum of 3 Sinusoids with frequencies </span><span class="si">{</span><span class="n">f1</span><span class="si">}</span><span class="s1">Hz, </span><span class="si">{</span><span class="n">f2</span><span class="si">}</span><span class="s1">Hz, and </span><span class="si">{</span><span class="n">f3</span><span class="si">}</span><span class="s1">Hz&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/f0a05dd5681e4030178ff80b542a3e604e58c494a5e59e60d3702fed0f539cdb.png" src="../../_images/f0a05dd5681e4030178ff80b542a3e604e58c494a5e59e60d3702fed0f539cdb.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Filter parameters to reject the third sinusoid</span>
<span class="n">lowcut</span> <span class="o">=</span> <span class="n">f3</span> <span class="o">-</span> <span class="mi">5</span>  <span class="c1"># Just below the third frequency</span>
<span class="n">highcut</span> <span class="o">=</span> <span class="n">f3</span> <span class="o">+</span> <span class="mi">5</span>  <span class="c1"># Just above the third frequency</span>

<span class="c1"># Scale the values by the sampling frequency</span>
<span class="n">nyq</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">fs</span>
<span class="n">omega_c_low</span> <span class="o">=</span> <span class="n">lowcut</span> <span class="o">/</span> <span class="n">nyq</span>
<span class="n">omega_c_high</span> <span class="o">=</span> <span class="n">highcut</span> <span class="o">/</span> <span class="n">nyq</span>
<span class="n">omega</span> <span class="o">=</span> <span class="n">f3</span> <span class="o">/</span> <span class="n">nyq</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Band Stop Butterworth filter</span>
<span class="n">N</span>  <span class="o">=</span> <span class="mi">2</span>    <span class="c1"># Filter order</span>
<span class="n">omega_c</span> <span class="o">=</span> <span class="p">[</span><span class="n">omega_c_low</span><span class="p">,</span> <span class="n">omega_c_high</span><span class="p">]</span> <span class="c1"># Cutoff frequencies</span>
<span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">,</span> <span class="n">btype</span> <span class="o">=</span> <span class="s1">&#39;bandstop&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">,</span> <span class="n">analog</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

<span class="n">w</span><span class="p">,</span> <span class="n">H</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">freqs</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">worN</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span> <span class="c1"># Compute frequency response</span>
<span class="n">magnitude</span> <span class="o">=</span> <span class="mi">20</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">H</span><span class="p">))</span>  <span class="c1"># Convert magnitude to dB</span>
<span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">deg</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Phase in degrees</span>

<span class="n">make_bode_plot</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">magnitude</span><span class="p">,</span> <span class="n">phase</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">,</span> <span class="n">omega</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/3c0d0c97185fe21aa072b5f718bab86a31f9437f104f1cc9e5aee07446f45dd9.png" src="../../_images/3c0d0c97185fe21aa072b5f718bab86a31f9437f104f1cc9e5aee07446f45dd9.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="p">,</span> <span class="n">A</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">butter</span><span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">omega_c</span><span class="p">,</span> <span class="n">btype</span> <span class="o">=</span> <span class="s1">&#39;bandstop&#39;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s1">&#39;ba&#39;</span><span class="p">)</span> 
 
<span class="c1"># Apply the filter</span>
<span class="n">y_stop_butter</span> <span class="o">=</span> <span class="n">signal</span><span class="o">.</span><span class="n">filtfilt</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">A</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>

<span class="c1"># plot</span>
<span class="n">filter_plot</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">sinusoid1</span><span class="o">+</span><span class="n">sinusoid2</span><span class="p">,</span> <span class="n">y_stop_butter</span><span class="p">,</span> 
            <span class="p">[</span><span class="s1">&#39;Sin1+Sin2+Sin3&#39;</span><span class="p">,</span><span class="s1">&#39;Sin1+Sin2&#39;</span><span class="p">,</span><span class="s1">&#39;Fitered Signal&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/7254224e19acd264b3975aaf2cc3a8576765ec4a5670af13862b8ca249ec1daf.png" src="../../_images/7254224e19acd264b3975aaf2cc3a8576765ec4a5670af13862b8ca249ec1daf.png" />
</div>
</div>
<ul class="simple">
<li><p>The effect of the third sinusoid has been completely removed from the signal.</p></li>
<li><p>An application of this filter is to remove a specific seasonality from the data.</p></li>
</ul>
</section>
</section>
<hr class="docutils" />
<section id="making-forecasts-with-fourier-transforms">
<h2>Making Forecasts with Fourier Transforms<a class="headerlink" href="#making-forecasts-with-fourier-transforms" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p>We will forecast future values of a time series based on its past observations using Fourier analysis.</p></li>
<li><p>We will achieve this by decomposing the time series into its frequency components, eliminating the trend, and then reconstructing the signal to predict future values.</p></li>
</ul>
<ul class="simple">
<li><p>We will define a function <code class="docutils literal notranslate"><span class="pre">fourierPrediction(y,</span> <span class="pre">n_predict,</span> <span class="pre">n_harm)</span></code> for this purpose.</p></li>
<li><p>The function returns <code class="docutils literal notranslate"><span class="pre">n_predict</span></code> future points of the original time series (with the linear trend) reconstructed using the specified number of harmonics <code class="docutils literal notranslate"><span class="pre">n_harm</span></code>.</p></li>
</ul>
<p>Let’s break down the steps implemented by the function.</p>
<ol class="arabic simple">
<li><p><strong>Define the number of harmonics</strong></p>
<ul class="simple">
<li><p>Harmonics are sine and cosine functions with frequencies that are integer multiples of a fundamental frequency.</p></li>
<li><p>The input parameter <code class="docutils literal notranslate"><span class="pre">n_harm</span></code> specifies the number of harmonics used in the Fourier series expansion.</p></li>
<li><p>By using multiple harmonics, the model can approximate the original time series more accurately.</p></li>
<li><p>Using too many harmonics might overfit the data as they will start to model the noise.</p></li>
</ul>
</li>
</ol>
<ol class="arabic simple" start="2">
<li><p><strong>Trend removal</strong></p>
<ul class="simple">
<li><p>The function first computes a linear trend of the time series <code class="docutils literal notranslate"><span class="pre">y</span></code> using <code class="docutils literal notranslate"><span class="pre">np.polyfit(t,</span> <span class="pre">y,</span> <span class="pre">1)</span></code>, which fits a first-degree polynomial to the data, i.e., a straight line with form <span class="math notranslate nohighlight">\(\beta_1 t + \beta_0\)</span>, where <span class="math notranslate nohighlight">\(\beta_1\)</span> is the slope (stored in <code class="docutils literal notranslate"><span class="pre">p[0]</span></code>) and <span class="math notranslate nohighlight">\(\beta_0\)</span> is intercept (stored in <code class="docutils literal notranslate"><span class="pre">p[1]</span></code>).</p></li>
<li><p>This trend is then subtracted from the original time series to obtain a detrended series <code class="docutils literal notranslate"><span class="pre">y_notrend</span></code>.</p></li>
<li><p>Detrending is crucial for focusing the Fourier analysis on the cyclical components of the time series without the influence of the underlying trend.</p></li>
</ul>
</li>
</ol>
<ol class="arabic simple" start="3">
<li><p><strong>Fourier transform</strong></p>
<ul class="simple">
<li><p>The detrended time series is transformed into the frequency domain using the Fast Fourier Transform (FFT) with <code class="docutils literal notranslate"><span class="pre">np.fft.fft(y_notrend)</span></code>.</p></li>
<li><p>The FFT algorithm computes the Discrete Fourier Transform (DFT), which represents the original time series as a sum of cosine and sine waves with different frequencies and amplitudes.</p></li>
</ul>
</li>
</ol>
<ol class="arabic simple" start="4">
<li><p><strong>Frequency identification</strong></p>
<ul class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">np.fft.fftfreq(n)</span></code> function generates an array of frequencies associated with the components of the FFT.</p></li>
<li><p>These frequencies are needed for reconstructing the signal later.</p></li>
</ul>
</li>
</ol>
<ol class="arabic simple" start="5">
<li><p><strong>Sorting indexes by largest frequency components</strong></p>
<ul class="simple">
<li><p>The indexes of the frequency components are sorted according to their magnitude.</p></li>
<li><p>In this way, the most important frequency components of the signal (i.e., those that contribute the most to its shape) will come first.</p></li>
</ul>
</li>
</ol>
<ol class="arabic simple" start="6">
<li><p><strong>Signal reconstruction and prediction</strong></p>
<ul class="simple">
<li><p>The function reconstructs the time series (and extends it to predict future values) by summing the first <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">+</span> <span class="pre">n_harm</span> <span class="pre">*</span> <span class="pre">2</span></code> sorted harmonic components.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">*</span> <span class="pre">2</span></code> is there because each harmonic has a positive and a negative frequency component in the FFT output.</p></li>
<li><p>Each harmoic is defined by the amplitude (<code class="docutils literal notranslate"><span class="pre">amp</span></code>), frequency (<code class="docutils literal notranslate"><span class="pre">f[i]</span></code>), and phase (<code class="docutils literal notranslate"><span class="pre">phase</span></code>) given by the FFT.</p></li>
<li><p>The reconstructed signal at each time point <code class="docutils literal notranslate"><span class="pre">t</span></code> is the sum of these harmonics, each represented by <code class="docutils literal notranslate"><span class="pre">amp</span> <span class="pre">*</span> <span class="pre">np.cos(2</span> <span class="pre">*</span> <span class="pre">np.pi</span> <span class="pre">*</span> <span class="pre">f[i]</span> <span class="pre">*</span> <span class="pre">t</span> <span class="pre">+</span> <span class="pre">phase)</span></code>.</p></li>
</ul>
</li>
</ol>
<ol class="arabic simple" start="7">
<li><p><strong>Adding back the trend</strong></p>
<ul class="simple">
<li><p>Finally, the linear trend previously removed is added back to the reconstructed signal.</p></li>
</ul>
</li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fourierPrediction</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n_predict</span><span class="p">,</span> <span class="n">n_harm</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span>                         <span class="c1"># length of the time series</span>
    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>                <span class="c1"># time vector</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>            <span class="c1"># find linear trend in x</span>
    <span class="n">y_notrend</span> <span class="o">=</span> <span class="n">y</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span> <span class="o">-</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>    <span class="c1"># detrended x</span>
    <span class="n">y_freqdom</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fft</span><span class="p">(</span><span class="n">y_notrend</span><span class="p">)</span>  <span class="c1"># detrended x in frequency domain</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">fft</span><span class="o">.</span><span class="n">fftfreq</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>              <span class="c1"># frequencies</span>
    
    <span class="c1"># Sort indexes by largest frequency components</span>
    <span class="n">indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_freqdom</span><span class="p">))[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="n">n_predict</span><span class="p">)</span>
    <span class="n">restored_sig</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">t</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indexes</span><span class="p">[:</span><span class="mi">1</span> <span class="o">+</span> <span class="n">n_harm</span> <span class="o">*</span> <span class="mi">2</span><span class="p">]:</span>
        <span class="n">amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_freqdom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">n</span>   <span class="c1"># amplitude</span>
        <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">y_freqdom</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>        <span class="c1"># phase</span>
        <span class="n">restored_sig</span> <span class="o">+=</span> <span class="n">amp</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">phase</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">restored_sig</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">t</span> <span class="o">+</span> <span class="n">p</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1"># add back the trend</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fourierPredictionPlot</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">prediction</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">prediction</span><span class="o">.</span><span class="n">size</span><span class="p">),</span> <span class="n">prediction</span><span class="p">,</span> <span class="s1">&#39;tab:red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;prediction&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="forecast-example-1">
<h3>Forecast example 1<a class="headerlink" href="#forecast-example-1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Here, we will consider the prediction of the noisy sinusoid with trend.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prediction</span> <span class="o">=</span> <span class="n">fourierPrediction</span><span class="p">(</span><span class="n">noisy_signal</span><span class="p">,</span> <span class="n">n_predict</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">n_harm</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fourierPredictionPlot</span><span class="p">(</span><span class="n">noisy_signal</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/76d77421daf8b61acc49c0a0e7ec8ea29e9d8fd4867529a9206f082c99fbb912.png" src="../../_images/76d77421daf8b61acc49c0a0e7ec8ea29e9d8fd4867529a9206f082c99fbb912.png" />
</div>
</div>
</section>
<section id="forecast-example-2">
<h3>Forecast example 2<a class="headerlink" href="#forecast-example-2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Here, we try to predict the CO2 Data.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">co2</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">get_rdataset</span><span class="p">(</span><span class="s2">&quot;co2&quot;</span><span class="p">,</span> <span class="s2">&quot;datasets&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">data</span>
<span class="nb">print</span><span class="p">(</span><span class="n">co2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Convert decimal year to pandas datetime</span>
<span class="k">def</span> <span class="nf">convert_decimal_year_to_datetime</span><span class="p">(</span><span class="n">decimal_years</span><span class="p">):</span>
    <span class="n">dates</span> <span class="o">=</span> <span class="p">[(</span><span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">)</span><span class="si">}</span><span class="s1">-01-01&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_timedelta</span><span class="p">((</span><span class="n">year</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">year</span><span class="p">))</span> <span class="o">*</span> <span class="mf">365.25</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">))</span><span class="o">.</span><span class="n">date</span><span class="p">()</span> 
             <span class="k">for</span> <span class="n">year</span> <span class="ow">in</span> <span class="n">decimal_years</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">dates</span>
<span class="n">co2</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert_decimal_year_to_datetime</span><span class="p">(</span><span class="n">co2</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>

<span class="c1"># Convert the column ds to datetime</span>
<span class="n">co2</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_datetime</span><span class="p">(</span><span class="n">co2</span><span class="p">[</span><span class="s1">&#39;time&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Converted:</span><span class="se">\n</span><span class="s2">------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">co2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="c1"># Resample to monthly frequency based on the ds column</span>
<span class="n">co2</span> <span class="o">=</span> <span class="n">co2</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="s1">&#39;MS&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;time&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>

<span class="c1"># Replace NaN with the mean of the previous and next value</span>
<span class="n">co2</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">co2</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">interpolate</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Resampled:</span><span class="se">\n</span><span class="s2">------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">co2</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>          time   value
0  1959.000000  315.42
1  1959.083333  316.31
2  1959.166667  316.50
3  1959.250000  317.56
4  1959.333333  318.13

Converted:
------------------
         time   value
0 1959-01-01  315.42
1 1959-01-31  316.31
2 1959-03-02  316.50
3 1959-04-02  317.56
4 1959-05-02  318.13

Resampled:
------------------
         time     value
0 1959-01-01  315.8650
1 1959-02-01  316.1825
2 1959-03-01  316.5000
3 1959-04-01  317.5600
4 1959-05-01  318.1300
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prediction</span> <span class="o">=</span> <span class="n">fourierPrediction</span><span class="p">(</span><span class="n">co2</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span> <span class="n">n_predict</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">n_harm</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fourierPredictionPlot</span><span class="p">(</span><span class="n">co2</span><span class="p">[</span><span class="s1">&#39;value&#39;</span><span class="p">],</span> <span class="n">prediction</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/1ce145b37445b85f4bd403874eb0239f0e105274119f1a5ee7d78a6611543ab6.png" src="../../_images/1ce145b37445b85f4bd403874eb0239f0e105274119f1a5ee7d78a6611543ab6.png" />
</div>
</div>
</section>
<section id="detrending-example">
<h3>Detrending example<a class="headerlink" href="#detrending-example" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>The forecasting approach based on FT can also be used to remove trend and seasonality.</p></li>
<li><p>In the following, we repeat the same example from Lecture 4: forecasting with an AR model.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate data from an AR(2) process</span>
<span class="n">ar_data</span> <span class="o">=</span> <span class="n">arma_generate_sample</span><span class="p">(</span><span class="n">ar</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">]),</span> <span class="n">ma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">]),</span> <span class="n">nsample</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">burnin</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="c1"># Add trend and seasonality</span>
<span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">200</span><span class="p">)</span>
<span class="n">trend</span> <span class="o">=</span> <span class="n">time</span> <span class="o">*</span> <span class="mf">0.2</span>
<span class="n">seasonality</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">time</span><span class="o">/</span><span class="mi">12</span><span class="p">)</span>
<span class="n">time_series_ar</span> <span class="o">=</span> <span class="n">trend</span> <span class="o">+</span> <span class="n">seasonality</span> <span class="o">+</span> <span class="n">ar_data</span>

<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">run_sequence_plot</span><span class="p">(</span><span class="n">time</span><span class="p">,</span> <span class="n">time_series_ar</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/5ca839220b6a2306431e262920634103cb290501b5f0ad4462e3141ab3844dd2.png" src="../../_images/5ca839220b6a2306431e262920634103cb290501b5f0ad4462e3141ab3844dd2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Train/test split</span>
<span class="n">train_data_ar</span> <span class="o">=</span> <span class="n">time_series_ar</span><span class="p">[:</span><span class="mi">164</span><span class="p">]</span>
<span class="n">test_data_ar</span> <span class="o">=</span> <span class="n">time_series_ar</span><span class="p">[</span><span class="mi">164</span><span class="p">:]</span>

<span class="n">prediction</span> <span class="o">=</span> <span class="n">fourierPrediction</span><span class="p">(</span><span class="n">train_data_ar</span><span class="p">,</span> <span class="n">n_predict</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_ar</span><span class="p">),</span> <span class="n">n_harm</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">fourierPredictionPlot</span><span class="p">(</span><span class="n">train_data_ar</span><span class="p">,</span> <span class="n">prediction</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/cae35993d2622320c1d6943ec108b2b508a3821cd230ce7f5166ea8495d81947.png" src="../../_images/cae35993d2622320c1d6943ec108b2b508a3821cd230ce7f5166ea8495d81947.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimate trend and seasonality and remove them</span>
<span class="n">trend_and_seasonality</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_ar</span><span class="p">)]</span>
<span class="n">resid</span> <span class="o">=</span> <span class="n">train_data_ar</span> <span class="o">-</span> <span class="n">trend_and_seasonality</span>

<span class="n">_</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">ar_data</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_ar</span><span class="p">)],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;PACF Original AR process&quot;</span><span class="p">)</span>
<span class="n">plot_pacf</span><span class="p">(</span><span class="n">resid</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;PACF of TES residuals&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/9d375bf6f2228d9076b5c314449dfc4ef8ea3c48989237067ba9927100c687e3.png" src="../../_images/9d375bf6f2228d9076b5c314449dfc4ef8ea3c48989237067ba9927100c687e3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fit the model</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">ARIMA</span><span class="p">(</span><span class="n">resid</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span>
<span class="n">model_fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="c1"># Compute predictions</span>
<span class="n">resid_preds</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">test_data_ar</span><span class="p">))</span>

<span class="n">ax</span> <span class="o">=</span> <span class="n">run_sequence_plot</span><span class="p">(</span><span class="n">time</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_ar</span><span class="p">)],</span> <span class="n">resid</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_ar</span><span class="p">):],</span> <span class="n">resid_preds</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Residuals&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Differenced time series&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/6038f34afbe907aa5b3883d8de8edd0039cfe95d873a3185be59210954bdda9e.png" src="../../_images/6038f34afbe907aa5b3883d8de8edd0039cfe95d873a3185be59210954bdda9e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add back trend and seasonality to the predictions</span>
<span class="n">ft_preds</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_ar</span><span class="p">):]</span>
<span class="n">final_preds</span> <span class="o">=</span> <span class="n">ft_preds</span> <span class="o">+</span> <span class="n">resid_preds</span>

<span class="n">_</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">run_sequence_plot</span><span class="p">(</span><span class="n">time</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_ar</span><span class="p">)],</span> <span class="n">train_data_ar</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_ar</span><span class="p">):],</span> <span class="n">test_data_ar</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test Data&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">time</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">train_data_ar</span><span class="p">):],</span> <span class="n">final_preds</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predictions&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/ad10f4676ac7463c37f9373e91827a11c90e59a2e015e98775d28c87081d55bb.png" src="../../_images/ad10f4676ac7463c37f9373e91827a11c90e59a2e015e98775d28c87081d55bb.png" />
</div>
</div>
</section>
</section>
<hr class="docutils" />
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Link to this heading">#</a></h2>
<p>In this lecture we learned some basic concepts from signal processing. In particular</p>
<ul class="simple">
<li><p>A basic understanding of the Fourier Transform, the Discrete Fourier Transform.</p></li>
<li><p>A practical knowledge of how to apply the Fast Fourier Transform.</p></li>
<li><p>The FT of common signals and the main properties of the FT.</p></li>
<li><p>The concepts of frequency response and transfer function</p></li>
<li><p>Different types of filters, their properties, and the Bode diagram.</p></li>
<li><p>How to use FT in forecasting tasks.</p></li>
</ul>
</section>
<hr class="docutils" />
<section id="exercises">
<h2>Exercises<a class="headerlink" href="#exercises" title="Link to this heading">#</a></h2>
<section id="exercise-1">
<h3>Exercise 1<a class="headerlink" href="#exercise-1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Combine (add) the three signals defined <a class="reference internal" href="#signal-with-trend-and-noise"><span class="xref myst">here</span></a>:</p>
<ul>
<li><p>A sine wave representing seasonality</p></li>
<li><p>a parabolic function representing a trend</p></li>
<li><p>and uniformly distributed random noise</p></li>
</ul>
</li>
<li><p>Plot the time and frequency domain components.</p></li>
<li><p>Modify the amplitude of the sine, trend, and noise components so that each component, in turn, dominates over the others. Comment on how the FT of the total signal changes.</p></li>
<li><p>Modify the sine into a signal that is the sum of 2 sine waves of different amplitudes at 1 and 10 Hz as well as a constant term.  Make a plot in both time and frequency domains and comment the results.</p></li>
</ul>
</section>
<section id="exercise-2">
<h3>Exercise 2<a class="headerlink" href="#exercise-2" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Consider the following noisy signal:</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">time</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">512</span><span class="p">)</span>
<span class="n">y_sine</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>
<span class="n">y_cos</span> <span class="o">=</span> <span class="mf">1.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span>
<span class="n">y_trend</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="n">time</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
<span class="n">y_noise</span> <span class="o">=</span> <span class="mf">0.8</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">time</span><span class="p">))</span>
<span class="n">y_signal</span> <span class="o">=</span> <span class="n">y_sine</span> <span class="o">+</span> <span class="n">y_cos</span> <span class="o">+</span> <span class="n">y_trend</span>
<span class="n">noisy_signal</span> <span class="o">=</span> <span class="n">y_signal</span> <span class="o">+</span> <span class="n">y_noise</span>
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Apply the <a class="reference internal" href="#tukey-filter"><span class="xref myst">Tukey filter</span></a> to the <code class="docutils literal notranslate"><span class="pre">noisy_signal</span></code>.</p></li>
<li><p>Modify the values <code class="docutils literal notranslate"><span class="pre">alpha</span></code> and <code class="docutils literal notranslate"><span class="pre">div_factor</span></code> of the filter to recover the clean signal <code class="docutils literal notranslate"><span class="pre">y_signal</span></code>.</p></li>
</ul>
</section>
<section id="exercise-3">
<h3>Exercise 3<a class="headerlink" href="#exercise-3" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Consider the <code class="docutils literal notranslate"><span class="pre">noisy_signal</span></code> from <a class="reference internal" href="#exercise-2"><span class="xref myst">Exercise 2</span></a> .</p></li>
<li><p>Now, your task is to recover <code class="docutils literal notranslate"><span class="pre">y_signal</span></code> using the <a class="reference internal" href="#butterworth-filter"><span class="xref myst">low-pass Butterworth filter</span></a>.</p></li>
<li><p>Modify the filter order <span class="math notranslate nohighlight">\(N\)</span> and cutoff frequency <span class="math notranslate nohighlight">\(\omega_c\)</span> of the Butterworth filter.</p></li>
<li><p>Which values seem to be the best in getting rid of the noise?</p></li>
</ul>
</section>
<section id="exercise-4">
<h3>Exercise 4<a class="headerlink" href="#exercise-4" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Consider the <code class="docutils literal notranslate"><span class="pre">noisy_signal</span></code> from <a class="reference internal" href="#exercise-2"><span class="xref myst">Exercise 2</span></a>.</p></li>
<li><p>Now, your task is to recover <code class="docutils literal notranslate"><span class="pre">y_signal</span></code> and then remove its trend component (<code class="docutils literal notranslate"><span class="pre">y_trend</span></code>).</p></li>
<li><p>To do that, you will first apply the <a class="reference internal" href="#high-pass-filters-hpfs"><span class="xref myst">high-pass Butterworth filter</span></a>.</p></li>
<li><p>Optimize, by hand, the filter order <span class="math notranslate nohighlight">\(N\)</span> and cutoff frequency <span class="math notranslate nohighlight">\(\omega_c\)</span> of the Butterworth filter.</p></li>
<li><p>Then, apply the LPF in cascade to the HPF.</p></li>
<li><p>The result should contain neither trend nor noise.</p></li>
</ul>
</section>
<section id="exercise-5">
<h3>Exercise 5<a class="headerlink" href="#exercise-5" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Consider the <code class="docutils literal notranslate"><span class="pre">noisy_signal</span></code> from <a class="reference internal" href="#exercise-2"><span class="xref myst">Exercise 2</span></a>.</p></li>
<li><p>Once again, your task is to recover <code class="docutils literal notranslate"><span class="pre">y_signal</span></code> and then remove its trend component (<code class="docutils literal notranslate"><span class="pre">y_trend</span></code>).</p></li>
<li><p>Optimize, by hand, the filter order <span class="math notranslate nohighlight">\(N\)</span> and the cutoff frequencies <span class="math notranslate nohighlight">\(\omega_c^\text{LOW}\)</span> and <span class="math notranslate nohighlight">\(\omega_c^\text{HIGH}\)</span> of the <a class="reference internal" href="#band-pass-filter"><span class="xref myst">band-pass Butterworth filter</span></a>.</p></li>
<li><p>Compare the result of the BPF with what you got in <a class="reference internal" href="#exercise-4"><span class="xref myst">Exercise 4</span></a> when you applied a HPF and LPF in cascade.</p></li>
</ul>
</section>
<section id="exercise-6">
<h3>Exercise 6<a class="headerlink" href="#exercise-6" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Consider the <code class="docutils literal notranslate"><span class="pre">noisy_signal</span></code> from <a class="reference internal" href="#exercise-2"><span class="xref myst">Exercise 2</span></a>.</p></li>
<li><p>This time, you will have to remove the component <code class="docutils literal notranslate"><span class="pre">y_cos</span></code> form the signal using the <a class="reference internal" href="#band-stop-filter"><span class="xref myst">band stop filter</span></a>.</p></li>
</ul>
</section>
<section id="exercise-7">
<h3>Exercise 7<a class="headerlink" href="#exercise-7" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p>Consider the CO2 data defined <a class="reference internal" href="#forecast-example-2"><span class="xref myst">here</span></a>.</p></li>
<li><p>Divide the data in training and test.</p></li>
<li><p>Identify the optimal number of harmonics that gives the best MSE on the test set.</p></li>
</ul>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/08"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../07/kalman-filter.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Kalman filter</p>
      </div>
    </a>
    <a class="right-next"
       href="../09/prophet.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Prophet</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction">Introduction</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#fourier-transform">Fourier Transform</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#inverse-fourier-transform">Inverse Fourier Transform</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#discrete-fourier-transform-and-fast-fourier-transform">Discrete Fourier Transform and Fast Fourier Transform</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-idea">Basic Idea</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cooley-tukey-algorithm">Cooley-Tukey Algorithm</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-fourier-transforms">Common Fourier Transforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sine">Sine</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dirac-delta">Dirac delta</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unit-step">Unit step</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sinc">Sinc</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#signal-with-trend-and-noise">Signal with Trend and Noise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#spectral-leakage">Spectral leakage</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#properties-of-the-fourier-transform">Properties of the Fourier transform</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#linearity">Linearity</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-shift">Time Shift</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-shift">Frequency Shift</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#scaling">Scaling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convolution">Convolution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#differentiation">Differentiation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#integration">Integration</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#parseval-s-theorem">Parseval’s Theorem</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#filters">Filters</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#frequency-response">Frequency Response</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#transfer-function">Transfer Function</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bode-plot">Bode Plot</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#low-pass-filters-lpfs">Low Pass Filters (LPFs)</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#hann-window">Hann Window</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tukey-filter">Tukey Filter</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#butterworth-filter">Butterworth Filter</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#high-pass-filters-hpfs">High Pass Filters (HPFs)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#band-pass-filter">Band Pass Filter</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#band-stop-filter">Band-Stop Filter</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#making-forecasts-with-fourier-transforms">Making Forecasts with Fourier Transforms</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forecast-example-1">Forecast example 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#forecast-example-2">Forecast example 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#detrending-example">Detrending example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#summary">Summary</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#exercises">Exercises</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-1">Exercise 1</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-2">Exercise 2</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-3">Exercise 3</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-4">Exercise 4</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-5">Exercise 5</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-6">Exercise 6</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#exercise-7">Exercise 7</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Filippo Maria Bianchi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>